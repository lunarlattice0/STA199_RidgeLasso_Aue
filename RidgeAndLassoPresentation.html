<!DOCTYPE html>
<html lang="en"><head>
<script src="RidgeAndLassoPresentation_files/libs/clipboard/clipboard.min.js"></script>
<script src="RidgeAndLassoPresentation_files/libs/quarto-html/tabby.min.js"></script>
<script src="RidgeAndLassoPresentation_files/libs/quarto-html/popper.min.js"></script>
<script src="RidgeAndLassoPresentation_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="RidgeAndLassoPresentation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="RidgeAndLassoPresentation_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="RidgeAndLassoPresentation_files/libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.31">

  <meta name="author" content="C. L.">
  <title>STA199: Ridge and Lasso</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="RidgeAndLassoPresentation_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="RidgeAndLassoPresentation_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="RidgeAndLassoPresentation_files/libs/revealjs/dist/theme/quarto-f563837468303362081e247dddd440d0.css">
  <link href="RidgeAndLassoPresentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="RidgeAndLassoPresentation_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="RidgeAndLassoPresentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="RidgeAndLassoPresentation_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">STA199: Ridge and Lasso</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
C. L. 
</div>
</div>
</div>

</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#/why-ridge-and-lasso" id="/toc-why-ridge-and-lasso">Why Ridge and Lasso?</a></li>



<li><a href="#/ridge" id="/toc-ridge">Ridge</a></li>
<li><a href="#/lasso" id="/toc-lasso">Lasso</a></li>
<li><a href="#/theoretical-example-p-n-p-n-p-n" id="/toc-theoretical-example-p-n-p-n-p-n">Theoretical Example: (p = n, p &lt; n, p &gt; n)</a>
<ul>
<li><a href="#/p-n" id="/toc-p-n">p = n</a></li>
</ul></li>






<li>
<ul>
<li><a href="#/p-n-1" id="/toc-p-n-1">p &lt; n</a></li>
</ul></li>






<li>
<ul>
<li><a href="#/p-n-2" id="/toc-p-n-2">p &gt; n</a></li>
</ul></li>






<li><a href="#/practical-applications-of-ridge-and-lasso-to-credit-data-islrv2-with-loocv" id="/toc-practical-applications-of-ridge-and-lasso-to-credit-data-islrv2-with-loocv">Practical applications of Ridge and Lasso to Credit data (ISLRv2) with LOOCV</a></li>
<li>
<ul>
<li><a href="#/ridge-1" id="/toc-ridge-1">Ridge</a></li>
</ul></li>






<li>
<ul>
<li><a href="#/lasso-1" id="/toc-lasso-1">Lasso</a></li>
</ul></li>




<li><a href="#/practical-application-of-ridge-and-lasso-to-a-real-dataset-wine" id="/toc-practical-application-of-ridge-and-lasso-to-a-real-dataset-wine">Practical application of Ridge and Lasso to a real dataset (wine)</a></li>


<li>
<ul>
<li><a href="#/ridge-and-lasso" id="/toc-ridge-and-lasso">Ridge and Lasso</a></li>
</ul></li>







</ul>
</nav>
</section>
<section id="why-ridge-and-lasso" class="slide level2">
<h2>Why Ridge and Lasso?</h2>
<ul>
<li>Ridge and Lasso regression both aim to improve upon standard linear regression with the goal of producing a model that has less variance in exchange for more bias.</li>
<li>Both are also effective for correcting for multicollinearity.
<ul>
<li>In practice, ridge and lasso introduce a “shrinkage penalty” to the loss function (RSS) which applies more to larger coefficients, and less to smaller coefficients, shrinking some coefficients close or equal to 0. The shrinkage penalty does not apply to <span class="math inline">\(\beta_0\)</span>.</li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li>Ridge and lasso are tuned by adjusting <span class="math inline">\(\lambda\)</span> (shrinkage penalty) with cross-validation; at <span class="math inline">\(\lambda=0\)</span>, the regression is equivalent to LSE. At <span class="math inline">\(\lambda=\inf\)</span>, the predictors are 0. Increasing lambda = less flexibility = less variance, but more bias.</li>
<li>This process can not only reduce the complexity of extremely large models (think 1000+ parameters), but it can also be a suitable alternative to LOOCV or other selection methods which become impractical at large parameter counts.</li>
<li><em>Multiplying a predictor by a constant can change coefficient estimates substantially when using ridge/lasso.</em></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li>When considering the linear algebra model of Linear Regression, <span class="math inline">\(x^Tx\)</span> is the source of variation in a model.</li>
<li>When <span class="math inline">\(x^Tx\)</span> is small (i.e.&nbsp;there are more predictors (p) than data-points (n)), it may become ill-conditioned and difficult to solve.</li>
<li>By using ridge/lasso, one is adding to the diagonal elements of <span class="math inline">\(x^Tx\)</span> (regularization), making the off diagonals less important. This helps to make p &gt; n solvable.</li>
</ul>
</section>
<section class="slide level2">

<p>Essentially, the process for either is as follows (ISLR 6.2.3):</p>
<ul>
<li><strong>Standardize the data, if required (subtract x by mean, and divide by standard deviation)</strong></li>
<li>Define a set of <span class="math inline">\(\lambda\)</span> to test</li>
<li>Perform LOOCV for each <span class="math inline">\(\lambda\)</span></li>
<li>Choose the <span class="math inline">\(\lambda\)</span> that picks the lowest LOOCV value (i.e.&nbsp;residual)</li>
<li>Refit the model using all of the available observations, and the selected tuning parameter.</li>
</ul>
</section>
<section id="ridge" class="slide level2">
<h2>Ridge</h2>
<p>Minimize <span class="math inline">\(\Sigma_{i=1}^n{(y_i-\beta_0-\Sigma_{j=1}^p{\beta_jx_{ij}})^2}+\lambda\Sigma_{j=1}^p{\beta_j^2}=RSS+\lambda\Sigma_{j=1}^p\beta_j^2\)</span></p>
<ul>
<li>One defining characteristic of ridge regression is that all predictors (p) are used; none will be exactly 0. This may cause problems when p is very large.</li>
<li>Use <code>glmnet(x_mat, y_mat, alpha = 0)</code></li>
</ul>
</section>
<section id="lasso" class="slide level2">
<h2>Lasso</h2>
<p>Minimize <span class="math inline">\(\Sigma_{i=1}^n(y_i-\beta_0-\sigma_{j=1}^p\beta_jx_{ij})^2 + \lambda\Sigma_{j=1}^p|\beta_j| = RSS + \lambda\Sigma_{j=1}^p|\beta_j|\)</span></p>
<ul>
<li>Like ridge regression, but some parameters go to exactly 0.</li>
<li>Slightly higher variance than ridge.</li>
<li>In theory, lasso can provide a more sparse model than ridge, but this does not necessarily mean more interpretable results on actual data.
<ul>
<li>Actual data often cannot be explained with an overly sparse model.</li>
</ul></li>
<li>use <code>glmnet(x_mat, y_mat, alpha = 1)</code></li>
</ul>
</section>
<section id="theoretical-example-p-n-p-n-p-n" class="slide level2">
<h2>Theoretical Example: (p = n, p &lt; n, p &gt; n)</h2>
<h3 id="p-n">p = n</h3>
<p>In this scenario, there are the same amount of predictors as datapoints. What happens when running ridge / lasso?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">12</span>)</span>
<span id="cb1-2"><a href=""></a><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb1-3"><a href=""></a></span>
<span id="cb1-4"><a href=""></a><span class="co"># Set up parallelized LOOCV for the huge dataset (ridge)</span></span>
<span id="cb1-5"><a href=""></a>cv_ridge_parallel <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, selected_lambda) {</span>
<span id="cb1-6"><a href=""></a>  </span>
<span id="cb1-7"><a href=""></a>  <span class="co">#for (i in 1:nrow(dataset)) {</span></span>
<span id="cb1-8"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-9"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(dataset), <span class="at">.packages =</span> <span class="st">'glmnet'</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb1-10"><a href=""></a>    test_row <span class="ot">&lt;-</span> dataset[i,]</span>
<span id="cb1-11"><a href=""></a>    test_row_x <span class="ot">&lt;-</span> test_row[<span class="dv">2</span><span class="sc">:</span><span class="dv">1001</span>]</span>
<span id="cb1-12"><a href=""></a>    test_row_y <span class="ot">&lt;-</span> test_row[<span class="dv">1</span>]</span>
<span id="cb1-13"><a href=""></a>    </span>
<span id="cb1-14"><a href=""></a>    train_rows <span class="ot">&lt;-</span> dataset[<span class="sc">-</span>i,]</span>
<span id="cb1-15"><a href=""></a>    train_rows_x <span class="ot">&lt;-</span> train_rows[,<span class="dv">2</span><span class="sc">:</span><span class="dv">1001</span>]</span>
<span id="cb1-16"><a href=""></a>    train_rows_y <span class="ot">&lt;-</span> train_rows[,<span class="dv">1</span>]</span>
<span id="cb1-17"><a href=""></a>    </span>
<span id="cb1-18"><a href=""></a>    <span class="co"># Train gaussian model</span></span>
<span id="cb1-19"><a href=""></a>    single_model_ridge <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(train_rows_x), <span class="at">y =</span> train_rows_y, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> selected_lambda, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb1-20"><a href=""></a>    <span class="co"># Test the model</span></span>
<span id="cb1-21"><a href=""></a>    predict_result <span class="ot">&lt;-</span> <span class="fu">predict</span>(single_model_ridge, <span class="at">newx =</span> test_row_x)</span>
<span id="cb1-22"><a href=""></a>    <span class="co"># Calculate RSS</span></span>
<span id="cb1-23"><a href=""></a>    rss <span class="ot">&lt;-</span> (test_row_y <span class="sc">-</span> predict_result) <span class="sc">**</span> <span class="dv">2</span></span>
<span id="cb1-24"><a href=""></a>    <span class="fu">return</span>(rss)</span>
<span id="cb1-25"><a href=""></a>    <span class="co">#cv_total[i] = rss</span></span>
<span id="cb1-26"><a href=""></a>  }</span>
<span id="cb1-27"><a href=""></a>  <span class="fu">stopifnot</span>(<span class="fu">length</span>(cv_total)<span class="sc">==</span> <span class="fu">nrow</span>(data_multi))</span>
<span id="cb1-28"><a href=""></a>  <span class="fu">return</span> (cv_total)</span>
<span id="cb1-29"><a href=""></a>}</span>
<span id="cb1-30"><a href=""></a></span>
<span id="cb1-31"><a href=""></a><span class="co"># lasso</span></span>
<span id="cb1-32"><a href=""></a>cv_lasso_parallel <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, selected_lambda) {</span>
<span id="cb1-33"><a href=""></a>  </span>
<span id="cb1-34"><a href=""></a>  <span class="co">#for (i in 1:nrow(dataset)) {</span></span>
<span id="cb1-35"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb1-36"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(dataset), <span class="at">.packages =</span> <span class="st">'glmnet'</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb1-37"><a href=""></a>    test_row <span class="ot">&lt;-</span> dataset[i,]</span>
<span id="cb1-38"><a href=""></a>    test_row_x <span class="ot">&lt;-</span> test_row[<span class="dv">2</span><span class="sc">:</span><span class="dv">1001</span>]</span>
<span id="cb1-39"><a href=""></a>    test_row_y <span class="ot">&lt;-</span> test_row[<span class="dv">1</span>]</span>
<span id="cb1-40"><a href=""></a>    </span>
<span id="cb1-41"><a href=""></a>    train_rows <span class="ot">&lt;-</span> dataset[<span class="sc">-</span>i,]</span>
<span id="cb1-42"><a href=""></a>    train_rows_x <span class="ot">&lt;-</span> train_rows[,<span class="dv">2</span><span class="sc">:</span><span class="dv">1001</span>]</span>
<span id="cb1-43"><a href=""></a>    train_rows_y <span class="ot">&lt;-</span> train_rows[,<span class="dv">1</span>]</span>
<span id="cb1-44"><a href=""></a>    </span>
<span id="cb1-45"><a href=""></a>    <span class="co"># Train gaussian model</span></span>
<span id="cb1-46"><a href=""></a>    single_model_lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(train_rows_x), <span class="at">y =</span> train_rows_y, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> selected_lambda, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb1-47"><a href=""></a>    <span class="co"># Test the model</span></span>
<span id="cb1-48"><a href=""></a>    predict_result <span class="ot">&lt;-</span> <span class="fu">predict</span>(single_model_lasso, <span class="at">newx =</span> test_row_x)</span>
<span id="cb1-49"><a href=""></a>    <span class="co"># Calculate RSS</span></span>
<span id="cb1-50"><a href=""></a>    rss <span class="ot">&lt;-</span> (test_row_y <span class="sc">-</span> predict_result) <span class="sc">**</span> <span class="dv">2</span></span>
<span id="cb1-51"><a href=""></a>    <span class="fu">return</span>(rss)</span>
<span id="cb1-52"><a href=""></a>    <span class="co">#cv_total[i] = rss</span></span>
<span id="cb1-53"><a href=""></a>  }</span>
<span id="cb1-54"><a href=""></a>  <span class="fu">stopifnot</span>(<span class="fu">length</span>(cv_total)<span class="sc">==</span> <span class="fu">nrow</span>(data_multi))</span>
<span id="cb1-55"><a href=""></a>  <span class="fu">return</span> (cv_total)</span>
<span id="cb1-56"><a href=""></a>}</span>
<span id="cb1-57"><a href=""></a></span>
<span id="cb1-58"><a href=""></a></span>
<span id="cb1-59"><a href=""></a><span class="co"># No standardization necessary, since data is from a std. normal distribution.</span></span>
<span id="cb1-60"><a href=""></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-61"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-62"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">199</span>)</span>
<span id="cb1-63"><a href=""></a><span class="co"># Generate correlated data from multivariate normal distribution</span></span>
<span id="cb1-64"><a href=""></a><span class="co"># Modified from STA108 lecture</span></span>
<span id="cb1-65"><a href=""></a>means <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">1001</span>)</span>
<span id="cb1-66"><a href=""></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">1001</span>, <span class="at">ncol =</span> <span class="dv">1001</span>)</span>
<span id="cb1-67"><a href=""></a>correlation <span class="ot">&lt;-</span> <span class="fl">0.7</span> <span class="co"># assume correlation is 0.7</span></span>
<span id="cb1-68"><a href=""></a><span class="fu">diag</span>(Sigma) <span class="ot">&lt;-</span> <span class="fl">1.0</span> <span class="co"># set diagonals of Sigma to 1.</span></span>
<span id="cb1-69"><a href=""></a></span>
<span id="cb1-70"><a href=""></a><span class="co"># set everything else to 0.7</span></span>
<span id="cb1-71"><a href=""></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Sigma)) {</span>
<span id="cb1-72"><a href=""></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(Sigma)) {</span>
<span id="cb1-73"><a href=""></a>    <span class="cf">if</span> (i <span class="sc">!=</span> j) {</span>
<span id="cb1-74"><a href=""></a>      Sigma[i,j] <span class="ot">=</span> <span class="fl">0.7</span></span>
<span id="cb1-75"><a href=""></a>    }</span>
<span id="cb1-76"><a href=""></a>  }</span>
<span id="cb1-77"><a href=""></a>}</span>
<span id="cb1-78"><a href=""></a></span>
<span id="cb1-79"><a href=""></a>data_multi <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">1000</span>,means,Sigma)</span>
<span id="cb1-80"><a href=""></a><span class="co"># First col of data_multi is y, the remaining are xs.</span></span>
<span id="cb1-81"><a href=""></a></span>
<span id="cb1-82"><a href=""></a><span class="co"># Step 2: Try lambdas</span></span>
<span id="cb1-83"><a href=""></a>lambdas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.0005</span>, <span class="fl">0.005</span>, <span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>)</span>
<span id="cb1-84"><a href=""></a></span>
<span id="cb1-85"><a href=""></a><span class="co"># Step 3: Perform LOOCV</span></span>
<span id="cb1-86"><a href=""></a>results <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(<span class="at">Lambda =</span> <span class="fu">numeric</span>(), <span class="at">CV_ridge =</span> <span class="fu">numeric</span>(), <span class="at">CV_lasso=</span><span class="fu">numeric</span>())</span>
<span id="cb1-87"><a href=""></a><span class="cf">for</span> (curr_lambda <span class="cf">in</span> lambdas) {</span>
<span id="cb1-88"><a href=""></a>  <span class="co"># cross_validation_total &lt;- c()</span></span>
<span id="cb1-89"><a href=""></a>  <span class="co"># cross_validation_total &lt;- c(cross_validation_total, </span></span>
<span id="cb1-90"><a href=""></a>  <span class="co">#                             clusterApply(cl = clusterOfThreads,</span></span>
<span id="cb1-91"><a href=""></a>  <span class="co">#                                          x = data_multi,</span></span>
<span id="cb1-92"><a href=""></a>  <span class="co">#                                          fun = cv_ridge_parallel)</span></span>
<span id="cb1-93"><a href=""></a>  <span class="co">#                           )</span></span>
<span id="cb1-94"><a href=""></a>  cv_total_for_lambda_ridge <span class="ot">&lt;-</span> <span class="fu">cv_ridge_parallel</span>(data_multi, curr_lambda)</span>
<span id="cb1-95"><a href=""></a>  cv_total_for_lambda_lasso <span class="ot">&lt;-</span> <span class="fu">cv_lasso_parallel</span>(data_multi, curr_lambda)</span>
<span id="cb1-96"><a href=""></a>  </span>
<span id="cb1-97"><a href=""></a>  results <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> <span class="fu">add_row</span>(<span class="at">Lambda =</span> curr_lambda, <span class="at">CV_ridge =</span> <span class="fu">sum</span>(<span class="fu">unlist</span>(cv_total_for_lambda_ridge)) <span class="sc">/</span> <span class="fu">nrow</span>(data_multi), <span class="at">CV_lasso =</span> <span class="fu">sum</span>(<span class="fu">unlist</span>(cv_total_for_lambda_lasso)) <span class="sc">/</span> <span class="fu">nrow</span>(data_multi))</span>
<span id="cb1-98"><a href=""></a>}</span>
<span id="cb1-99"><a href=""></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="fu">kable</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">Lambda</th>
<th style="text-align: right;">CV_ridge</th>
<th style="text-align: right;">CV_lasso</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">4.3496043</td>
<td style="text-align: right;">4.3496043</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0005</td>
<td style="text-align: right;">3.2815437</td>
<td style="text-align: right;">1.1280317</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.0050</td>
<td style="text-align: right;">1.5511477</td>
<td style="text-align: right;">0.3748612</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.0500</td>
<td style="text-align: right;">0.5488783</td>
<td style="text-align: right;">0.3065855</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.5000</td>
<td style="text-align: right;">0.3201091</td>
<td style="text-align: right;">0.6476368</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.0000</td>
<td style="text-align: right;">0.3070281</td>
<td style="text-align: right;">1.0294825</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0000</td>
<td style="text-align: right;">0.2977362</td>
<td style="text-align: right;">1.0294825</td>
</tr>
<tr class="even">
<td style="text-align: right;">10.0000</td>
<td style="text-align: right;">0.2974140</td>
<td style="text-align: right;">1.0294825</td>
</tr>
<tr class="odd">
<td style="text-align: right;">15.0000</td>
<td style="text-align: right;">0.2981757</td>
<td style="text-align: right;">1.0294825</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="fu">ggplot</span>(<span class="at">data =</span> results, <span class="fu">aes</span>(<span class="at">x =</span> lambdas, <span class="at">y =</span> CV_ridge)) <span class="sc">+</span></span>
<span id="cb3-2"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(CV_ridge,<span class="dv">4</span>), <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Lambda"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"CV vs Lambda (Ridge)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RidgeAndLassoPresentation_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="fu">ggplot</span>(<span class="at">data =</span> results, <span class="fu">aes</span>(<span class="at">x =</span> lambdas, <span class="at">y =</span> CV_lasso)) <span class="sc">+</span></span>
<span id="cb4-2"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(CV_lasso,<span class="dv">4</span>), <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Lambda"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"CV vs Lambda (Lasso)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RidgeAndLassoPresentation_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a>x <span class="ot">&lt;-</span> data_multi[,<span class="dv">2</span><span class="sc">:</span><span class="dv">1001</span>]</span>
<span id="cb5-2"><a href=""></a>y <span class="ot">&lt;-</span> data_multi[,<span class="dv">1</span>]</span>
<span id="cb5-3"><a href=""></a>final_model_ridge <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> <span class="dv">10</span>, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb5-4"><a href=""></a>final_model_ridge<span class="sc">$</span>dev.ratio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7283674</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a>final_model_lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> <span class="fl">0.05</span>, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb7-2"><a href=""></a>final_model_lasso<span class="sc">$</span>dev.ratio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.742625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a>data_multi_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data_multi)</span>
<span id="cb9-2"><a href=""></a>final_model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(V1 <span class="sc">~</span> . , <span class="at">data =</span> data_multi_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>Since we see that a lambda value of 10 is best for ridge and a lambda value of 0.005 is best for lasso, we train the final models on those. Although this lambda does not minimize R^2 (which always increases with parameter count) as shown in a glmnet() call, it should be noted that LOOCV helps to prevent overfit, so it is the better metric to consider.</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="fu">summary</span>(final_model_lm) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = V1 ~ ., data = data_multi_df)

Residuals:
ALL 1000 residuals are 0: no residual degrees of freedom!

Coefficients: (1 not defined because of singularities)
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    3.88274        NaN     NaN      NaN
V2            37.83773        NaN     NaN      NaN
V3           -23.89418        NaN     NaN      NaN
V4            18.17227        NaN     NaN      NaN
V5             9.54450        NaN     NaN      NaN
V6            -7.68501        NaN     NaN      NaN
V7           -12.93207        NaN     NaN      NaN
V8           -19.05214        NaN     NaN      NaN
V9           -45.44169        NaN     NaN      NaN
V10          -40.16554        NaN     NaN      NaN
V11           21.23171        NaN     NaN      NaN
V12          -93.49957        NaN     NaN      NaN
V13          -32.59673        NaN     NaN      NaN
V14            6.13240        NaN     NaN      NaN
V15          -43.65287        NaN     NaN      NaN
V16          -19.90262        NaN     NaN      NaN
V17           18.23276        NaN     NaN      NaN
V18          -50.52232        NaN     NaN      NaN
V19          -28.70712        NaN     NaN      NaN
V20          -10.48960        NaN     NaN      NaN
V21           -9.27135        NaN     NaN      NaN
V22           -6.25015        NaN     NaN      NaN
V23           17.13341        NaN     NaN      NaN
V24           33.32974        NaN     NaN      NaN
V25           11.55953        NaN     NaN      NaN
V26          -16.06545        NaN     NaN      NaN
V27           70.70674        NaN     NaN      NaN
V28          -42.81732        NaN     NaN      NaN
V29          -17.37733        NaN     NaN      NaN
V30          -16.34415        NaN     NaN      NaN
V31           -1.39507        NaN     NaN      NaN
V32           38.51877        NaN     NaN      NaN
V33          -40.49849        NaN     NaN      NaN
V34            2.74971        NaN     NaN      NaN
V35           11.75699        NaN     NaN      NaN
V36          -13.53274        NaN     NaN      NaN
V37           33.94873        NaN     NaN      NaN
V38          -46.48300        NaN     NaN      NaN
V39          -35.65460        NaN     NaN      NaN
V40          -23.39513        NaN     NaN      NaN
V41           57.67812        NaN     NaN      NaN
V42          -23.15221        NaN     NaN      NaN
V43          -33.63073        NaN     NaN      NaN
V44           51.43203        NaN     NaN      NaN
V45          -26.95798        NaN     NaN      NaN
V46          -14.24389        NaN     NaN      NaN
V47           52.83404        NaN     NaN      NaN
V48           28.60072        NaN     NaN      NaN
V49            0.33895        NaN     NaN      NaN
V50           39.70746        NaN     NaN      NaN
V51           -1.37180        NaN     NaN      NaN
V52            0.12088        NaN     NaN      NaN
V53           50.98282        NaN     NaN      NaN
V54          -15.19037        NaN     NaN      NaN
V55          -12.68812        NaN     NaN      NaN
V56           34.53922        NaN     NaN      NaN
V57          -12.54917        NaN     NaN      NaN
V58           62.61967        NaN     NaN      NaN
V59          -13.26176        NaN     NaN      NaN
V60           26.09891        NaN     NaN      NaN
V61            6.48537        NaN     NaN      NaN
V62            1.90875        NaN     NaN      NaN
V63           31.28226        NaN     NaN      NaN
V64          -12.71017        NaN     NaN      NaN
V65           33.94928        NaN     NaN      NaN
V66          -27.99295        NaN     NaN      NaN
V67            9.94533        NaN     NaN      NaN
V68           22.57877        NaN     NaN      NaN
V69           48.31202        NaN     NaN      NaN
V70          -54.53600        NaN     NaN      NaN
V71           10.69707        NaN     NaN      NaN
V72          -10.70245        NaN     NaN      NaN
V73           -1.64321        NaN     NaN      NaN
V74          -31.19471        NaN     NaN      NaN
V75           -7.07708        NaN     NaN      NaN
V76           20.10651        NaN     NaN      NaN
V77           47.13454        NaN     NaN      NaN
V78            6.31193        NaN     NaN      NaN
V79           48.92575        NaN     NaN      NaN
V80          -22.90834        NaN     NaN      NaN
V81           25.31956        NaN     NaN      NaN
V82            3.32698        NaN     NaN      NaN
V83          -52.79240        NaN     NaN      NaN
V84           31.64007        NaN     NaN      NaN
V85            2.07474        NaN     NaN      NaN
V86           41.98334        NaN     NaN      NaN
V87            8.93948        NaN     NaN      NaN
V88          -33.92041        NaN     NaN      NaN
V89           57.48743        NaN     NaN      NaN
V90          -36.59735        NaN     NaN      NaN
V91           79.39706        NaN     NaN      NaN
V92          -32.02556        NaN     NaN      NaN
V93           10.26476        NaN     NaN      NaN
V94           -4.54732        NaN     NaN      NaN
V95            1.31726        NaN     NaN      NaN
V96           17.89017        NaN     NaN      NaN
V97            6.42736        NaN     NaN      NaN
V98          -16.79573        NaN     NaN      NaN
V99           42.31315        NaN     NaN      NaN
V100          28.72550        NaN     NaN      NaN
V101         -18.12098        NaN     NaN      NaN
V102           6.67262        NaN     NaN      NaN
V103         -34.89086        NaN     NaN      NaN
V104          19.53071        NaN     NaN      NaN
V105         -13.99837        NaN     NaN      NaN
V106          -8.30452        NaN     NaN      NaN
V107           7.74507        NaN     NaN      NaN
V108          -0.42309        NaN     NaN      NaN
V109          11.21466        NaN     NaN      NaN
V110          -2.93438        NaN     NaN      NaN
V111         -18.73674        NaN     NaN      NaN
V112         -47.91186        NaN     NaN      NaN
V113         -34.57564        NaN     NaN      NaN
V114         -35.74864        NaN     NaN      NaN
V115         -28.42490        NaN     NaN      NaN
V116         -31.85246        NaN     NaN      NaN
V117          16.24032        NaN     NaN      NaN
V118         -21.51312        NaN     NaN      NaN
V119          18.84552        NaN     NaN      NaN
V120           0.04308        NaN     NaN      NaN
V121         -43.35420        NaN     NaN      NaN
V122         -10.53149        NaN     NaN      NaN
V123         -45.73198        NaN     NaN      NaN
V124          61.16782        NaN     NaN      NaN
V125          41.66483        NaN     NaN      NaN
V126           3.13836        NaN     NaN      NaN
V127         -35.68057        NaN     NaN      NaN
V128         -24.25297        NaN     NaN      NaN
V129          28.07896        NaN     NaN      NaN
V130          -1.40617        NaN     NaN      NaN
V131          31.45466        NaN     NaN      NaN
V132         -75.07011        NaN     NaN      NaN
V133           5.64416        NaN     NaN      NaN
V134         -38.63297        NaN     NaN      NaN
V135         -41.34494        NaN     NaN      NaN
V136          -0.58838        NaN     NaN      NaN
V137          35.74113        NaN     NaN      NaN
V138         -77.18727        NaN     NaN      NaN
V139           2.22028        NaN     NaN      NaN
V140         -19.05257        NaN     NaN      NaN
V141         -33.76364        NaN     NaN      NaN
V142           1.36508        NaN     NaN      NaN
V143          47.38363        NaN     NaN      NaN
V144          31.50212        NaN     NaN      NaN
V145          39.30262        NaN     NaN      NaN
V146         -57.27871        NaN     NaN      NaN
V147          20.40282        NaN     NaN      NaN
V148         -56.99323        NaN     NaN      NaN
V149         -22.75928        NaN     NaN      NaN
V150          -0.45385        NaN     NaN      NaN
V151         -21.37571        NaN     NaN      NaN
V152           0.98244        NaN     NaN      NaN
V153         -62.83229        NaN     NaN      NaN
V154         -19.09541        NaN     NaN      NaN
V155          40.30542        NaN     NaN      NaN
V156          40.29273        NaN     NaN      NaN
V157          15.54639        NaN     NaN      NaN
V158          22.25445        NaN     NaN      NaN
V159          19.87894        NaN     NaN      NaN
V160          50.58045        NaN     NaN      NaN
V161          33.45119        NaN     NaN      NaN
V162          52.95479        NaN     NaN      NaN
V163          -4.18650        NaN     NaN      NaN
V164          33.10788        NaN     NaN      NaN
V165          39.31756        NaN     NaN      NaN
V166          12.11786        NaN     NaN      NaN
V167          -8.67221        NaN     NaN      NaN
V168         -38.16341        NaN     NaN      NaN
V169          17.63880        NaN     NaN      NaN
V170         -24.07243        NaN     NaN      NaN
V171         -38.11007        NaN     NaN      NaN
V172          12.53307        NaN     NaN      NaN
V173           7.13012        NaN     NaN      NaN
V174          -2.64337        NaN     NaN      NaN
V175         -23.99917        NaN     NaN      NaN
V176          15.43748        NaN     NaN      NaN
V177          37.84998        NaN     NaN      NaN
V178          -4.89941        NaN     NaN      NaN
V179           6.64622        NaN     NaN      NaN
V180           3.20982        NaN     NaN      NaN
V181         -34.11294        NaN     NaN      NaN
V182         -61.52596        NaN     NaN      NaN
V183         -46.84599        NaN     NaN      NaN
V184          28.26699        NaN     NaN      NaN
V185          69.30138        NaN     NaN      NaN
V186          66.57090        NaN     NaN      NaN
V187         -21.17951        NaN     NaN      NaN
V188          27.13041        NaN     NaN      NaN
V189         -11.41036        NaN     NaN      NaN
V190           2.97642        NaN     NaN      NaN
V191          35.15692        NaN     NaN      NaN
V192          -9.00906        NaN     NaN      NaN
V193           5.06497        NaN     NaN      NaN
V194          24.56664        NaN     NaN      NaN
V195          -4.87347        NaN     NaN      NaN
V196           7.01541        NaN     NaN      NaN
V197          53.31508        NaN     NaN      NaN
V198          -2.00080        NaN     NaN      NaN
V199         -30.03346        NaN     NaN      NaN
V200         -17.33563        NaN     NaN      NaN
V201         -11.48035        NaN     NaN      NaN
V202         -28.53292        NaN     NaN      NaN
V203         -19.82920        NaN     NaN      NaN
V204          33.61384        NaN     NaN      NaN
V205         -13.54494        NaN     NaN      NaN
V206           9.72290        NaN     NaN      NaN
V207           5.27853        NaN     NaN      NaN
V208          39.79497        NaN     NaN      NaN
V209         -41.85567        NaN     NaN      NaN
V210         -47.22409        NaN     NaN      NaN
V211         -17.96847        NaN     NaN      NaN
V212          38.57089        NaN     NaN      NaN
V213         -35.28323        NaN     NaN      NaN
V214         -73.44781        NaN     NaN      NaN
V215           6.70489        NaN     NaN      NaN
V216          66.49631        NaN     NaN      NaN
V217         -28.02897        NaN     NaN      NaN
V218           9.40725        NaN     NaN      NaN
V219          23.63120        NaN     NaN      NaN
V220           0.70490        NaN     NaN      NaN
V221          -5.15677        NaN     NaN      NaN
V222          14.95378        NaN     NaN      NaN
V223          47.64345        NaN     NaN      NaN
V224          16.43875        NaN     NaN      NaN
V225          50.21909        NaN     NaN      NaN
V226          -2.33044        NaN     NaN      NaN
V227          16.60709        NaN     NaN      NaN
V228          45.62251        NaN     NaN      NaN
V229         -31.22847        NaN     NaN      NaN
V230          56.42755        NaN     NaN      NaN
V231          26.99746        NaN     NaN      NaN
V232          44.43904        NaN     NaN      NaN
V233         -50.16067        NaN     NaN      NaN
V234          -5.92150        NaN     NaN      NaN
V235         -16.90272        NaN     NaN      NaN
V236         -25.71388        NaN     NaN      NaN
V237         -13.08114        NaN     NaN      NaN
V238           5.18091        NaN     NaN      NaN
V239         -17.01610        NaN     NaN      NaN
V240         -27.69598        NaN     NaN      NaN
V241          15.58261        NaN     NaN      NaN
V242           8.78874        NaN     NaN      NaN
V243           9.62146        NaN     NaN      NaN
V244          19.31407        NaN     NaN      NaN
V245          40.39488        NaN     NaN      NaN
V246           8.48884        NaN     NaN      NaN
V247         -12.11908        NaN     NaN      NaN
V248         -19.56495        NaN     NaN      NaN
V249          30.26955        NaN     NaN      NaN
V250         -27.49894        NaN     NaN      NaN
V251          -2.33621        NaN     NaN      NaN
V252         -11.13621        NaN     NaN      NaN
V253          16.16127        NaN     NaN      NaN
V254          -4.88605        NaN     NaN      NaN
V255          19.76138        NaN     NaN      NaN
V256          15.53904        NaN     NaN      NaN
V257           3.58678        NaN     NaN      NaN
V258         -51.03624        NaN     NaN      NaN
V259         -10.61410        NaN     NaN      NaN
V260          48.85574        NaN     NaN      NaN
V261          27.60355        NaN     NaN      NaN
V262         -33.30837        NaN     NaN      NaN
V263         -19.55829        NaN     NaN      NaN
V264          19.00505        NaN     NaN      NaN
V265         -32.80773        NaN     NaN      NaN
V266          26.77611        NaN     NaN      NaN
V267           4.76871        NaN     NaN      NaN
V268         -43.99231        NaN     NaN      NaN
V269          13.76035        NaN     NaN      NaN
V270          74.98714        NaN     NaN      NaN
V271         -12.73360        NaN     NaN      NaN
V272          33.65795        NaN     NaN      NaN
V273          25.23086        NaN     NaN      NaN
V274          10.97299        NaN     NaN      NaN
V275          26.35129        NaN     NaN      NaN
V276          15.45863        NaN     NaN      NaN
V277          21.81387        NaN     NaN      NaN
V278         -16.02113        NaN     NaN      NaN
V279         -39.65363        NaN     NaN      NaN
V280         -25.77317        NaN     NaN      NaN
V281         -10.29241        NaN     NaN      NaN
V282          26.21112        NaN     NaN      NaN
V283          19.22827        NaN     NaN      NaN
V284           7.19480        NaN     NaN      NaN
V285          19.17953        NaN     NaN      NaN
V286         -50.88868        NaN     NaN      NaN
V287          -6.03383        NaN     NaN      NaN
V288          29.43509        NaN     NaN      NaN
V289          17.76694        NaN     NaN      NaN
V290          18.16339        NaN     NaN      NaN
V291           5.09276        NaN     NaN      NaN
V292          53.07158        NaN     NaN      NaN
V293         -15.48938        NaN     NaN      NaN
V294          -4.49422        NaN     NaN      NaN
V295           1.75366        NaN     NaN      NaN
V296         -18.23240        NaN     NaN      NaN
V297          -6.83073        NaN     NaN      NaN
V298          24.19207        NaN     NaN      NaN
V299         -69.08296        NaN     NaN      NaN
V300         -40.87413        NaN     NaN      NaN
V301           5.07183        NaN     NaN      NaN
V302          15.90506        NaN     NaN      NaN
V303          19.77719        NaN     NaN      NaN
V304         -23.54195        NaN     NaN      NaN
V305          -5.79899        NaN     NaN      NaN
V306          -4.68787        NaN     NaN      NaN
V307         -20.57894        NaN     NaN      NaN
V308          52.49597        NaN     NaN      NaN
V309          52.88182        NaN     NaN      NaN
V310         -10.05095        NaN     NaN      NaN
V311          25.06364        NaN     NaN      NaN
V312          -7.84928        NaN     NaN      NaN
V313          29.68708        NaN     NaN      NaN
V314           0.74646        NaN     NaN      NaN
V315          31.85792        NaN     NaN      NaN
V316          57.03609        NaN     NaN      NaN
V317          -2.33499        NaN     NaN      NaN
V318          11.20122        NaN     NaN      NaN
V319          11.00698        NaN     NaN      NaN
V320         -38.34726        NaN     NaN      NaN
V321          46.01714        NaN     NaN      NaN
V322          57.98833        NaN     NaN      NaN
V323          48.87446        NaN     NaN      NaN
V324          64.78431        NaN     NaN      NaN
V325          21.26824        NaN     NaN      NaN
V326         -22.00028        NaN     NaN      NaN
V327         -34.58102        NaN     NaN      NaN
V328          -8.69531        NaN     NaN      NaN
V329          14.95569        NaN     NaN      NaN
V330         -36.91183        NaN     NaN      NaN
V331         -29.07061        NaN     NaN      NaN
V332          14.35234        NaN     NaN      NaN
V333          30.13716        NaN     NaN      NaN
V334         -22.85825        NaN     NaN      NaN
V335          -2.98552        NaN     NaN      NaN
V336           1.54335        NaN     NaN      NaN
V337          24.27247        NaN     NaN      NaN
V338          53.11509        NaN     NaN      NaN
V339         -19.05411        NaN     NaN      NaN
V340          28.32259        NaN     NaN      NaN
V341          -4.49964        NaN     NaN      NaN
V342          -8.14135        NaN     NaN      NaN
V343          10.72031        NaN     NaN      NaN
V344          40.63052        NaN     NaN      NaN
V345           4.98115        NaN     NaN      NaN
V346         -46.79204        NaN     NaN      NaN
V347         -34.04600        NaN     NaN      NaN
V348         -41.98840        NaN     NaN      NaN
V349         -27.80155        NaN     NaN      NaN
V350         -15.35906        NaN     NaN      NaN
V351          43.02511        NaN     NaN      NaN
V352          14.97848        NaN     NaN      NaN
V353          16.29594        NaN     NaN      NaN
V354         -44.65362        NaN     NaN      NaN
V355         -14.06862        NaN     NaN      NaN
V356         -14.95312        NaN     NaN      NaN
V357         -15.86232        NaN     NaN      NaN
V358           4.64752        NaN     NaN      NaN
V359         -10.62577        NaN     NaN      NaN
V360           1.67984        NaN     NaN      NaN
V361         -36.01491        NaN     NaN      NaN
V362           2.47796        NaN     NaN      NaN
V363          -5.65010        NaN     NaN      NaN
V364           0.35730        NaN     NaN      NaN
V365          -3.00481        NaN     NaN      NaN
V366          -1.42085        NaN     NaN      NaN
V367           1.21601        NaN     NaN      NaN
V368           0.99927        NaN     NaN      NaN
V369          19.05719        NaN     NaN      NaN
V370          -9.38246        NaN     NaN      NaN
V371          25.32741        NaN     NaN      NaN
V372          12.61352        NaN     NaN      NaN
V373          -8.36120        NaN     NaN      NaN
V374          14.42189        NaN     NaN      NaN
V375         -10.40705        NaN     NaN      NaN
V376          33.08107        NaN     NaN      NaN
V377         -16.20541        NaN     NaN      NaN
V378         -11.22774        NaN     NaN      NaN
V379         -40.23346        NaN     NaN      NaN
V380         -20.61871        NaN     NaN      NaN
V381         -18.45042        NaN     NaN      NaN
V382         -23.12837        NaN     NaN      NaN
V383          49.85428        NaN     NaN      NaN
V384          -2.40224        NaN     NaN      NaN
V385          28.96716        NaN     NaN      NaN
V386         -60.36535        NaN     NaN      NaN
V387         -29.91858        NaN     NaN      NaN
V388         -38.21753        NaN     NaN      NaN
V389         -58.50508        NaN     NaN      NaN
V390          24.85306        NaN     NaN      NaN
V391          42.66440        NaN     NaN      NaN
V392         -55.43361        NaN     NaN      NaN
V393         -58.77339        NaN     NaN      NaN
V394         -24.58192        NaN     NaN      NaN
V395          25.78700        NaN     NaN      NaN
V396         -53.03515        NaN     NaN      NaN
V397          12.89610        NaN     NaN      NaN
V398          -5.98174        NaN     NaN      NaN
V399          26.11772        NaN     NaN      NaN
V400           8.42302        NaN     NaN      NaN
V401          10.07112        NaN     NaN      NaN
V402         -32.16115        NaN     NaN      NaN
V403          44.14396        NaN     NaN      NaN
V404         -30.32641        NaN     NaN      NaN
V405         -11.22868        NaN     NaN      NaN
V406         -41.02691        NaN     NaN      NaN
V407          51.92932        NaN     NaN      NaN
V408          29.71558        NaN     NaN      NaN
V409         -10.48559        NaN     NaN      NaN
V410         -32.62882        NaN     NaN      NaN
V411          -3.96300        NaN     NaN      NaN
V412           7.82366        NaN     NaN      NaN
V413          18.06104        NaN     NaN      NaN
V414          29.02021        NaN     NaN      NaN
V415          27.68364        NaN     NaN      NaN
V416          22.39186        NaN     NaN      NaN
V417         -25.19600        NaN     NaN      NaN
V418          -2.95174        NaN     NaN      NaN
V419          46.67125        NaN     NaN      NaN
V420           4.52425        NaN     NaN      NaN
V421         -26.77626        NaN     NaN      NaN
V422          13.79336        NaN     NaN      NaN
V423          -7.56115        NaN     NaN      NaN
V424         114.65179        NaN     NaN      NaN
V425         -44.35200        NaN     NaN      NaN
V426          20.65788        NaN     NaN      NaN
V427          10.66754        NaN     NaN      NaN
V428          16.09818        NaN     NaN      NaN
V429          51.14699        NaN     NaN      NaN
V430         -62.19826        NaN     NaN      NaN
V431          -8.18109        NaN     NaN      NaN
V432          -4.08217        NaN     NaN      NaN
V433          10.24243        NaN     NaN      NaN
V434         -17.18570        NaN     NaN      NaN
V435          -9.21072        NaN     NaN      NaN
V436          17.97977        NaN     NaN      NaN
V437          43.79944        NaN     NaN      NaN
V438          52.88796        NaN     NaN      NaN
V439          -5.94170        NaN     NaN      NaN
V440         -10.19050        NaN     NaN      NaN
V441         -23.51990        NaN     NaN      NaN
V442           6.89420        NaN     NaN      NaN
V443          22.23966        NaN     NaN      NaN
V444           3.05658        NaN     NaN      NaN
V445          37.34570        NaN     NaN      NaN
V446         -23.79941        NaN     NaN      NaN
V447          -6.71019        NaN     NaN      NaN
V448          31.91610        NaN     NaN      NaN
V449          11.16970        NaN     NaN      NaN
V450         -19.09260        NaN     NaN      NaN
V451          11.16055        NaN     NaN      NaN
V452         -10.23384        NaN     NaN      NaN
V453          38.14300        NaN     NaN      NaN
V454         -38.17990        NaN     NaN      NaN
V455         -38.60244        NaN     NaN      NaN
V456         -27.87472        NaN     NaN      NaN
V457         -20.42702        NaN     NaN      NaN
V458         -22.55830        NaN     NaN      NaN
V459           4.84645        NaN     NaN      NaN
V460           5.74482        NaN     NaN      NaN
V461         -18.14997        NaN     NaN      NaN
V462         -71.33883        NaN     NaN      NaN
V463          27.77976        NaN     NaN      NaN
V464         -29.23471        NaN     NaN      NaN
V465          -6.52345        NaN     NaN      NaN
V466         -81.06822        NaN     NaN      NaN
V467         -31.20107        NaN     NaN      NaN
V468          26.02871        NaN     NaN      NaN
V469          30.46522        NaN     NaN      NaN
V470         -21.68774        NaN     NaN      NaN
V471         -35.68177        NaN     NaN      NaN
V472          33.37587        NaN     NaN      NaN
V473          26.15847        NaN     NaN      NaN
V474          58.32995        NaN     NaN      NaN
V475          12.27398        NaN     NaN      NaN
V476         -10.92984        NaN     NaN      NaN
V477          41.00623        NaN     NaN      NaN
V478         -86.79878        NaN     NaN      NaN
V479         -25.33027        NaN     NaN      NaN
V480         -25.29320        NaN     NaN      NaN
V481         -35.71745        NaN     NaN      NaN
V482         -51.78521        NaN     NaN      NaN
V483          -9.11024        NaN     NaN      NaN
V484         -58.99742        NaN     NaN      NaN
V485         -56.69205        NaN     NaN      NaN
V486          16.20435        NaN     NaN      NaN
V487          21.86224        NaN     NaN      NaN
V488          34.51291        NaN     NaN      NaN
V489         -54.56904        NaN     NaN      NaN
V490          53.53948        NaN     NaN      NaN
V491         -73.01899        NaN     NaN      NaN
V492         -35.91491        NaN     NaN      NaN
V493          18.18239        NaN     NaN      NaN
V494          67.34566        NaN     NaN      NaN
V495          37.87555        NaN     NaN      NaN
V496          20.96512        NaN     NaN      NaN
V497          24.52429        NaN     NaN      NaN
V498          33.87427        NaN     NaN      NaN
V499         -19.42402        NaN     NaN      NaN
V500          22.33761        NaN     NaN      NaN
V501          22.16741        NaN     NaN      NaN
V502         -23.21441        NaN     NaN      NaN
V503          -4.52456        NaN     NaN      NaN
V504           0.01893        NaN     NaN      NaN
V505          59.21015        NaN     NaN      NaN
V506          46.73086        NaN     NaN      NaN
V507         -13.67605        NaN     NaN      NaN
V508         -34.22543        NaN     NaN      NaN
V509          -7.39918        NaN     NaN      NaN
V510          10.30155        NaN     NaN      NaN
V511         -63.87413        NaN     NaN      NaN
V512          10.61469        NaN     NaN      NaN
V513         -40.01234        NaN     NaN      NaN
V514         -33.37041        NaN     NaN      NaN
V515           2.93951        NaN     NaN      NaN
V516          15.11577        NaN     NaN      NaN
V517         -15.84781        NaN     NaN      NaN
V518         -48.00046        NaN     NaN      NaN
V519           1.77126        NaN     NaN      NaN
V520           7.83135        NaN     NaN      NaN
V521          40.46798        NaN     NaN      NaN
V522         -21.83538        NaN     NaN      NaN
V523          18.79561        NaN     NaN      NaN
V524          13.71750        NaN     NaN      NaN
V525          -5.86435        NaN     NaN      NaN
V526         -30.59924        NaN     NaN      NaN
V527         -34.98026        NaN     NaN      NaN
V528         -69.16217        NaN     NaN      NaN
V529          36.80440        NaN     NaN      NaN
V530         -40.41268        NaN     NaN      NaN
V531           1.70156        NaN     NaN      NaN
V532         -20.52913        NaN     NaN      NaN
V533          29.25923        NaN     NaN      NaN
V534          -6.20150        NaN     NaN      NaN
V535           6.20673        NaN     NaN      NaN
V536         -26.86664        NaN     NaN      NaN
V537          10.90667        NaN     NaN      NaN
V538         -40.71935        NaN     NaN      NaN
V539          43.36782        NaN     NaN      NaN
V540         -18.08365        NaN     NaN      NaN
V541          36.37971        NaN     NaN      NaN
V542         -23.79363        NaN     NaN      NaN
V543          -3.12702        NaN     NaN      NaN
V544          40.75324        NaN     NaN      NaN
V545           1.53654        NaN     NaN      NaN
V546          19.98797        NaN     NaN      NaN
V547         -20.44529        NaN     NaN      NaN
V548         -18.42676        NaN     NaN      NaN
V549          26.00402        NaN     NaN      NaN
V550         -12.90470        NaN     NaN      NaN
V551          18.63822        NaN     NaN      NaN
V552           4.06975        NaN     NaN      NaN
V553          35.14770        NaN     NaN      NaN
V554         -35.57685        NaN     NaN      NaN
V555          19.51725        NaN     NaN      NaN
V556          14.82081        NaN     NaN      NaN
V557          -7.26946        NaN     NaN      NaN
V558           2.64199        NaN     NaN      NaN
V559          27.24315        NaN     NaN      NaN
V560          -7.02515        NaN     NaN      NaN
V561          19.65491        NaN     NaN      NaN
V562         -23.45532        NaN     NaN      NaN
V563          -8.61988        NaN     NaN      NaN
V564         -19.52685        NaN     NaN      NaN
V565          11.94299        NaN     NaN      NaN
V566         -34.36418        NaN     NaN      NaN
V567         -53.48595        NaN     NaN      NaN
V568          -2.41050        NaN     NaN      NaN
V569          38.26466        NaN     NaN      NaN
V570          15.86789        NaN     NaN      NaN
V571          -0.98382        NaN     NaN      NaN
V572         -55.20360        NaN     NaN      NaN
V573           2.01769        NaN     NaN      NaN
V574          -4.25197        NaN     NaN      NaN
V575          -4.58179        NaN     NaN      NaN
V576          20.88474        NaN     NaN      NaN
V577         -34.00111        NaN     NaN      NaN
V578         -78.01413        NaN     NaN      NaN
V579          98.04666        NaN     NaN      NaN
V580          -5.36742        NaN     NaN      NaN
V581           1.49775        NaN     NaN      NaN
V582         -19.13013        NaN     NaN      NaN
V583         -22.93229        NaN     NaN      NaN
V584          22.71839        NaN     NaN      NaN
V585         -15.72441        NaN     NaN      NaN
V586         -28.16985        NaN     NaN      NaN
V587          -1.71426        NaN     NaN      NaN
V588         -10.05233        NaN     NaN      NaN
V589          41.89080        NaN     NaN      NaN
V590          23.04883        NaN     NaN      NaN
V591          -5.91825        NaN     NaN      NaN
V592         -56.30143        NaN     NaN      NaN
V593           8.94178        NaN     NaN      NaN
V594         -13.65024        NaN     NaN      NaN
V595           8.26369        NaN     NaN      NaN
V596         -31.63006        NaN     NaN      NaN
V597          14.75169        NaN     NaN      NaN
V598          18.24451        NaN     NaN      NaN
V599          21.06113        NaN     NaN      NaN
V600           4.06281        NaN     NaN      NaN
V601         -14.57387        NaN     NaN      NaN
V602          -7.14805        NaN     NaN      NaN
V603         -15.74374        NaN     NaN      NaN
V604         -15.10887        NaN     NaN      NaN
V605          37.49044        NaN     NaN      NaN
V606         -31.81076        NaN     NaN      NaN
V607          75.22680        NaN     NaN      NaN
V608          27.99123        NaN     NaN      NaN
V609          -3.75804        NaN     NaN      NaN
V610          10.77359        NaN     NaN      NaN
V611         -16.64626        NaN     NaN      NaN
V612          27.29186        NaN     NaN      NaN
V613          17.77293        NaN     NaN      NaN
V614          -7.98448        NaN     NaN      NaN
V615          38.64325        NaN     NaN      NaN
V616          25.89828        NaN     NaN      NaN
V617           5.03271        NaN     NaN      NaN
V618         -51.81865        NaN     NaN      NaN
V619          22.96264        NaN     NaN      NaN
V620          38.94196        NaN     NaN      NaN
V621          11.66747        NaN     NaN      NaN
V622          53.91629        NaN     NaN      NaN
V623           3.08797        NaN     NaN      NaN
V624          37.39448        NaN     NaN      NaN
V625          41.90192        NaN     NaN      NaN
V626           0.95253        NaN     NaN      NaN
V627          -0.90110        NaN     NaN      NaN
V628         -25.41656        NaN     NaN      NaN
V629         -55.88600        NaN     NaN      NaN
V630          -6.08532        NaN     NaN      NaN
V631          -0.14651        NaN     NaN      NaN
V632          -8.47170        NaN     NaN      NaN
V633         -21.90370        NaN     NaN      NaN
V634          53.60644        NaN     NaN      NaN
V635         -24.81008        NaN     NaN      NaN
V636           7.17998        NaN     NaN      NaN
V637         -13.05150        NaN     NaN      NaN
V638          17.80128        NaN     NaN      NaN
V639        -111.89190        NaN     NaN      NaN
V640         -16.28966        NaN     NaN      NaN
V641          36.33658        NaN     NaN      NaN
V642           7.26266        NaN     NaN      NaN
V643           6.65640        NaN     NaN      NaN
V644          35.45168        NaN     NaN      NaN
V645         -88.82094        NaN     NaN      NaN
V646         -11.09932        NaN     NaN      NaN
V647          20.86833        NaN     NaN      NaN
V648          56.92012        NaN     NaN      NaN
V649         -10.68253        NaN     NaN      NaN
V650         -23.35263        NaN     NaN      NaN
V651         -31.80084        NaN     NaN      NaN
V652         -28.80813        NaN     NaN      NaN
V653          52.53710        NaN     NaN      NaN
V654          59.93878        NaN     NaN      NaN
V655          53.25685        NaN     NaN      NaN
V656         -15.48875        NaN     NaN      NaN
V657           0.29529        NaN     NaN      NaN
V658         -37.54758        NaN     NaN      NaN
V659           8.80819        NaN     NaN      NaN
V660          -5.46427        NaN     NaN      NaN
V661          24.24031        NaN     NaN      NaN
V662          17.69241        NaN     NaN      NaN
V663          23.59566        NaN     NaN      NaN
V664         -54.49133        NaN     NaN      NaN
V665          24.33364        NaN     NaN      NaN
V666         -22.02399        NaN     NaN      NaN
V667         -40.21970        NaN     NaN      NaN
V668           6.92064        NaN     NaN      NaN
V669           9.41741        NaN     NaN      NaN
V670          34.49521        NaN     NaN      NaN
V671          -8.55171        NaN     NaN      NaN
V672          12.53307        NaN     NaN      NaN
V673           3.83243        NaN     NaN      NaN
V674           5.07619        NaN     NaN      NaN
V675          40.25708        NaN     NaN      NaN
V676          32.68640        NaN     NaN      NaN
V677          79.37150        NaN     NaN      NaN
V678         -14.03747        NaN     NaN      NaN
V679         -44.16804        NaN     NaN      NaN
V680          44.68639        NaN     NaN      NaN
V681          10.19307        NaN     NaN      NaN
V682           9.35316        NaN     NaN      NaN
V683           8.95063        NaN     NaN      NaN
V684         -17.29587        NaN     NaN      NaN
V685           7.85546        NaN     NaN      NaN
V686         -36.72113        NaN     NaN      NaN
V687         -72.66393        NaN     NaN      NaN
V688         -30.54614        NaN     NaN      NaN
V689          14.59410        NaN     NaN      NaN
V690          -5.50282        NaN     NaN      NaN
V691           9.18679        NaN     NaN      NaN
V692           1.83104        NaN     NaN      NaN
V693         -14.51200        NaN     NaN      NaN
V694          33.92500        NaN     NaN      NaN
V695          36.19346        NaN     NaN      NaN
V696          18.39010        NaN     NaN      NaN
V697          -1.69184        NaN     NaN      NaN
V698          -6.14802        NaN     NaN      NaN
V699          31.04787        NaN     NaN      NaN
V700         -85.16973        NaN     NaN      NaN
V701         -11.08642        NaN     NaN      NaN
V702          -2.98416        NaN     NaN      NaN
V703          10.50118        NaN     NaN      NaN
V704           8.32200        NaN     NaN      NaN
V705         -16.39335        NaN     NaN      NaN
V706         -25.83751        NaN     NaN      NaN
V707          24.20552        NaN     NaN      NaN
V708          36.66796        NaN     NaN      NaN
V709          33.13054        NaN     NaN      NaN
V710          -1.32829        NaN     NaN      NaN
V711           9.69605        NaN     NaN      NaN
V712         -28.64542        NaN     NaN      NaN
V713          28.43033        NaN     NaN      NaN
V714          25.02849        NaN     NaN      NaN
V715         -69.38352        NaN     NaN      NaN
V716          -4.57665        NaN     NaN      NaN
V717          10.86221        NaN     NaN      NaN
V718         -25.21869        NaN     NaN      NaN
V719          38.19785        NaN     NaN      NaN
V720           2.29079        NaN     NaN      NaN
V721         -45.85157        NaN     NaN      NaN
V722         -33.64360        NaN     NaN      NaN
V723          23.06171        NaN     NaN      NaN
V724          -1.51432        NaN     NaN      NaN
V725          17.34149        NaN     NaN      NaN
V726           2.20518        NaN     NaN      NaN
V727          33.28336        NaN     NaN      NaN
V728         -12.64087        NaN     NaN      NaN
V729         -19.75830        NaN     NaN      NaN
V730          -8.38480        NaN     NaN      NaN
V731          -0.45592        NaN     NaN      NaN
V732         -17.74828        NaN     NaN      NaN
V733         -13.70591        NaN     NaN      NaN
V734         -49.46928        NaN     NaN      NaN
V735          24.02161        NaN     NaN      NaN
V736          19.16341        NaN     NaN      NaN
V737         -19.57946        NaN     NaN      NaN
V738         -48.72041        NaN     NaN      NaN
V739         -71.21358        NaN     NaN      NaN
V740          -0.31481        NaN     NaN      NaN
V741           3.03358        NaN     NaN      NaN
V742          -1.32610        NaN     NaN      NaN
V743           9.23380        NaN     NaN      NaN
V744         -35.31847        NaN     NaN      NaN
V745          44.99371        NaN     NaN      NaN
V746          12.07130        NaN     NaN      NaN
V747          -8.17183        NaN     NaN      NaN
V748          14.72540        NaN     NaN      NaN
V749          18.76999        NaN     NaN      NaN
V750           8.52407        NaN     NaN      NaN
V751          -7.02618        NaN     NaN      NaN
V752          27.33695        NaN     NaN      NaN
V753         -36.63378        NaN     NaN      NaN
V754         -47.82143        NaN     NaN      NaN
V755         -59.46882        NaN     NaN      NaN
V756           2.31801        NaN     NaN      NaN
V757         -25.81286        NaN     NaN      NaN
V758          15.38037        NaN     NaN      NaN
V759          32.17210        NaN     NaN      NaN
V760          40.98569        NaN     NaN      NaN
V761         -54.59828        NaN     NaN      NaN
V762         -47.86474        NaN     NaN      NaN
V763          13.48227        NaN     NaN      NaN
V764          58.44044        NaN     NaN      NaN
V765          13.97314        NaN     NaN      NaN
V766          -4.42117        NaN     NaN      NaN
V767         -25.49154        NaN     NaN      NaN
V768          -0.96819        NaN     NaN      NaN
V769          -1.47456        NaN     NaN      NaN
V770          42.17817        NaN     NaN      NaN
V771           2.21012        NaN     NaN      NaN
V772          41.27103        NaN     NaN      NaN
V773         -22.87360        NaN     NaN      NaN
V774         -28.42083        NaN     NaN      NaN
V775          -0.57656        NaN     NaN      NaN
V776         -31.60771        NaN     NaN      NaN
V777          39.48466        NaN     NaN      NaN
V778          43.94239        NaN     NaN      NaN
V779          28.30480        NaN     NaN      NaN
V780          21.70726        NaN     NaN      NaN
V781         -17.14274        NaN     NaN      NaN
V782          -0.15968        NaN     NaN      NaN
V783          23.15399        NaN     NaN      NaN
V784          36.51639        NaN     NaN      NaN
V785          35.43538        NaN     NaN      NaN
V786           0.60952        NaN     NaN      NaN
V787         -25.58744        NaN     NaN      NaN
V788         -62.01645        NaN     NaN      NaN
V789         -30.13250        NaN     NaN      NaN
V790           6.62701        NaN     NaN      NaN
V791         -12.27040        NaN     NaN      NaN
V792         -29.68085        NaN     NaN      NaN
V793         -21.62852        NaN     NaN      NaN
V794           4.46197        NaN     NaN      NaN
V795          60.25146        NaN     NaN      NaN
V796         -22.71200        NaN     NaN      NaN
V797         -28.17665        NaN     NaN      NaN
V798         -10.88771        NaN     NaN      NaN
V799         -15.84513        NaN     NaN      NaN
V800         -60.86275        NaN     NaN      NaN
V801         -53.70320        NaN     NaN      NaN
V802          22.38184        NaN     NaN      NaN
V803          27.86878        NaN     NaN      NaN
V804          17.31152        NaN     NaN      NaN
V805          18.47562        NaN     NaN      NaN
V806         -12.33997        NaN     NaN      NaN
V807          38.75482        NaN     NaN      NaN
V808         -13.54012        NaN     NaN      NaN
V809           9.20226        NaN     NaN      NaN
V810          67.61518        NaN     NaN      NaN
V811         -10.15764        NaN     NaN      NaN
V812          -9.44124        NaN     NaN      NaN
V813         -27.12976        NaN     NaN      NaN
V814         -34.03344        NaN     NaN      NaN
V815          22.98390        NaN     NaN      NaN
V816           6.06144        NaN     NaN      NaN
V817          32.82832        NaN     NaN      NaN
V818         -39.99483        NaN     NaN      NaN
V819          63.84282        NaN     NaN      NaN
V820         -14.69473        NaN     NaN      NaN
V821         -13.35129        NaN     NaN      NaN
V822           2.25814        NaN     NaN      NaN
V823          13.93611        NaN     NaN      NaN
V824          23.67357        NaN     NaN      NaN
V825          10.63678        NaN     NaN      NaN
V826         -13.15939        NaN     NaN      NaN
V827          13.06906        NaN     NaN      NaN
V828          -2.59985        NaN     NaN      NaN
V829          15.31577        NaN     NaN      NaN
V830         -36.16036        NaN     NaN      NaN
V831          22.67281        NaN     NaN      NaN
V832         -47.78338        NaN     NaN      NaN
V833          -7.61877        NaN     NaN      NaN
V834          90.32761        NaN     NaN      NaN
V835         -29.19849        NaN     NaN      NaN
V836          12.29365        NaN     NaN      NaN
V837         -30.90515        NaN     NaN      NaN
V838         -10.72258        NaN     NaN      NaN
V839          39.88351        NaN     NaN      NaN
V840         -81.30279        NaN     NaN      NaN
V841         -26.81800        NaN     NaN      NaN
V842         -13.03980        NaN     NaN      NaN
V843         -34.21127        NaN     NaN      NaN
V844         -18.92728        NaN     NaN      NaN
V845         -10.50978        NaN     NaN      NaN
V846          12.57173        NaN     NaN      NaN
V847           3.00564        NaN     NaN      NaN
V848         -24.21421        NaN     NaN      NaN
V849          24.90965        NaN     NaN      NaN
V850           9.46769        NaN     NaN      NaN
V851          60.70499        NaN     NaN      NaN
V852         -32.42528        NaN     NaN      NaN
V853          10.74605        NaN     NaN      NaN
V854          19.45825        NaN     NaN      NaN
V855         -43.58170        NaN     NaN      NaN
V856         -33.32680        NaN     NaN      NaN
V857          -8.02119        NaN     NaN      NaN
V858          -0.27394        NaN     NaN      NaN
V859          21.97780        NaN     NaN      NaN
V860         -61.05028        NaN     NaN      NaN
V861          30.78928        NaN     NaN      NaN
V862           7.03296        NaN     NaN      NaN
V863         -11.20545        NaN     NaN      NaN
V864         -24.61148        NaN     NaN      NaN
V865         -31.40299        NaN     NaN      NaN
V866         -67.33455        NaN     NaN      NaN
V867           8.15499        NaN     NaN      NaN
V868          -2.34826        NaN     NaN      NaN
V869           5.18201        NaN     NaN      NaN
V870          34.35920        NaN     NaN      NaN
V871          30.28089        NaN     NaN      NaN
V872         -30.70507        NaN     NaN      NaN
V873         -46.57999        NaN     NaN      NaN
V874           9.69348        NaN     NaN      NaN
V875         -24.88154        NaN     NaN      NaN
V876         -42.88668        NaN     NaN      NaN
V877         -30.50721        NaN     NaN      NaN
V878          50.24638        NaN     NaN      NaN
V879         -19.22425        NaN     NaN      NaN
V880          -0.95201        NaN     NaN      NaN
V881         -14.24055        NaN     NaN      NaN
V882          17.02981        NaN     NaN      NaN
V883         -22.42298        NaN     NaN      NaN
V884         -19.98618        NaN     NaN      NaN
V885         -30.30521        NaN     NaN      NaN
V886          15.88043        NaN     NaN      NaN
V887         -12.00758        NaN     NaN      NaN
V888          16.81236        NaN     NaN      NaN
V889          -6.64272        NaN     NaN      NaN
V890         -38.91606        NaN     NaN      NaN
V891          23.09138        NaN     NaN      NaN
V892         -19.05322        NaN     NaN      NaN
V893           7.58750        NaN     NaN      NaN
V894         -24.59433        NaN     NaN      NaN
V895         -31.03400        NaN     NaN      NaN
V896          24.31888        NaN     NaN      NaN
V897          64.06959        NaN     NaN      NaN
V898          12.09002        NaN     NaN      NaN
V899         -11.73674        NaN     NaN      NaN
V900         -41.83143        NaN     NaN      NaN
V901          34.46400        NaN     NaN      NaN
V902          48.51118        NaN     NaN      NaN
V903          -9.74923        NaN     NaN      NaN
V904          42.91573        NaN     NaN      NaN
V905          20.07543        NaN     NaN      NaN
V906         -37.25428        NaN     NaN      NaN
V907          -6.59087        NaN     NaN      NaN
V908           0.92890        NaN     NaN      NaN
V909           0.29313        NaN     NaN      NaN
V910         -20.00586        NaN     NaN      NaN
V911         -21.83975        NaN     NaN      NaN
V912         -33.09068        NaN     NaN      NaN
V913         -57.85153        NaN     NaN      NaN
V914           2.87677        NaN     NaN      NaN
V915          10.47614        NaN     NaN      NaN
V916           0.02616        NaN     NaN      NaN
V917         -30.70893        NaN     NaN      NaN
V918          30.56429        NaN     NaN      NaN
V919          37.24899        NaN     NaN      NaN
V920          30.43439        NaN     NaN      NaN
V921          25.27515        NaN     NaN      NaN
V922          41.71935        NaN     NaN      NaN
V923         -81.62753        NaN     NaN      NaN
V924          11.62527        NaN     NaN      NaN
V925          22.11095        NaN     NaN      NaN
V926          39.60685        NaN     NaN      NaN
V927          49.59034        NaN     NaN      NaN
V928         -37.79014        NaN     NaN      NaN
V929          -8.94972        NaN     NaN      NaN
V930           1.30650        NaN     NaN      NaN
V931          32.83891        NaN     NaN      NaN
V932          17.26097        NaN     NaN      NaN
V933         -32.74345        NaN     NaN      NaN
V934         -64.87987        NaN     NaN      NaN
V935         -20.61874        NaN     NaN      NaN
V936         -20.17387        NaN     NaN      NaN
V937           8.47154        NaN     NaN      NaN
V938         -11.55618        NaN     NaN      NaN
V939         -27.92766        NaN     NaN      NaN
V940          34.24629        NaN     NaN      NaN
V941          -2.57541        NaN     NaN      NaN
V942         -18.38358        NaN     NaN      NaN
V943          -5.28777        NaN     NaN      NaN
V944          -6.51593        NaN     NaN      NaN
V945          29.52789        NaN     NaN      NaN
V946          17.83433        NaN     NaN      NaN
V947          28.22172        NaN     NaN      NaN
V948         -42.74243        NaN     NaN      NaN
V949         -31.18788        NaN     NaN      NaN
V950          32.22382        NaN     NaN      NaN
V951          43.57598        NaN     NaN      NaN
V952          25.44854        NaN     NaN      NaN
V953          13.97869        NaN     NaN      NaN
V954          25.88045        NaN     NaN      NaN
V955          45.87782        NaN     NaN      NaN
V956         -41.00784        NaN     NaN      NaN
V957         -38.82061        NaN     NaN      NaN
V958          82.57504        NaN     NaN      NaN
V959          36.70817        NaN     NaN      NaN
V960         -16.89727        NaN     NaN      NaN
V961         -28.97725        NaN     NaN      NaN
V962         -38.54930        NaN     NaN      NaN
V963          16.38360        NaN     NaN      NaN
V964         -54.06892        NaN     NaN      NaN
V965         -23.03650        NaN     NaN      NaN
V966         -51.70617        NaN     NaN      NaN
V967          38.17738        NaN     NaN      NaN
V968          27.31606        NaN     NaN      NaN
V969          21.72555        NaN     NaN      NaN
V970          34.98351        NaN     NaN      NaN
V971         -31.90294        NaN     NaN      NaN
V972          -3.66601        NaN     NaN      NaN
V973          -6.00158        NaN     NaN      NaN
V974           6.99984        NaN     NaN      NaN
V975           7.83707        NaN     NaN      NaN
V976          -7.63938        NaN     NaN      NaN
V977          80.37880        NaN     NaN      NaN
V978         -13.17556        NaN     NaN      NaN
V979           0.88107        NaN     NaN      NaN
V980          46.82348        NaN     NaN      NaN
V981          11.13168        NaN     NaN      NaN
V982          25.63152        NaN     NaN      NaN
V983          30.21474        NaN     NaN      NaN
V984          33.02639        NaN     NaN      NaN
V985           8.17747        NaN     NaN      NaN
V986          25.67642        NaN     NaN      NaN
V987           1.10148        NaN     NaN      NaN
V988         -12.14749        NaN     NaN      NaN
V989         -20.28897        NaN     NaN      NaN
V990          13.28261        NaN     NaN      NaN
V991           3.42563        NaN     NaN      NaN
V992         -34.17578        NaN     NaN      NaN
V993          34.16991        NaN     NaN      NaN
V994          16.88868        NaN     NaN      NaN
V995           6.56794        NaN     NaN      NaN
V996         -68.87817        NaN     NaN      NaN
V997          27.33918        NaN     NaN      NaN
V998          35.65547        NaN     NaN      NaN
V999          12.97160        NaN     NaN      NaN
V1000        -40.57652        NaN     NaN      NaN
V1001               NA         NA      NA       NA

Residual standard error: NaN on 0 degrees of freedom
Multiple R-squared:      1, Adjusted R-squared:    NaN 
F-statistic:   NaN on 999 and 0 DF,  p-value: NA</code></pre>
</div>
</div>
<p>In this case, when p = n, lm() stops working entirely!</p>
</section>
<section class="slide level2">

<h3 id="p-n-1">p &lt; n</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">12</span>)</span>
<span id="cb12-2"><a href=""></a><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb12-3"><a href=""></a></span>
<span id="cb12-4"><a href=""></a><span class="co"># Set up parallelized LOOCV for the huge dataset (ridge)</span></span>
<span id="cb12-5"><a href=""></a>cv_ridge_parallel <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, selected_lambda) {</span>
<span id="cb12-6"><a href=""></a>  </span>
<span id="cb12-7"><a href=""></a>  <span class="co">#for (i in 1:nrow(dataset)) {</span></span>
<span id="cb12-8"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb12-9"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(dataset), <span class="at">.packages =</span> <span class="st">'glmnet'</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb12-10"><a href=""></a>    test_row <span class="ot">&lt;-</span> dataset[i,]</span>
<span id="cb12-11"><a href=""></a>    test_row_x <span class="ot">&lt;-</span> test_row[<span class="dv">2</span><span class="sc">:</span><span class="dv">501</span>]</span>
<span id="cb12-12"><a href=""></a>    test_row_y <span class="ot">&lt;-</span> test_row[<span class="dv">1</span>]</span>
<span id="cb12-13"><a href=""></a>    </span>
<span id="cb12-14"><a href=""></a>    train_rows <span class="ot">&lt;-</span> dataset[<span class="sc">-</span>i,]</span>
<span id="cb12-15"><a href=""></a>    train_rows_x <span class="ot">&lt;-</span> train_rows[,<span class="dv">2</span><span class="sc">:</span><span class="dv">501</span>]</span>
<span id="cb12-16"><a href=""></a>    train_rows_y <span class="ot">&lt;-</span> train_rows[,<span class="dv">1</span>]</span>
<span id="cb12-17"><a href=""></a>    </span>
<span id="cb12-18"><a href=""></a>    <span class="co"># Train gaussian model</span></span>
<span id="cb12-19"><a href=""></a>    single_model_ridge <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(train_rows_x), <span class="at">y =</span> train_rows_y, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> selected_lambda, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb12-20"><a href=""></a>    <span class="co"># Test the model</span></span>
<span id="cb12-21"><a href=""></a>    predict_result <span class="ot">&lt;-</span> <span class="fu">predict</span>(single_model_ridge, <span class="at">newx =</span> test_row_x)</span>
<span id="cb12-22"><a href=""></a>    <span class="co"># Calculate RSS</span></span>
<span id="cb12-23"><a href=""></a>    rss <span class="ot">&lt;-</span> (test_row_y <span class="sc">-</span> predict_result) <span class="sc">**</span> <span class="dv">2</span></span>
<span id="cb12-24"><a href=""></a>    <span class="fu">return</span>(rss)</span>
<span id="cb12-25"><a href=""></a>    <span class="co">#cv_total[i] = rss</span></span>
<span id="cb12-26"><a href=""></a>  }</span>
<span id="cb12-27"><a href=""></a>  <span class="fu">stopifnot</span>(<span class="fu">length</span>(cv_total)<span class="sc">==</span> <span class="fu">nrow</span>(data_multi))</span>
<span id="cb12-28"><a href=""></a>  <span class="fu">return</span> (cv_total)</span>
<span id="cb12-29"><a href=""></a>}</span>
<span id="cb12-30"><a href=""></a></span>
<span id="cb12-31"><a href=""></a><span class="co"># lasso</span></span>
<span id="cb12-32"><a href=""></a>cv_lasso_parallel <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, selected_lambda) {</span>
<span id="cb12-33"><a href=""></a>  </span>
<span id="cb12-34"><a href=""></a>  <span class="co">#for (i in 1:nrow(dataset)) {</span></span>
<span id="cb12-35"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb12-36"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(dataset), <span class="at">.packages =</span> <span class="st">'glmnet'</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb12-37"><a href=""></a>    test_row <span class="ot">&lt;-</span> dataset[i,]</span>
<span id="cb12-38"><a href=""></a>    test_row_x <span class="ot">&lt;-</span> test_row[<span class="dv">2</span><span class="sc">:</span><span class="dv">501</span>]</span>
<span id="cb12-39"><a href=""></a>    test_row_y <span class="ot">&lt;-</span> test_row[<span class="dv">1</span>]</span>
<span id="cb12-40"><a href=""></a>    </span>
<span id="cb12-41"><a href=""></a>    train_rows <span class="ot">&lt;-</span> dataset[<span class="sc">-</span>i,]</span>
<span id="cb12-42"><a href=""></a>    train_rows_x <span class="ot">&lt;-</span> train_rows[,<span class="dv">2</span><span class="sc">:</span><span class="dv">501</span>]</span>
<span id="cb12-43"><a href=""></a>    train_rows_y <span class="ot">&lt;-</span> train_rows[,<span class="dv">1</span>]</span>
<span id="cb12-44"><a href=""></a>    </span>
<span id="cb12-45"><a href=""></a>    <span class="co"># Train gaussian model</span></span>
<span id="cb12-46"><a href=""></a>    single_model_lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(train_rows_x), <span class="at">y =</span> train_rows_y, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> selected_lambda, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb12-47"><a href=""></a>    <span class="co"># Test the model</span></span>
<span id="cb12-48"><a href=""></a>    predict_result <span class="ot">&lt;-</span> <span class="fu">predict</span>(single_model_lasso, <span class="at">newx =</span> test_row_x)</span>
<span id="cb12-49"><a href=""></a>    <span class="co"># Calculate RSS</span></span>
<span id="cb12-50"><a href=""></a>    rss <span class="ot">&lt;-</span> (test_row_y <span class="sc">-</span> predict_result) <span class="sc">**</span> <span class="dv">2</span></span>
<span id="cb12-51"><a href=""></a>    <span class="fu">return</span>(rss)</span>
<span id="cb12-52"><a href=""></a>    <span class="co">#cv_total[i] = rss</span></span>
<span id="cb12-53"><a href=""></a>  }</span>
<span id="cb12-54"><a href=""></a>  <span class="fu">stopifnot</span>(<span class="fu">length</span>(cv_total)<span class="sc">==</span> <span class="fu">nrow</span>(data_multi))</span>
<span id="cb12-55"><a href=""></a>  <span class="fu">return</span> (cv_total)</span>
<span id="cb12-56"><a href=""></a>}</span>
<span id="cb12-57"><a href=""></a></span>
<span id="cb12-58"><a href=""></a></span>
<span id="cb12-59"><a href=""></a><span class="co"># No standardization necessary, since data is from a std. normal distribution.</span></span>
<span id="cb12-60"><a href=""></a><span class="fu">library</span>(MASS)</span>
<span id="cb12-61"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb12-62"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">199</span>)</span>
<span id="cb12-63"><a href=""></a><span class="co"># Generate correlated data from multivariate normal distribution</span></span>
<span id="cb12-64"><a href=""></a><span class="co"># Modified from STA108 lecture</span></span>
<span id="cb12-65"><a href=""></a>means <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">501</span>)</span>
<span id="cb12-66"><a href=""></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">501</span>, <span class="at">ncol =</span> <span class="dv">501</span>)</span>
<span id="cb12-67"><a href=""></a>correlation <span class="ot">&lt;-</span> <span class="fl">0.7</span> <span class="co"># assume correlation is 0.7</span></span>
<span id="cb12-68"><a href=""></a><span class="fu">diag</span>(Sigma) <span class="ot">&lt;-</span> <span class="fl">1.0</span> <span class="co"># set diagonals of Sigma to 1.</span></span>
<span id="cb12-69"><a href=""></a></span>
<span id="cb12-70"><a href=""></a><span class="co"># set everything else to 0.7</span></span>
<span id="cb12-71"><a href=""></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Sigma)) {</span>
<span id="cb12-72"><a href=""></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(Sigma)) {</span>
<span id="cb12-73"><a href=""></a>    <span class="cf">if</span> (i <span class="sc">!=</span> j) {</span>
<span id="cb12-74"><a href=""></a>      Sigma[i,j] <span class="ot">=</span> <span class="fl">0.7</span></span>
<span id="cb12-75"><a href=""></a>    }</span>
<span id="cb12-76"><a href=""></a>  }</span>
<span id="cb12-77"><a href=""></a>}</span>
<span id="cb12-78"><a href=""></a></span>
<span id="cb12-79"><a href=""></a>data_multi <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">1000</span>,means,Sigma)</span>
<span id="cb12-80"><a href=""></a><span class="co"># First col of data_multi is y, the remaining are xs.</span></span>
<span id="cb12-81"><a href=""></a></span>
<span id="cb12-82"><a href=""></a><span class="co"># Step 2: Try lambdas</span></span>
<span id="cb12-83"><a href=""></a>lambdas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.00005</span>, <span class="fl">0.0005</span>, <span class="fl">0.005</span>, <span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>)</span>
<span id="cb12-84"><a href=""></a></span>
<span id="cb12-85"><a href=""></a><span class="co"># Step 3: Perform LOOCV</span></span>
<span id="cb12-86"><a href=""></a>results <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(<span class="at">Lambda =</span> <span class="fu">numeric</span>(), <span class="at">CV_ridge =</span> <span class="fu">numeric</span>(), <span class="at">CV_lasso=</span><span class="fu">numeric</span>())</span>
<span id="cb12-87"><a href=""></a><span class="cf">for</span> (curr_lambda <span class="cf">in</span> lambdas) {</span>
<span id="cb12-88"><a href=""></a>  <span class="co"># cross_validation_total &lt;- c()</span></span>
<span id="cb12-89"><a href=""></a>  <span class="co"># cross_validation_total &lt;- c(cross_validation_total, </span></span>
<span id="cb12-90"><a href=""></a>  <span class="co">#                             clusterApply(cl = clusterOfThreads,</span></span>
<span id="cb12-91"><a href=""></a>  <span class="co">#                                          x = data_multi,</span></span>
<span id="cb12-92"><a href=""></a>  <span class="co">#                                          fun = cv_ridge_parallel)</span></span>
<span id="cb12-93"><a href=""></a>  <span class="co">#                           )</span></span>
<span id="cb12-94"><a href=""></a>  cv_total_for_lambda_ridge <span class="ot">&lt;-</span> <span class="fu">cv_ridge_parallel</span>(data_multi, curr_lambda)</span>
<span id="cb12-95"><a href=""></a>  cv_total_for_lambda_lasso <span class="ot">&lt;-</span> <span class="fu">cv_lasso_parallel</span>(data_multi, curr_lambda)</span>
<span id="cb12-96"><a href=""></a>  </span>
<span id="cb12-97"><a href=""></a>  results <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> <span class="fu">add_row</span>(<span class="at">Lambda =</span> curr_lambda, <span class="at">CV_ridge =</span> <span class="fu">sum</span>(<span class="fu">unlist</span>(cv_total_for_lambda_ridge)) <span class="sc">/</span> <span class="fu">nrow</span>(data_multi), <span class="at">CV_lasso =</span> <span class="fu">sum</span>(<span class="fu">unlist</span>(cv_total_for_lambda_lasso)) <span class="sc">/</span> <span class="fu">nrow</span>(data_multi))</span>
<span id="cb12-98"><a href=""></a>}</span>
<span id="cb12-99"><a href=""></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="fu">kable</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">Lambda</th>
<th style="text-align: right;">CV_ridge</th>
<th style="text-align: right;">CV_lasso</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">0.6123522</td>
<td style="text-align: right;">0.6123522</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0e-05</td>
<td style="text-align: right;">0.6118840</td>
<td style="text-align: right;">0.5989734</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0e-04</td>
<td style="text-align: right;">0.6085927</td>
<td style="text-align: right;">0.5277561</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0e-03</td>
<td style="text-align: right;">0.5759910</td>
<td style="text-align: right;">0.3309063</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0e-02</td>
<td style="text-align: right;">0.4371866</td>
<td style="text-align: right;">0.2932232</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0e-01</td>
<td style="text-align: right;">0.3074646</td>
<td style="text-align: right;">0.6250166</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0e+00</td>
<td style="text-align: right;">0.2946648</td>
<td style="text-align: right;">0.9373989</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0e+00</td>
<td style="text-align: right;">0.2865630</td>
<td style="text-align: right;">0.9373989</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0e+01</td>
<td style="text-align: right;">0.2861012</td>
<td style="text-align: right;">0.9373989</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5e+01</td>
<td style="text-align: right;">0.2861575</td>
<td style="text-align: right;">0.9373989</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a><span class="fu">ggplot</span>(<span class="at">data =</span> results, <span class="fu">aes</span>(<span class="at">x =</span> lambdas, <span class="at">y =</span> CV_ridge)) <span class="sc">+</span></span>
<span id="cb14-2"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(CV_ridge,<span class="dv">4</span>), <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Lambda"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"CV vs Lambda (Ridge)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RidgeAndLassoPresentation_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a><span class="fu">ggplot</span>(<span class="at">data =</span> results, <span class="fu">aes</span>(<span class="at">x =</span> lambdas, <span class="at">y =</span> CV_lasso)) <span class="sc">+</span></span>
<span id="cb15-2"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(CV_lasso,<span class="dv">4</span>), <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Lambda"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"CV vs Lambda (Lasso)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RidgeAndLassoPresentation_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a>x <span class="ot">&lt;-</span> data_multi[,<span class="dv">2</span><span class="sc">:</span><span class="dv">501</span>]</span>
<span id="cb16-2"><a href=""></a>y <span class="ot">&lt;-</span> data_multi[,<span class="dv">1</span>]</span>
<span id="cb16-3"><a href=""></a>final_model_ridge <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> <span class="dv">10</span>, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb16-4"><a href=""></a>final_model_ridge<span class="sc">$</span>dev.ratio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7039119</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a>final_model_lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> <span class="fl">0.05</span>, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb18-2"><a href=""></a>final_model_lasso<span class="sc">$</span>dev.ratio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7233161</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a>data_multi_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data_multi)</span>
<span id="cb20-2"><a href=""></a>final_model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(V1 <span class="sc">~</span> . , <span class="at">data =</span> data_multi_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="fu">summary</span>(final_model_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = V1 ~ ., data = data_multi_df)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.13106 -0.25326 -0.01388  0.26819  1.19307 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) -5.845e-02  2.469e-02  -2.367  0.01831 * 
V2           1.763e-02  4.420e-02   0.399  0.69012   
V3          -1.878e-02  4.619e-02  -0.407  0.68442   
V4          -6.814e-02  4.658e-02  -1.463  0.14414   
V5           2.521e-02  4.418e-02   0.571  0.56850   
V6          -5.030e-02  4.406e-02  -1.142  0.25420   
V7           3.349e-02  4.672e-02   0.717  0.47387   
V8           1.305e-02  4.242e-02   0.308  0.75847   
V9          -4.181e-02  4.377e-02  -0.955  0.33991   
V10         -6.918e-02  4.377e-02  -1.581  0.11461   
V11          7.231e-02  4.487e-02   1.612  0.10765   
V12          2.178e-02  4.313e-02   0.505  0.61379   
V13          1.292e-02  4.310e-02   0.300  0.76453   
V14         -6.165e-02  4.354e-02  -1.416  0.15745   
V15          4.610e-02  4.306e-02   1.071  0.28489   
V16         -2.371e-02  4.495e-02  -0.528  0.59803   
V17         -1.951e-02  4.591e-02  -0.425  0.67107   
V18          1.086e-01  4.213e-02   2.577  0.01025 * 
V19         -6.071e-03  4.418e-02  -0.137  0.89074   
V20         -1.929e-02  4.492e-02  -0.429  0.66780   
V21         -8.109e-03  4.401e-02  -0.184  0.85389   
V22         -2.899e-02  4.548e-02  -0.637  0.52413   
V23          3.922e-02  4.459e-02   0.880  0.37949   
V24          3.412e-02  4.525e-02   0.754  0.45116   
V25         -1.278e-02  4.521e-02  -0.283  0.77758   
V26         -7.887e-03  4.651e-02  -0.170  0.86541   
V27          5.252e-02  4.590e-02   1.144  0.25304   
V28         -2.597e-02  4.529e-02  -0.574  0.56652   
V29          4.099e-03  4.389e-02   0.093  0.92563   
V30         -1.947e-03  4.437e-02  -0.044  0.96502   
V31          4.520e-02  4.579e-02   0.987  0.32402   
V32         -6.344e-03  4.352e-02  -0.146  0.88417   
V33         -7.401e-02  4.503e-02  -1.644  0.10088   
V34         -1.604e-02  4.331e-02  -0.370  0.71132   
V35          3.286e-02  4.421e-02   0.743  0.45774   
V36         -2.059e-02  4.509e-02  -0.457  0.64818   
V37          4.837e-02  4.438e-02   1.090  0.27625   
V38          1.039e-02  4.218e-02   0.246  0.80550   
V39         -1.998e-02  4.239e-02  -0.471  0.63758   
V40          3.311e-02  4.254e-02   0.778  0.43667   
V41         -3.517e-02  4.621e-02  -0.761  0.44699   
V42          1.581e-02  4.555e-02   0.347  0.72877   
V43          4.582e-02  4.842e-02   0.946  0.34445   
V44          2.042e-02  4.493e-02   0.454  0.64974   
V45         -3.335e-02  4.753e-02  -0.702  0.48326   
V46          1.187e-02  4.461e-02   0.266  0.79027   
V47          5.456e-02  4.489e-02   1.215  0.22480   
V48         -1.469e-02  4.614e-02  -0.318  0.75035   
V49          2.152e-02  4.380e-02   0.491  0.62332   
V50          3.797e-02  4.444e-02   0.855  0.39320   
V51         -2.743e-03  4.544e-02  -0.060  0.95188   
V52         -5.995e-02  4.534e-02  -1.322  0.18668   
V53          2.814e-02  4.453e-02   0.632  0.52771   
V54         -1.973e-02  4.555e-02  -0.433  0.66519   
V55         -1.417e-02  4.525e-02  -0.313  0.75437   
V56          2.419e-02  4.786e-02   0.505  0.61346   
V57         -1.093e-01  4.563e-02  -2.395  0.01700 * 
V58         -5.397e-02  4.328e-02  -1.247  0.21295   
V59          4.381e-02  4.477e-02   0.979  0.32824   
V60          5.386e-02  4.574e-02   1.177  0.23956   
V61          8.718e-02  4.360e-02   2.000  0.04609 * 
V62          6.373e-02  4.638e-02   1.374  0.17003   
V63          1.637e-02  4.105e-02   0.399  0.69024   
V64          3.166e-02  4.480e-02   0.707  0.48009   
V65          3.210e-03  4.542e-02   0.071  0.94368   
V66         -8.758e-03  4.237e-02  -0.207  0.83631   
V67          1.023e-02  4.449e-02   0.230  0.81828   
V68         -1.491e-02  4.216e-02  -0.354  0.72372   
V69          4.637e-02  4.682e-02   0.990  0.32245   
V70          1.809e-02  4.670e-02   0.387  0.69871   
V71         -7.044e-02  4.574e-02  -1.540  0.12418   
V72         -3.600e-02  4.439e-02  -0.811  0.41767   
V73         -8.804e-04  4.354e-02  -0.020  0.98388   
V74         -2.274e-02  4.454e-02  -0.511  0.60988   
V75          3.760e-02  4.520e-02   0.832  0.40588   
V76          1.241e-02  4.241e-02   0.293  0.76988   
V77          3.493e-02  4.710e-02   0.742  0.45869   
V78         -6.714e-03  4.532e-02  -0.148  0.88229   
V79         -5.797e-03  4.344e-02  -0.133  0.89388   
V80         -1.826e-02  4.405e-02  -0.415  0.67867   
V81         -1.137e-01  4.397e-02  -2.586  0.00998 **
V82          1.478e-01  4.488e-02   3.294  0.00106 **
V83         -7.101e-02  4.762e-02  -1.491  0.13655   
V84          5.629e-02  4.260e-02   1.321  0.18701   
V85         -5.620e-02  4.515e-02  -1.245  0.21385   
V86          2.885e-02  4.185e-02   0.689  0.49085   
V87          2.452e-02  4.475e-02   0.548  0.58401   
V88          7.626e-02  4.465e-02   1.708  0.08824 . 
V89          2.040e-02  4.513e-02   0.452  0.65148   
V90          1.399e-02  4.467e-02   0.313  0.75432   
V91          2.778e-03  4.274e-02   0.065  0.94820   
V92         -2.491e-02  4.565e-02  -0.546  0.58558   
V93         -2.285e-03  4.315e-02  -0.053  0.95779   
V94          3.440e-02  4.499e-02   0.765  0.44486   
V95         -5.283e-02  4.451e-02  -1.187  0.23582   
V96         -8.717e-02  4.499e-02  -1.938  0.05321 . 
V97          3.942e-02  4.723e-02   0.835  0.40433   
V98          4.177e-02  4.300e-02   0.971  0.33187   
V99          9.548e-02  4.364e-02   2.188  0.02913 * 
V100        -9.564e-02  4.575e-02  -2.090  0.03709 * 
V101         7.228e-03  4.495e-02   0.161  0.87231   
V102         4.710e-02  4.391e-02   1.073  0.28397   
V103        -5.143e-02  4.188e-02  -1.228  0.21992   
V104         1.752e-02  4.419e-02   0.396  0.69194   
V105         5.385e-02  4.491e-02   1.199  0.23103   
V106        -1.678e-03  4.366e-02  -0.038  0.96935   
V107        -1.761e-02  4.421e-02  -0.398  0.69061   
V108        -7.112e-03  4.470e-02  -0.159  0.87364   
V109        -4.478e-02  4.690e-02  -0.955  0.34017   
V110        -3.516e-02  4.236e-02  -0.830  0.40691   
V111         2.844e-02  4.454e-02   0.638  0.52347   
V112        -1.322e-02  4.416e-02  -0.300  0.76468   
V113         9.201e-03  4.569e-02   0.201  0.84048   
V114         1.148e-02  4.398e-02   0.261  0.79419   
V115         1.504e-03  4.457e-02   0.034  0.97310   
V116         5.672e-03  4.550e-02   0.125  0.90086   
V117         2.229e-02  4.479e-02   0.498  0.61895   
V118        -4.988e-02  4.478e-02  -1.114  0.26582   
V119        -5.623e-02  4.208e-02  -1.336  0.18205   
V120        -9.126e-02  4.385e-02  -2.081  0.03793 * 
V121        -2.382e-02  4.345e-02  -0.548  0.58371   
V122         7.034e-02  4.538e-02   1.550  0.12176   
V123        -1.596e-02  4.697e-02  -0.340  0.73407   
V124         1.223e-02  4.554e-02   0.269  0.78835   
V125        -2.707e-03  4.432e-02  -0.061  0.95133   
V126        -3.512e-02  4.379e-02  -0.802  0.42299   
V127        -8.195e-03  4.342e-02  -0.189  0.85038   
V128         1.331e-02  4.542e-02   0.293  0.76961   
V129         3.112e-02  4.396e-02   0.708  0.47937   
V130         2.361e-02  4.571e-02   0.517  0.60570   
V131         3.935e-03  4.509e-02   0.087  0.93050   
V132        -1.299e-02  4.614e-02  -0.282  0.77833   
V133         1.628e-03  4.042e-02   0.040  0.96790   
V134        -6.777e-02  4.494e-02  -1.508  0.13217   
V135         1.832e-02  4.181e-02   0.438  0.66146   
V136         3.748e-05  4.215e-02   0.001  0.99929   
V137         3.266e-02  4.679e-02   0.698  0.48541   
V138        -7.015e-03  4.613e-02  -0.152  0.87919   
V139        -7.841e-02  4.391e-02  -1.785  0.07479 . 
V140         6.665e-02  4.501e-02   1.481  0.13923   
V141         5.066e-03  4.608e-02   0.110  0.91251   
V142         4.308e-02  4.535e-02   0.950  0.34270   
V143        -8.525e-02  4.556e-02  -1.871  0.06191 . 
V144        -2.190e-02  4.692e-02  -0.467  0.64095   
V145        -6.161e-02  4.501e-02  -1.369  0.17167   
V146         2.213e-03  4.472e-02   0.049  0.96055   
V147         6.533e-02  4.624e-02   1.413  0.15834   
V148        -6.813e-02  4.261e-02  -1.599  0.11041   
V149         6.154e-02  4.707e-02   1.307  0.19165   
V150         7.219e-02  4.502e-02   1.604  0.10945   
V151         1.081e-01  4.503e-02   2.400  0.01674 * 
V152        -2.868e-02  4.549e-02  -0.630  0.52868   
V153        -2.585e-02  4.459e-02  -0.580  0.56238   
V154         8.217e-02  4.256e-02   1.931  0.05408 . 
V155         2.843e-03  4.429e-02   0.064  0.94886   
V156         2.929e-02  4.452e-02   0.658  0.51086   
V157        -1.086e-02  4.673e-02  -0.232  0.81637   
V158        -4.883e-02  4.186e-02  -1.166  0.24400   
V159         3.418e-02  4.593e-02   0.744  0.45702   
V160         7.547e-02  4.144e-02   1.821  0.06920 . 
V161        -1.403e-03  4.397e-02  -0.032  0.97456   
V162        -4.835e-02  4.447e-02  -1.087  0.27745   
V163        -3.650e-03  4.548e-02  -0.080  0.93606   
V164         5.070e-02  4.548e-02   1.115  0.26548   
V165        -6.910e-02  4.447e-02  -1.554  0.12090   
V166         1.110e-01  4.475e-02   2.480  0.01347 * 
V167        -4.037e-02  4.484e-02  -0.900  0.36843   
V168        -2.982e-02  4.371e-02  -0.682  0.49546   
V169        -1.630e-02  4.566e-02  -0.357  0.72120   
V170        -2.202e-02  4.649e-02  -0.474  0.63592   
V171         5.326e-03  4.466e-02   0.119  0.90512   
V172        -2.510e-02  4.400e-02  -0.570  0.56867   
V173         7.693e-02  4.502e-02   1.709  0.08809 . 
V174        -3.647e-02  4.623e-02  -0.789  0.43054   
V175         4.918e-02  4.382e-02   1.122  0.26224   
V176         1.527e-03  4.525e-02   0.034  0.97309   
V177         5.105e-02  4.343e-02   1.175  0.24045   
V178        -1.805e-02  4.683e-02  -0.385  0.70011   
V179         5.617e-03  4.433e-02   0.127  0.89921   
V180        -3.256e-02  4.519e-02  -0.721  0.47151   
V181         4.140e-02  4.527e-02   0.915  0.36079   
V182         4.889e-02  4.419e-02   1.106  0.26913   
V183        -6.985e-04  4.389e-02  -0.016  0.98731   
V184        -1.883e-03  4.585e-02  -0.041  0.96726   
V185         3.204e-02  4.318e-02   0.742  0.45837   
V186         2.646e-02  4.486e-02   0.590  0.55557   
V187         1.494e-03  4.590e-02   0.033  0.97405   
V188         1.295e-02  4.380e-02   0.296  0.76755   
V189        -3.536e-02  4.258e-02  -0.830  0.40672   
V190         9.036e-03  4.447e-02   0.203  0.83906   
V191        -3.689e-02  4.493e-02  -0.821  0.41202   
V192         2.922e-02  4.643e-02   0.629  0.52943   
V193         1.760e-02  4.554e-02   0.387  0.69924   
V194        -1.126e-02  4.646e-02  -0.242  0.80862   
V195        -5.270e-02  4.218e-02  -1.250  0.21206   
V196         5.478e-02  4.441e-02   1.233  0.21800   
V197        -1.440e-02  4.475e-02  -0.322  0.74783   
V198        -1.926e-02  4.387e-02  -0.439  0.66082   
V199        -4.973e-03  4.515e-02  -0.110  0.91233   
V200        -3.988e-02  4.473e-02  -0.891  0.37310   
V201        -6.918e-02  4.448e-02  -1.555  0.12053   
V202        -5.849e-02  4.589e-02  -1.274  0.20310   
V203         4.482e-03  4.426e-02   0.101  0.91938   
V204        -2.263e-02  4.468e-02  -0.507  0.61270   
V205         2.530e-02  4.586e-02   0.552  0.58139   
V206        -2.759e-02  4.260e-02  -0.648  0.51758   
V207         5.907e-02  4.771e-02   1.238  0.21625   
V208        -2.348e-02  4.588e-02  -0.512  0.60907   
V209         1.930e-02  4.391e-02   0.439  0.66050   
V210        -1.801e-02  4.211e-02  -0.428  0.66916   
V211        -1.049e-02  4.433e-02  -0.237  0.81311   
V212         5.220e-03  4.520e-02   0.115  0.90810   
V213         1.157e-02  4.390e-02   0.264  0.79222   
V214        -3.659e-02  4.658e-02  -0.786  0.43246   
V215        -5.664e-03  4.415e-02  -0.128  0.89796   
V216         2.917e-02  4.329e-02   0.674  0.50079   
V217        -8.290e-03  4.469e-02  -0.185  0.85291   
V218        -5.135e-03  4.467e-02  -0.115  0.90852   
V219         2.257e-02  4.570e-02   0.494  0.62165   
V220         6.549e-02  4.602e-02   1.423  0.15539   
V221        -3.082e-03  4.378e-02  -0.070  0.94390   
V222         1.429e-02  4.459e-02   0.320  0.74874   
V223         3.370e-02  4.560e-02   0.739  0.46025   
V224        -2.056e-02  4.466e-02  -0.460  0.64538   
V225        -3.353e-02  4.692e-02  -0.715  0.47522   
V226        -6.308e-03  4.287e-02  -0.147  0.88309   
V227        -6.802e-03  4.266e-02  -0.159  0.87340   
V228        -2.930e-02  4.570e-02  -0.641  0.52165   
V229         1.086e-03  4.506e-02   0.024  0.98078   
V230        -2.524e-02  4.481e-02  -0.563  0.57350   
V231        -3.085e-02  4.400e-02  -0.701  0.48361   
V232        -1.774e-02  4.381e-02  -0.405  0.68566   
V233         4.182e-02  4.347e-02   0.962  0.33641   
V234        -5.814e-02  4.323e-02  -1.345  0.17923   
V235         1.322e-02  4.523e-02   0.292  0.77014   
V236        -1.120e-03  4.444e-02  -0.025  0.97990   
V237        -7.222e-03  4.563e-02  -0.158  0.87432   
V238         6.310e-02  4.302e-02   1.467  0.14313   
V239         6.131e-03  4.276e-02   0.143  0.88605   
V240        -3.726e-03  4.307e-02  -0.087  0.93110   
V241         3.460e-02  4.616e-02   0.750  0.45387   
V242         3.650e-02  4.508e-02   0.810  0.41857   
V243        -2.753e-02  4.491e-02  -0.613  0.54010   
V244        -4.512e-02  4.315e-02  -1.046  0.29622   
V245         5.153e-02  4.577e-02   1.126  0.26078   
V246        -3.733e-03  4.365e-02  -0.086  0.93189   
V247         2.106e-03  4.512e-02   0.047  0.96278   
V248         1.835e-02  4.095e-02   0.448  0.65433   
V249        -9.823e-02  4.388e-02  -2.239  0.02561 * 
V250        -3.956e-03  4.579e-02  -0.086  0.93118   
V251         1.304e-02  4.619e-02   0.282  0.77780   
V252         1.057e-02  4.453e-02   0.237  0.81242   
V253         8.060e-04  4.336e-02   0.019  0.98518   
V254         2.543e-02  4.561e-02   0.557  0.57744   
V255         3.615e-02  4.301e-02   0.840  0.40104   
V256         5.511e-02  4.473e-02   1.232  0.21845   
V257         2.524e-02  4.322e-02   0.584  0.55956   
V258        -9.810e-03  4.551e-02  -0.216  0.82942   
V259        -1.083e-02  4.377e-02  -0.247  0.80467   
V260         2.126e-02  4.312e-02   0.493  0.62219   
V261         1.910e-02  4.420e-02   0.432  0.66580   
V262         1.386e-02  4.356e-02   0.318  0.75044   
V263        -2.466e-02  4.574e-02  -0.539  0.59008   
V264         4.592e-02  4.809e-02   0.955  0.34012   
V265         3.062e-02  4.377e-02   0.700  0.48455   
V266        -6.636e-03  4.464e-02  -0.149  0.88188   
V267         4.975e-02  4.282e-02   1.162  0.24584   
V268        -1.805e-02  4.696e-02  -0.384  0.70092   
V269         7.147e-02  4.545e-02   1.573  0.11644   
V270        -1.880e-02  4.281e-02  -0.439  0.66076   
V271         3.104e-02  4.557e-02   0.681  0.49616   
V272         2.917e-02  4.198e-02   0.695  0.48752   
V273         1.238e-01  4.503e-02   2.750  0.00618 **
V274        -2.525e-02  4.608e-02  -0.548  0.58396   
V275        -5.451e-02  4.508e-02  -1.209  0.22714   
V276        -1.228e-02  4.697e-02  -0.261  0.79392   
V277        -3.431e-02  4.525e-02  -0.758  0.44875   
V278         1.281e-02  4.216e-02   0.304  0.76137   
V279        -3.445e-02  4.241e-02  -0.812  0.41705   
V280        -1.174e-04  4.412e-02  -0.003  0.99788   
V281         1.203e-02  4.426e-02   0.272  0.78589   
V282         2.328e-02  4.576e-02   0.509  0.61113   
V283         5.024e-02  4.165e-02   1.206  0.22830   
V284         1.140e-02  4.233e-02   0.269  0.78789   
V285         5.864e-02  4.641e-02   1.264  0.20700   
V286        -5.198e-02  4.367e-02  -1.190  0.23451   
V287        -6.935e-02  4.083e-02  -1.698  0.09004 . 
V288         3.662e-02  4.356e-02   0.841  0.40090   
V289         7.270e-02  4.315e-02   1.685  0.09263 . 
V290        -3.883e-02  4.531e-02  -0.857  0.39189   
V291         2.600e-02  4.762e-02   0.546  0.58527   
V292        -3.547e-03  4.490e-02  -0.079  0.93707   
V293         5.870e-03  4.365e-02   0.134  0.89307   
V294        -1.034e-01  4.273e-02  -2.421  0.01585 * 
V295        -4.496e-02  4.622e-02  -0.973  0.33125   
V296         8.893e-03  4.281e-02   0.208  0.83551   
V297        -3.375e-02  4.459e-02  -0.757  0.44945   
V298         8.428e-03  4.416e-02   0.191  0.84873   
V299        -7.023e-02  4.443e-02  -1.581  0.11459   
V300         2.174e-02  4.551e-02   0.478  0.63308   
V301        -6.320e-02  4.428e-02  -1.427  0.15415   
V302         4.990e-02  4.327e-02   1.153  0.24936   
V303         3.810e-02  4.533e-02   0.841  0.40102   
V304         4.664e-02  4.392e-02   1.062  0.28880   
V305        -9.845e-03  4.271e-02  -0.231  0.81780   
V306         3.537e-02  4.598e-02   0.769  0.44205   
V307        -4.283e-03  4.642e-02  -0.092  0.92653   
V308         7.666e-02  4.601e-02   1.666  0.09632 . 
V309         7.806e-02  4.513e-02   1.730  0.08431 . 
V310        -6.188e-03  4.576e-02  -0.135  0.89250   
V311         1.946e-02  4.458e-02   0.437  0.66260   
V312         6.568e-02  4.349e-02   1.510  0.13168   
V313         3.068e-02  4.423e-02   0.694  0.48827   
V314        -1.729e-02  4.637e-02  -0.373  0.70943   
V315        -3.451e-02  4.370e-02  -0.790  0.43005   
V316         4.756e-02  4.480e-02   1.062  0.28897   
V317        -8.745e-03  4.583e-02  -0.191  0.84876   
V318         5.792e-02  4.157e-02   1.393  0.16415   
V319         3.969e-02  4.592e-02   0.864  0.38785   
V320         6.234e-02  4.637e-02   1.344  0.17944   
V321        -6.843e-02  4.489e-02  -1.525  0.12800   
V322         3.904e-02  4.561e-02   0.856  0.39245   
V323         6.578e-02  4.486e-02   1.466  0.14315   
V324        -2.195e-02  4.544e-02  -0.483  0.62934   
V325         6.356e-02  4.482e-02   1.418  0.15685   
V326         3.300e-02  4.328e-02   0.763  0.44611   
V327         1.029e-01  4.533e-02   2.269  0.02367 * 
V328        -4.843e-02  4.571e-02  -1.060  0.28981   
V329        -7.638e-03  4.440e-02  -0.172  0.86349   
V330        -9.164e-02  4.581e-02  -2.000  0.04600 * 
V331         5.530e-02  4.373e-02   1.265  0.20657   
V332        -3.613e-03  4.328e-02  -0.083  0.93349   
V333         3.809e-02  4.418e-02   0.862  0.38904   
V334        -2.335e-02  4.418e-02  -0.528  0.59742   
V335        -1.121e-02  4.441e-02  -0.252  0.80078   
V336        -3.591e-02  4.635e-02  -0.775  0.43887   
V337         6.007e-02  4.503e-02   1.334  0.18281   
V338         3.051e-03  4.430e-02   0.069  0.94512   
V339        -8.297e-04  4.489e-02  -0.018  0.98526   
V340        -8.608e-03  4.505e-02  -0.191  0.84853   
V341         1.732e-02  4.376e-02   0.396  0.69243   
V342        -2.587e-02  4.422e-02  -0.585  0.55883   
V343         4.365e-02  4.677e-02   0.933  0.35117   
V344        -3.002e-02  4.500e-02  -0.667  0.50506   
V345         7.789e-02  4.167e-02   1.869  0.06219 . 
V346        -4.765e-02  4.273e-02  -1.115  0.26537   
V347         4.258e-02  4.334e-02   0.982  0.32638   
V348        -5.998e-03  4.862e-02  -0.123  0.90186   
V349        -2.029e-02  4.459e-02  -0.455  0.64924   
V350         8.612e-02  4.386e-02   1.964  0.05011 . 
V351         1.428e-02  4.360e-02   0.328  0.74338   
V352        -1.993e-02  4.538e-02  -0.439  0.66068   
V353        -1.570e-02  4.614e-02  -0.340  0.73374   
V354         8.668e-03  4.191e-02   0.207  0.83624   
V355         3.922e-02  4.476e-02   0.876  0.38139   
V356        -7.107e-03  4.583e-02  -0.155  0.87684   
V357        -7.660e-02  4.317e-02  -1.774  0.07662 . 
V358         1.799e-02  4.328e-02   0.416  0.67781   
V359         5.558e-03  4.399e-02   0.126  0.89950   
V360        -1.573e-02  4.330e-02  -0.363  0.71655   
V361        -5.837e-02  4.540e-02  -1.286  0.19914   
V362         9.438e-03  4.770e-02   0.198  0.84322   
V363        -5.327e-02  4.278e-02  -1.245  0.21356   
V364        -3.105e-02  4.547e-02  -0.683  0.49506   
V365        -5.163e-03  4.490e-02  -0.115  0.90850   
V366         9.656e-03  4.528e-02   0.213  0.83124   
V367        -1.969e-02  4.456e-02  -0.442  0.65874   
V368         8.460e-03  4.511e-02   0.188  0.85132   
V369        -4.197e-02  4.482e-02  -0.936  0.34952   
V370        -2.190e-03  4.315e-02  -0.051  0.95954   
V371        -1.995e-03  4.523e-02  -0.044  0.96483   
V372        -1.432e-02  4.452e-02  -0.322  0.74788   
V373         2.024e-02  4.346e-02   0.466  0.64171   
V374        -9.126e-03  4.436e-02  -0.206  0.83711   
V375         7.155e-02  4.452e-02   1.607  0.10866   
V376        -2.597e-02  4.373e-02  -0.594  0.55284   
V377        -5.111e-02  4.628e-02  -1.104  0.27005   
V378        -1.157e-02  4.450e-02  -0.260  0.79497   
V379         3.796e-04  4.453e-02   0.009  0.99320   
V380        -2.455e-02  4.361e-02  -0.563  0.57379   
V381        -6.933e-02  4.130e-02  -1.679  0.09387 . 
V382        -1.249e-02  4.478e-02  -0.279  0.78046   
V383         9.231e-02  4.386e-02   2.105  0.03583 * 
V384        -6.921e-02  4.454e-02  -1.554  0.12084   
V385        -1.762e-03  4.524e-02  -0.039  0.96895   
V386         6.652e-02  4.335e-02   1.534  0.12560   
V387         2.044e-02  4.508e-02   0.453  0.65039   
V388        -1.309e-02  4.383e-02  -0.299  0.76538   
V389        -1.828e-02  4.379e-02  -0.417  0.67656   
V390        -5.409e-02  4.586e-02  -1.180  0.23875   
V391         1.314e-02  4.344e-02   0.302  0.76242   
V392        -1.379e-02  4.280e-02  -0.322  0.74745   
V393        -2.314e-02  4.462e-02  -0.519  0.60432   
V394        -3.596e-02  4.503e-02  -0.798  0.42500   
V395         7.195e-02  4.586e-02   1.569  0.11729   
V396         4.335e-02  4.387e-02   0.988  0.32353   
V397        -4.484e-02  4.668e-02  -0.961  0.33724   
V398        -7.529e-02  4.469e-02  -1.685  0.09267 . 
V399        -6.868e-02  4.561e-02  -1.506  0.13278   
V400         9.159e-02  4.594e-02   1.994  0.04672 * 
V401        -3.110e-02  4.314e-02  -0.721  0.47141   
V402         3.088e-02  4.695e-02   0.658  0.51099   
V403         3.158e-02  4.266e-02   0.740  0.45948   
V404         5.387e-02  4.605e-02   1.170  0.24269   
V405         1.493e-02  4.442e-02   0.336  0.73698   
V406        -1.514e-02  4.402e-02  -0.344  0.73106   
V407        -3.892e-02  4.728e-02  -0.823  0.41081   
V408        -2.140e-02  4.574e-02  -0.468  0.64001   
V409        -7.865e-02  4.439e-02  -1.772  0.07707 . 
V410         2.478e-03  4.434e-02   0.056  0.95546   
V411        -2.905e-02  4.465e-02  -0.651  0.51566   
V412         1.987e-02  4.515e-02   0.440  0.66002   
V413         4.820e-02  4.392e-02   1.097  0.27300   
V414         5.953e-02  4.341e-02   1.371  0.17093   
V415         2.820e-02  4.300e-02   0.656  0.51231   
V416         2.135e-02  4.553e-02   0.469  0.63927   
V417        -4.748e-02  4.365e-02  -1.088  0.27732   
V418        -4.844e-02  4.482e-02  -1.081  0.28033   
V419         1.541e-02  4.609e-02   0.334  0.73825   
V420         1.056e-02  4.149e-02   0.254  0.79922   
V421         2.190e-02  4.294e-02   0.510  0.61018   
V422         5.081e-03  4.351e-02   0.117  0.90709   
V423        -1.219e-02  4.396e-02  -0.277  0.78168   
V424         4.621e-02  4.624e-02   0.999  0.31804   
V425         6.070e-03  4.550e-02   0.133  0.89393   
V426        -3.263e-02  4.370e-02  -0.747  0.45556   
V427        -1.612e-02  4.552e-02  -0.354  0.72336   
V428        -5.822e-02  4.427e-02  -1.315  0.18906   
V429         2.387e-02  4.341e-02   0.550  0.58269   
V430         1.576e-02  4.253e-02   0.371  0.71103   
V431        -2.133e-02  4.451e-02  -0.479  0.63191   
V432         1.046e-01  4.479e-02   2.335  0.01993 * 
V433        -2.607e-02  4.500e-02  -0.579  0.56252   
V434         4.393e-02  4.337e-02   1.013  0.31150   
V435        -2.880e-02  4.788e-02  -0.601  0.54787   
V436        -1.533e-03  4.432e-02  -0.035  0.97242   
V437         3.238e-02  4.484e-02   0.722  0.47058   
V438        -2.812e-02  4.566e-02  -0.616  0.53831   
V439         1.822e-02  4.454e-02   0.409  0.68277   
V440         2.901e-02  4.390e-02   0.661  0.50902   
V441         1.041e-01  4.551e-02   2.287  0.02263 * 
V442         6.534e-04  4.454e-02   0.015  0.98830   
V443         2.061e-03  4.391e-02   0.047  0.96258   
V444        -2.755e-02  4.677e-02  -0.589  0.55610   
V445        -4.058e-02  4.547e-02  -0.892  0.37257   
V446         3.831e-02  4.627e-02   0.828  0.40808   
V447        -6.460e-03  4.532e-02  -0.143  0.88672   
V448         8.388e-03  4.493e-02   0.187  0.85197   
V449        -3.443e-02  4.470e-02  -0.770  0.44151   
V450         3.216e-02  4.555e-02   0.706  0.48052   
V451        -1.850e-02  4.468e-02  -0.414  0.67905   
V452        -1.661e-02  4.412e-02  -0.376  0.70678   
V453         2.223e-04  4.558e-02   0.005  0.99611   
V454         5.238e-02  4.292e-02   1.220  0.22286   
V455        -2.452e-02  4.327e-02  -0.567  0.57117   
V456         2.385e-02  4.471e-02   0.533  0.59399   
V457        -6.243e-02  4.407e-02  -1.417  0.15725   
V458         7.679e-03  4.391e-02   0.175  0.86123   
V459        -1.368e-01  4.530e-02  -3.019  0.00267 **
V460        -4.334e-02  4.439e-02  -0.976  0.32939   
V461         1.190e-02  4.407e-02   0.270  0.78723   
V462         5.649e-02  4.342e-02   1.301  0.19391   
V463        -8.162e-03  4.297e-02  -0.190  0.84944   
V464        -7.248e-02  4.478e-02  -1.618  0.10620   
V465        -3.668e-02  4.254e-02  -0.862  0.38900   
V466        -1.411e-02  4.517e-02  -0.312  0.75479   
V467         2.045e-02  4.460e-02   0.458  0.64685   
V468        -2.043e-02  4.571e-02  -0.447  0.65511   
V469         1.187e-02  4.516e-02   0.263  0.79281   
V470         1.262e-02  4.456e-02   0.283  0.77718   
V471        -2.134e-02  4.332e-02  -0.493  0.62251   
V472        -3.872e-02  4.459e-02  -0.868  0.38565   
V473        -1.234e-02  4.582e-02  -0.269  0.78776   
V474        -3.560e-02  4.373e-02  -0.814  0.41596   
V475         3.922e-02  4.406e-02   0.890  0.37381   
V476         4.359e-03  4.306e-02   0.101  0.91941   
V477        -1.913e-02  4.225e-02  -0.453  0.65100   
V478         2.750e-02  4.466e-02   0.616  0.53836   
V479        -1.186e-02  4.501e-02  -0.264  0.79223   
V480        -1.168e-01  4.516e-02  -2.587  0.00996 **
V481         2.310e-02  4.540e-02   0.509  0.61109   
V482         1.605e-02  4.457e-02   0.360  0.71888   
V483         3.893e-02  4.621e-02   0.843  0.39991   
V484        -3.629e-02  4.577e-02  -0.793  0.42824   
V485         4.743e-02  4.599e-02   1.031  0.30289   
V486        -5.145e-02  4.653e-02  -1.106  0.26930   
V487         6.081e-02  4.576e-02   1.329  0.18456   
V488         8.879e-03  4.425e-02   0.201  0.84107   
V489         3.540e-02  4.309e-02   0.822  0.41173   
V490        -6.280e-02  4.360e-02  -1.440  0.15040   
V491        -4.015e-03  4.591e-02  -0.087  0.93036   
V492         2.340e-02  4.376e-02   0.535  0.59302   
V493         9.512e-02  4.389e-02   2.167  0.03068 * 
V494         2.390e-02  4.386e-02   0.545  0.58605   
V495         6.786e-02  4.520e-02   1.501  0.13390   
V496         3.637e-02  4.374e-02   0.832  0.40606   
V497        -3.654e-02  4.550e-02  -0.803  0.42227   
V498        -6.673e-03  4.424e-02  -0.151  0.88015   
V499         2.918e-02  4.427e-02   0.659  0.51007   
V500        -5.695e-02  4.345e-02  -1.311  0.19056   
V501        -7.911e-02  4.687e-02  -1.688  0.09207 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5438 on 499 degrees of freedom
Multiple R-squared:  0.8423,    Adjusted R-squared:  0.6842 
F-statistic: 5.329 on 500 and 499 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a><span class="fu">coef</span>(final_model_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)            V2            V3            V4            V5 
-5.845468e-02  1.763262e-02 -1.878345e-02 -6.814391e-02  2.520940e-02 
           V6            V7            V8            V9           V10 
-5.029908e-02  3.348900e-02  1.304978e-02 -4.180858e-02 -6.918445e-02 
          V11           V12           V13           V14           V15 
 7.231129e-02  2.178119e-02  1.291823e-02 -6.164871e-02  4.610203e-02 
          V16           V17           V18           V19           V20 
-2.371491e-02 -1.950799e-02  1.085754e-01 -6.071231e-03 -1.928894e-02 
          V21           V22           V23           V24           V25 
-8.108554e-03 -2.898878e-02  3.921999e-02  3.411909e-02 -1.277708e-02 
          V26           V27           V28           V29           V30 
-7.886559e-03  5.252234e-02 -2.597407e-02  4.098856e-03 -1.946499e-03 
          V31           V32           V33           V34           V35 
 4.519937e-02 -6.343558e-03 -7.400764e-02 -1.603619e-02  3.285738e-02 
          V36           V37           V38           V39           V40 
-2.058689e-02  4.837345e-02  1.039132e-02 -1.998361e-02  3.311248e-02 
          V41           V42           V43           V44           V45 
-3.516775e-02  1.580559e-02  4.581886e-02  2.041502e-02 -3.334979e-02 
          V46           V47           V48           V49           V50 
 1.187017e-02  5.456226e-02 -1.468760e-02  2.152387e-02  3.797361e-02 
          V51           V52           V53           V54           V55 
-2.743498e-03 -5.995062e-02  2.813936e-02 -1.972518e-02 -1.416689e-02 
          V56           V57           V58           V59           V60 
 2.419210e-02 -1.092668e-01 -5.397497e-02  4.380999e-02  5.386161e-02 
          V61           V62           V63           V64           V65 
 8.717613e-02  6.373354e-02  1.636953e-02  3.166328e-02  3.210397e-03 
          V66           V67           V68           V69           V70 
-8.758133e-03  1.022799e-02 -1.491244e-02  4.637000e-02  1.808784e-02 
          V71           V72           V73           V74           V75 
-7.044140e-02 -3.600354e-02 -8.803934e-04 -2.274171e-02  3.760107e-02 
          V76           V77           V78           V79           V80 
 1.241436e-02  3.492747e-02 -6.714005e-03 -5.797194e-03 -1.826097e-02 
          V81           V82           V83           V84           V85 
-1.137120e-01  1.478384e-01 -7.100780e-02  5.628836e-02 -5.620003e-02 
          V86           V87           V88           V89           V90 
 2.885077e-02  2.451802e-02  7.626363e-02  2.039567e-02  1.398618e-02 
          V91           V92           V93           V94           V95 
 2.778312e-03 -2.490698e-02 -2.284840e-03  3.439922e-02 -5.283007e-02 
          V96           V97           V98           V99          V100 
-8.717308e-02  3.941773e-02  4.176681e-02  9.548156e-02 -9.563729e-02 
         V101          V102          V103          V104          V105 
 7.228148e-03  4.709746e-02 -5.143385e-02  1.751993e-02  5.385382e-02 
         V106          V107          V108          V109          V110 
-1.678169e-03 -1.760562e-02 -7.112454e-03 -4.477668e-02 -3.516478e-02 
         V111          V112          V113          V114          V115 
 2.843852e-02 -1.322477e-02  9.201242e-03  1.148029e-02  1.503831e-03 
         V116          V117          V118          V119          V120 
 5.671559e-03  2.228864e-02 -4.988378e-02 -5.623054e-02 -9.126174e-02 
         V121          V122          V123          V124          V125 
-2.382341e-02  7.034010e-02 -1.596483e-02  1.223117e-02 -2.706669e-03 
         V126          V127          V128          V129          V130 
-3.511644e-02 -8.195268e-03  1.331001e-02  3.111671e-02  2.361022e-02 
         V131          V132          V133          V134          V135 
 3.934899e-03 -1.299401e-02  1.627606e-03 -6.776999e-02  1.831798e-02 
         V136          V137          V138          V139          V140 
 3.748125e-05  3.266452e-02 -7.015040e-03 -7.840503e-02  6.665421e-02 
         V141          V142          V143          V144          V145 
 5.066134e-03  4.307529e-02 -8.525308e-02 -2.189520e-02 -6.160632e-02 
         V146          V147          V148          V149          V150 
 2.212962e-03  6.533323e-02 -6.813409e-02  6.154420e-02  7.218606e-02 
         V151          V152          V153          V154          V155 
 1.080834e-01 -2.867793e-02 -2.584879e-02  8.216621e-02  2.842613e-03 
         V156          V157          V158          V159          V160 
 2.929455e-02 -1.085661e-02 -4.883086e-02  3.418420e-02  7.547067e-02 
         V161          V162          V163          V164          V165 
-1.403105e-03 -4.834892e-02 -3.650428e-03  5.070039e-02 -6.909888e-02 
         V166          V167          V168          V169          V170 
 1.109688e-01 -4.036610e-02 -2.981881e-02 -1.630172e-02 -2.202447e-02 
         V171          V172          V173          V174          V175 
 5.326237e-03 -2.509983e-02  7.693229e-02 -3.647374e-02  4.918224e-02 
         V176          V177          V178          V179          V180 
 1.527141e-03  5.104590e-02 -1.804683e-02  5.616936e-03 -3.256465e-02 
         V181          V182          V183          V184          V185 
 4.140446e-02  4.889232e-02 -6.985342e-04 -1.882804e-03  3.204315e-02 
         V186          V187          V188          V189          V190 
 2.646265e-02  1.493969e-03  1.295463e-02 -3.536039e-02  9.036209e-03 
         V191          V192          V193          V194          V195 
-3.688612e-02  2.921627e-02  1.760281e-02 -1.125985e-02 -5.270407e-02 
         V196          V197          V198          V199          V200 
 5.477980e-02 -1.439582e-02 -1.925892e-02 -4.972975e-03 -3.987572e-02 
         V201          V202          V203          V204          V205 
-6.918132e-02 -5.848673e-02  4.481911e-03 -2.263267e-02  2.529943e-02 
         V206          V207          V208          V209          V210 
-2.758857e-02  5.907427e-02 -2.347826e-02  1.929996e-02 -1.800511e-02 
         V211          V212          V213          V214          V215 
-1.048717e-02  5.219902e-03  1.157210e-02 -3.659274e-02 -5.664424e-03 
         V216          V217          V218          V219          V220 
 2.916583e-02 -8.289739e-03 -5.135217e-03  2.256618e-02  6.548928e-02 
         V221          V222          V223          V224          V225 
-3.082480e-03  1.428895e-02  3.370185e-02 -2.056431e-02 -3.352950e-02 
         V226          V227          V228          V229          V230 
-6.307870e-03 -6.801866e-03 -2.930302e-02  1.086116e-03 -2.524184e-02 
         V231          V232          V233          V234          V235 
-3.084785e-02 -1.774082e-02  4.182456e-02 -5.813966e-02  1.322414e-02 
         V236          V237          V238          V239          V240 
-1.120165e-03 -7.221729e-03  6.309677e-02  6.131331e-03 -3.725817e-03 
         V241          V242          V243          V244          V245 
 3.459934e-02  3.649880e-02 -2.753063e-02 -4.512040e-02  5.152800e-02 
         V246          V247          V248          V249          V250 
-3.732874e-03  2.106460e-03  1.834810e-02 -9.823142e-02 -3.956287e-03 
         V251          V252          V253          V254          V255 
 1.304169e-02  1.057295e-02  8.059757e-04  2.542846e-02  3.615071e-02 
         V256          V257          V258          V259          V260 
 5.511130e-02  2.523735e-02 -9.809955e-03 -1.083127e-02  2.126059e-02 
         V261          V262          V263          V264          V265 
 1.910141e-02  1.386100e-02 -2.465931e-02  4.591845e-02  3.061914e-02 
         V266          V267          V268          V269          V270 
-6.635671e-03  4.975320e-02 -1.804738e-02  7.147263e-02 -1.879728e-02 
         V271          V272          V273          V274          V275 
 3.103660e-02  2.916618e-02  1.238186e-01 -2.525044e-02 -5.451138e-02 
         V276          V277          V278          V279          V280 
-1.227649e-02 -3.430546e-02  1.280894e-02 -3.444880e-02 -1.174091e-04 
         V281          V282          V283          V284          V285 
 1.202908e-02  2.328074e-02  5.023956e-02  1.139583e-02  5.864227e-02 
         V286          V287          V288          V289          V290 
-5.197681e-02 -6.935420e-02  3.661887e-02  7.269706e-02 -3.882846e-02 
         V291          V292          V293          V294          V295 
 2.600108e-02 -3.546706e-03  5.870013e-03 -1.034316e-01 -4.495563e-02 
         V296          V297          V298          V299          V300 
 8.892992e-03 -3.375296e-02  8.428177e-03 -7.023003e-02  2.174040e-02 
         V301          V302          V303          V304          V305 
-6.319546e-02  4.990359e-02  3.809850e-02  4.663726e-02 -9.845061e-03 
         V306          V307          V308          V309          V310 
 3.537123e-02 -4.282905e-03  7.665886e-02  7.806147e-02 -6.188130e-03 
         V311          V312          V313          V314          V315 
 1.946475e-02  6.567590e-02  3.067705e-02 -1.728838e-02 -3.451199e-02 
         V316          V317          V318          V319          V320 
 4.755815e-02 -8.744582e-03  5.792478e-02  3.969092e-02  6.234229e-02 
         V321          V322          V323          V324          V325 
-6.843224e-02  3.904175e-02  6.578323e-02 -2.194547e-02  6.355533e-02 
         V326          V327          V328          V329          V330 
 3.300287e-02  1.028845e-01 -4.843334e-02 -7.637715e-03 -9.164212e-02 
         V331          V332          V333          V334          V335 
 5.529938e-02 -3.613140e-03  3.808696e-02 -2.334570e-02 -1.121143e-02 
         V336          V337          V338          V339          V340 
-3.590697e-02  6.007308e-02  3.050803e-03 -8.296982e-04 -8.608023e-03 
         V341          V342          V343          V344          V345 
 1.731934e-02 -2.586592e-02  4.364958e-02 -3.001764e-02  7.789442e-02 
         V346          V347          V348          V349          V350 
-4.764698e-02  4.257678e-02 -5.998144e-03 -2.029315e-02  8.612266e-02 
         V351          V352          V353          V354          V355 
 1.428302e-02 -1.993068e-02 -1.570347e-02  8.668477e-03  3.921612e-02 
         V356          V357          V358          V359          V360 
-7.106714e-03 -7.660122e-02  1.798962e-02  5.557888e-03 -1.573174e-02 
         V361          V362          V363          V364          V365 
-5.836846e-02  9.438173e-03 -5.327363e-02 -3.104952e-02 -5.162535e-03 
         V366          V367          V368          V369          V370 
 9.655574e-03 -1.969118e-02  8.460017e-03 -4.197337e-02 -2.189764e-03 
         V371          V372          V373          V374          V375 
-1.994959e-03 -1.431727e-02  2.023578e-02 -9.125554e-03  7.154554e-02 
         V376          V377          V378          V379          V380 
-2.597448e-02 -5.110567e-02 -1.156903e-02  3.796274e-04 -2.454643e-02 
         V381          V382          V383          V384          V385 
-6.933006e-02 -1.248870e-02  9.230912e-02 -6.921463e-02 -1.761544e-03 
         V386          V387          V388          V389          V390 
 6.651778e-02  2.044303e-02 -1.308687e-02 -1.827644e-02 -5.409321e-02 
         V391          V392          V393          V394          V395 
 1.313771e-02 -1.378777e-02 -2.313654e-02 -3.595578e-02  7.194748e-02 
         V396          V397          V398          V399          V400 
 4.335289e-02 -4.484219e-02 -7.528954e-02 -6.868144e-02  9.159105e-02 
         V401          V402          V403          V404          V405 
-3.109566e-02  3.088109e-02  3.158332e-02  5.386888e-02  1.492875e-02 
         V406          V407          V408          V409          V410 
-1.513832e-02 -3.891652e-02 -2.140367e-02 -7.864520e-02  2.477808e-03 
         V411          V412          V413          V414          V415 
-2.904563e-02  1.987378e-02  4.819875e-02  5.952610e-02  2.819583e-02 
         V416          V417          V418          V419          V420 
 2.135393e-02 -4.747661e-02 -4.843975e-02  1.541073e-02  1.055934e-02 
         V421          V422          V423          V424          V425 
 2.190361e-02  5.081357e-03 -1.218873e-02  4.621333e-02  6.069880e-03 
         V426          V427          V428          V429          V430 
-3.263475e-02 -1.612220e-02 -5.822226e-02  2.386754e-02  1.576484e-02 
         V431          V432          V433          V434          V435 
-2.133342e-02  1.045843e-01 -2.607423e-02  4.393389e-02 -2.879573e-02 
         V436          V437          V438          V439          V440 
-1.532873e-03  3.238129e-02 -2.812015e-02  1.821509e-02  2.900912e-02 
         V441          V442          V443          V444          V445 
 1.040630e-01  6.533784e-04  2.061169e-03 -2.755225e-02 -4.058034e-02 
         V446          V447          V448          V449          V450 
 3.830768e-02 -6.460296e-03  8.388263e-03 -3.443251e-02  3.216127e-02 
         V451          V452          V453          V454          V455 
-1.849723e-02 -1.660590e-02  2.223060e-04  5.237985e-02 -2.452232e-02 
         V456          V457          V458          V459          V460 
 2.384875e-02 -6.243195e-02  7.679348e-03 -1.367517e-01 -4.333739e-02 
         V461          V462          V463          V464          V465 
 1.190101e-02  5.648681e-02 -8.162013e-03 -7.247830e-02 -3.667523e-02 
         V466          V467          V468          V469          V470 
-1.411475e-02  2.044669e-02 -2.043076e-02  1.186690e-02  1.261852e-02 
         V471          V472          V473          V474          V475 
-2.134078e-02 -3.871855e-02 -1.234277e-02 -3.560410e-02  3.922034e-02 
         V476          V477          V478          V479          V480 
 4.359152e-03 -1.912605e-02  2.749763e-02 -1.186194e-02 -1.168267e-01 
         V481          V482          V483          V484          V485 
 2.310280e-02  1.605090e-02  3.893193e-02 -3.629140e-02  4.742809e-02 
         V486          V487          V488          V489          V490 
-5.145210e-02  6.080645e-02  8.878933e-03  3.540025e-02 -6.280326e-02 
         V491          V492          V493          V494          V495 
-4.014632e-03  2.340244e-02  9.512409e-02  2.390056e-02  6.786424e-02 
         V496          V497          V498          V499          V500 
 3.637386e-02 -3.653954e-02 -6.673186e-03  2.918212e-02 -5.695023e-02 
         V501 
-7.911187e-02 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href=""></a><span class="fu">coef</span>(final_model_lasso)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>501 x 1 sparse Matrix of class "dgCMatrix"
                       s0
(Intercept) -0.0318577957
V1           .           
V2           .           
V3           .           
V4           0.0030914233
V5           .           
V6           .           
V7           .           
V8           .           
V9           .           
V10          0.0047226730
V11          .           
V12          .           
V13          .           
V14          .           
V15          .           
V16          .           
V17          0.0299728965
V18          .           
V19          .           
V20          .           
V21          .           
V22          .           
V23          .           
V24          .           
V25          .           
V26          .           
V27          .           
V28          .           
V29          .           
V30          .           
V31          .           
V32          .           
V33          .           
V34          .           
V35          .           
V36          .           
V37          .           
V38          .           
V39          0.0326071223
V40          .           
V41          .           
V42          .           
V43          .           
V44          .           
V45          .           
V46          0.0269023166
V47          .           
V48          .           
V49          .           
V50          .           
V51          .           
V52          .           
V53          .           
V54          .           
V55          .           
V56          .           
V57          .           
V58          .           
V59          .           
V60          .           
V61          .           
V62          .           
V63          .           
V64          .           
V65          .           
V66          .           
V67          .           
V68          .           
V69          .           
V70          .           
V71          .           
V72          .           
V73          .           
V74          .           
V75          .           
V76          .           
V77          .           
V78          .           
V79          .           
V80          .           
V81          0.0346057288
V82          .           
V83          .           
V84          .           
V85          .           
V86          .           
V87          0.0162653866
V88          .           
V89          .           
V90          .           
V91          .           
V92          .           
V93          .           
V94          .           
V95          .           
V96          0.0035616303
V97          .           
V98          0.0089524743
V99          .           
V100         .           
V101         0.0112878522
V102         .           
V103         0.0026399099
V104         .           
V105         .           
V106         .           
V107         .           
V108         .           
V109         .           
V110         .           
V111         .           
V112         .           
V113         .           
V114         .           
V115         .           
V116         0.0064589755
V117         .           
V118         .           
V119         .           
V120         .           
V121         .           
V122         .           
V123         .           
V124         .           
V125         .           
V126         .           
V127         .           
V128         .           
V129         .           
V130         .           
V131         .           
V132         .           
V133         .           
V134         .           
V135         .           
V136         .           
V137         .           
V138         .           
V139         .           
V140         .           
V141         .           
V142         .           
V143         .           
V144         .           
V145         .           
V146         0.0033363317
V147         .           
V148         .           
V149         0.0004707551
V150         0.0312791391
V151         .           
V152         .           
V153         0.0105582280
V154         .           
V155         .           
V156         .           
V157         .           
V158         .           
V159         .           
V160         .           
V161         .           
V162         .           
V163         .           
V164         .           
V165         0.0055955906
V166         .           
V167         .           
V168         .           
V169         .           
V170         0.0036027451
V171         .           
V172         .           
V173         .           
V174         .           
V175         .           
V176         .           
V177         .           
V178         .           
V179         .           
V180         .           
V181         .           
V182         .           
V183         .           
V184         .           
V185         .           
V186         .           
V187         .           
V188         .           
V189         .           
V190         .           
V191         .           
V192         .           
V193         .           
V194         .           
V195         0.0184586302
V196         .           
V197         .           
V198         .           
V199         .           
V200         .           
V201         .           
V202         .           
V203         .           
V204         .           
V205         .           
V206         0.0636339496
V207         .           
V208         .           
V209         .           
V210         .           
V211         .           
V212         .           
V213         .           
V214         .           
V215         .           
V216         .           
V217         .           
V218         0.0162553925
V219         .           
V220         .           
V221         .           
V222         .           
V223         .           
V224         .           
V225         .           
V226         .           
V227         .           
V228         .           
V229         .           
V230         .           
V231         .           
V232         0.0037924952
V233         .           
V234         .           
V235         .           
V236         .           
V237         0.0148716548
V238         .           
V239         .           
V240         0.0220373339
V241         .           
V242         .           
V243         .           
V244         .           
V245         .           
V246         .           
V247         .           
V248         .           
V249         .           
V250         .           
V251         .           
V252         .           
V253         .           
V254         0.0066894345
V255         .           
V256         .           
V257         .           
V258         .           
V259         .           
V260         0.0030336126
V261         .           
V262         .           
V263         .           
V264         .           
V265         .           
V266         .           
V267         .           
V268         0.0309584949
V269         .           
V270         0.0144657655
V271         .           
V272         0.0437404525
V273         .           
V274         .           
V275         .           
V276         .           
V277         .           
V278         .           
V279         .           
V280         .           
V281         .           
V282         0.0286520888
V283         .           
V284         .           
V285         .           
V286         .           
V287         .           
V288         .           
V289         .           
V290         0.0023025633
V291         .           
V292         .           
V293         .           
V294         .           
V295         .           
V296         .           
V297         .           
V298         .           
V299         .           
V300         .           
V301         0.0007022808
V302         0.0065865570
V303         .           
V304         .           
V305         .           
V306         .           
V307         0.0171055978
V308         0.0263544291
V309         0.0182085077
V310         .           
V311         0.0226701544
V312         .           
V313         .           
V314         .           
V315         .           
V316         .           
V317         .           
V318         .           
V319         .           
V320         .           
V321         .           
V322         0.0097060808
V323         .           
V324         .           
V325         .           
V326         0.0155107902
V327         .           
V328         .           
V329         .           
V330         .           
V331         .           
V332         .           
V333         .           
V334         .           
V335         .           
V336         0.0152165086
V337         0.0088979380
V338         .           
V339         .           
V340         .           
V341         .           
V342         .           
V343         .           
V344         0.0252503204
V345         .           
V346         .           
V347         .           
V348         .           
V349         0.0015258848
V350         .           
V351         .           
V352         .           
V353         .           
V354         .           
V355         .           
V356         .           
V357         .           
V358         .           
V359         .           
V360         .           
V361         .           
V362         .           
V363         .           
V364         .           
V365         .           
V366         .           
V367         .           
V368         .           
V369         .           
V370         .           
V371         .           
V372         .           
V373         .           
V374         0.0348789579
V375         .           
V376         .           
V377         .           
V378         .           
V379         .           
V380         .           
V381         .           
V382         .           
V383         .           
V384         .           
V385         0.0228203868
V386         .           
V387         .           
V388         .           
V389         .           
V390         .           
V391         .           
V392         .           
V393         .           
V394         0.0039057221
V395         .           
V396         .           
V397         .           
V398         .           
V399         .           
V400         .           
V401         .           
V402         .           
V403         .           
V404         .           
V405         .           
V406         .           
V407         .           
V408         .           
V409         .           
V410         .           
V411         .           
V412         .           
V413         .           
V414         0.0142775933
V415         .           
V416         .           
V417         .           
V418         .           
V419         .           
V420         .           
V421         .           
V422         .           
V423         .           
V424         .           
V425         .           
V426         .           
V427         .           
V428         .           
V429         .           
V430         .           
V431         0.0083567434
V432         .           
V433         .           
V434         .           
V435         .           
V436         .           
V437         .           
V438         .           
V439         .           
V440         0.0179312957
V441         .           
V442         .           
V443         .           
V444         .           
V445         0.0128745533
V446         .           
V447         0.0043021589
V448         .           
V449         .           
V450         .           
V451         .           
V452         .           
V453         0.0446048121
V454         .           
V455         .           
V456         .           
V457         .           
V458         .           
V459         .           
V460         .           
V461         0.0079880557
V462         .           
V463         .           
V464         .           
V465         .           
V466         .           
V467         0.0154393012
V468         .           
V469         0.0043607809
V470         .           
V471         .           
V472         .           
V473         .           
V474         .           
V475         .           
V476         .           
V477         .           
V478         .           
V479         .           
V480         .           
V481         .           
V482         .           
V483         .           
V484         0.0057285995
V485         .           
V486         .           
V487         .           
V488         .           
V489         .           
V490         .           
V491         0.0033695734
V492         0.0470346311
V493         .           
V494         0.0016314810
V495         .           
V496         .           
V497         .           
V498         .           
V499         .           
V500         .           </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href=""></a><span class="fu">coef</span>(final_model_ridge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>501 x 1 sparse Matrix of class "dgCMatrix"
                       s0
(Intercept) -2.865354e-02
V1           2.167280e-04
V2           2.955138e-04
V3          -8.367953e-05
V4           1.850182e-03
V5           1.906581e-04
V6           9.750705e-04
V7           9.575597e-04
V8           1.319461e-03
V9          -1.130685e-04
V10          2.056606e-03
V11          1.036019e-03
V12          6.380628e-04
V13         -6.442557e-04
V14          1.467190e-03
V15          1.267740e-05
V16          2.881191e-04
V17          2.705835e-03
V18          6.219983e-04
V19          3.877841e-04
V20          1.678781e-03
V21          7.779796e-05
V22          1.243828e-03
V23          1.624701e-03
V24          1.052183e-03
V25          1.444718e-03
V26          1.140488e-03
V27         -2.250791e-04
V28          6.511698e-04
V29          1.286385e-03
V30          1.202755e-03
V31          7.784026e-04
V32          1.291474e-04
V33          1.702884e-04
V34          1.064825e-03
V35          1.017843e-03
V36          8.294937e-04
V37          3.279028e-04
V38         -4.035186e-06
V39          2.755785e-03
V40         -8.932416e-06
V41          7.707573e-04
V42          1.009989e-03
V43          1.168206e-03
V44         -4.587604e-04
V45          1.178849e-03
V46          2.465077e-03
V47          9.663022e-04
V48          1.167310e-03
V49          5.364368e-04
V50         -1.999387e-05
V51         -5.831221e-04
V52          5.949827e-04
V53          7.055241e-04
V54          4.290528e-04
V55          8.445375e-04
V56         -8.395004e-04
V57          2.717119e-04
V58          1.382426e-03
V59          1.120481e-03
V60          2.968109e-04
V61          9.944970e-04
V62          2.336393e-04
V63          1.420497e-03
V64         -1.769000e-04
V65          7.950667e-04
V66          1.060475e-04
V67         -4.188537e-04
V68          1.007751e-03
V69          1.447871e-03
V70         -1.280382e-04
V71         -2.668475e-04
V72         -1.224424e-04
V73          8.532392e-04
V74          6.909848e-04
V75          1.378585e-03
V76          1.191845e-03
V77          5.642178e-04
V78          4.208838e-04
V79         -3.858808e-04
V80         -7.589899e-04
V81          2.588323e-03
V82         -1.639355e-04
V83          1.260667e-03
V84         -2.988602e-04
V85          1.042609e-03
V86          1.050112e-03
V87          2.048916e-03
V88          1.449022e-03
V89          1.715574e-03
V90          2.723963e-04
V91          2.597136e-04
V92          1.209356e-04
V93          1.085726e-03
V94          6.559513e-04
V95         -2.221742e-03
V96          1.704751e-03
V97          1.459901e-03
V98          2.036035e-03
V99         -1.259614e-03
V100         1.168989e-05
V101         2.109905e-03
V102        -4.918686e-04
V103         1.870809e-03
V104        -1.810529e-04
V105         1.100200e-03
V106         2.072096e-04
V107         7.302005e-04
V108        -8.560143e-04
V109        -1.955751e-04
V110         7.584646e-04
V111         7.503769e-04
V112         4.658870e-04
V113         1.023409e-03
V114         1.329387e-03
V115         8.952670e-04
V116         2.053105e-03
V117        -2.961944e-04
V118         2.326750e-04
V119        -3.308212e-04
V120         4.481669e-04
V121         1.222537e-03
V122         1.484514e-04
V123         1.064389e-03
V124         4.124160e-04
V125         8.296257e-04
V126         4.818262e-04
V127         1.173863e-03
V128         1.926503e-03
V129         1.101529e-03
V130         1.837449e-04
V131         1.779827e-04
V132         7.110344e-04
V133        -8.353134e-04
V134         1.692832e-03
V135         9.493554e-04
V136         2.607075e-04
V137         1.187854e-03
V138         2.529349e-04
V139         1.290571e-03
V140         7.065360e-04
V141         1.389280e-03
V142        -6.761267e-04
V143         1.283430e-03
V144        -2.889603e-04
V145         7.009766e-04
V146         2.512842e-03
V147         1.097313e-03
V148         1.915978e-03
V149         2.111984e-03
V150         2.805666e-03
V151         9.721394e-04
V152         1.043814e-03
V153         2.962415e-03
V154         1.307117e-04
V155         1.969557e-03
V156         1.372516e-03
V157        -3.039874e-04
V158         1.748684e-03
V159         2.196853e-03
V160         8.178020e-04
V161         1.011557e-03
V162         1.147636e-03
V163         1.260116e-03
V164        -8.611822e-04
V165         2.433448e-03
V166         2.078977e-03
V167         7.469583e-04
V168         1.352541e-03
V169         7.545272e-04
V170         3.047950e-03
V171         7.399010e-04
V172         1.962104e-03
V173         3.375478e-04
V174         2.352332e-03
V175         5.560582e-04
V176         2.097759e-03
V177         7.029303e-04
V178         1.723345e-03
V179         4.371834e-04
V180         2.382114e-03
V181         2.115505e-03
V182         2.518617e-03
V183         7.600115e-04
V184         2.650789e-03
V185         1.992420e-03
V186         1.656032e-03
V187         2.735493e-03
V188         8.375756e-04
V189         2.355223e-03
V190         1.864958e-03
V191         2.448343e-03
V192         1.437023e-03
V193         1.901146e-03
V194         5.338915e-04
V195         3.552816e-03
V196         9.875361e-04
V197         2.035674e-03
V198         1.643902e-03
V199         1.933229e-03
V200         1.436316e-03
V201         4.738040e-05
V202         2.139731e-03
V203         1.980426e-03
V204         2.684567e-03
V205         1.832442e-03
V206         5.065454e-03
V207         2.720901e-03
V208         2.922349e-03
V209         1.732643e-03
V210         2.165939e-03
V211         3.115725e-03
V212         1.922217e-03
V213         1.959292e-03
V214         2.655085e-03
V215         1.918763e-03
V216         2.848593e-03
V217         1.688433e-03
V218         3.867490e-03
V219         2.590148e-03
V220         1.982987e-03
V221         1.635756e-03
V222         2.822295e-03
V223         1.616738e-03
V224         1.087914e-03
V225         2.585765e-03
V226         2.611442e-03
V227         2.523596e-03
V228         2.804514e-03
V229         1.372287e-03
V230         1.572637e-03
V231         2.826317e-03
V232         3.598894e-03
V233         1.436951e-03
V234         3.430837e-03
V235         1.764395e-03
V236         2.306805e-03
V237         3.990329e-03
V238         3.655603e-03
V239         3.067717e-03
V240         4.502460e-03
V241         3.852587e-03
V242         2.314952e-03
V243         2.453010e-03
V244         3.181151e-03
V245         2.514264e-03
V246         3.285888e-03
V247         2.907601e-03
V248         1.810894e-03
V249         2.338839e-03
V250         2.219623e-03
V251         3.713173e-03
V252         2.663058e-03
V253         2.839364e-03
V254         4.346545e-03
V255         3.121361e-03
V256         2.956635e-03
V257         3.390645e-03
V258         1.852526e-03
V259         3.158392e-03
V260         4.007233e-03
V261         2.431114e-03
V262         6.338944e-04
V263         3.670501e-03
V264         4.153088e-03
V265         2.376660e-03
V266         3.542239e-03
V267         2.758125e-03
V268         4.822691e-03
V269         2.845204e-03
V270         4.411894e-03
V271         2.964156e-03
V272         5.585078e-03
V273         2.952399e-03
V274         2.777875e-03
V275         2.598117e-03
V276         2.721825e-03
V277         3.458599e-03
V278         1.457427e-03
V279         3.462633e-03
V280         3.214811e-03
V281         2.831546e-03
V282         5.063938e-03
V283         2.744431e-03
V284         4.012575e-03
V285         2.899732e-03
V286         2.083043e-03
V287         3.808241e-03
V288         4.166945e-03
V289         2.184656e-03
V290         4.545468e-03
V291         3.030255e-03
V292         3.005040e-03
V293         2.261732e-03
V294         2.348221e-03
V295         4.093334e-03
V296         2.116320e-03
V297         3.362113e-03
V298         2.885889e-03
V299         3.175944e-03
V300         2.626001e-03
V301         4.658326e-03
V302         4.410580e-03
V303         4.224655e-03
V304         3.291711e-03
V305         3.626662e-03
V306         3.992252e-03
V307         4.617773e-03
V308         5.016535e-03
V309         5.205148e-03
V310         3.242052e-03
V311         5.066572e-03
V312         3.796173e-03
V313         3.113188e-03
V314         2.273246e-03
V315         3.664206e-03
V316         3.678605e-03
V317         3.988079e-03
V318         3.819650e-03
V319         4.106655e-03
V320         3.147165e-03
V321         4.181420e-03
V322         4.446195e-03
V323         1.913063e-03
V324         3.462606e-03
V325         2.978914e-03
V326         5.100066e-03
V327         3.310599e-03
V328         2.901749e-03
V329         2.587239e-03
V330         3.958740e-03
V331         2.099320e-03
V332         3.947994e-03
V333         3.868935e-03
V334         2.910587e-03
V335         2.600827e-03
V336         4.558267e-03
V337         4.581594e-03
V338         2.878540e-03
V339         2.929131e-03
V340         3.586419e-03
V341         2.242224e-03
V342         3.244042e-03
V343         2.690187e-03
V344         4.967800e-03
V345         2.299154e-03
V346         3.560517e-03
V347         3.068803e-03
V348         2.753963e-03
V349         4.272179e-03
V350         2.343072e-03
V351         2.603976e-03
V352         1.776130e-03
V353         3.402467e-03
V354         2.931762e-03
V355         3.017385e-03
V356         2.000551e-03
V357         3.562314e-03
V358         2.439166e-03
V359         2.453918e-03
V360         2.626310e-03
V361         2.517635e-03
V362         1.987260e-03
V363         2.571556e-03
V364         3.350426e-03
V365         2.189470e-03
V366         2.562836e-03
V367         2.166536e-03
V368         2.802476e-03
V369         2.379545e-03
V370         3.315803e-03
V371         1.769776e-03
V372         2.056895e-03
V373         2.110139e-03
V374         5.036649e-03
V375         1.971056e-03
V376         3.621618e-03
V377         2.384853e-03
V378         3.151103e-03
V379         3.658883e-03
V380         2.271690e-03
V381         2.604806e-03
V382         3.676031e-03
V383         2.392703e-03
V384         2.850522e-03
V385         4.491039e-03
V386         2.863453e-03
V387         3.359094e-03
V388         1.897170e-03
V389         1.742957e-03
V390         1.914850e-03
V391         1.916617e-03
V392         1.990986e-03
V393         2.166997e-03
V394         3.873086e-03
V395         3.336010e-03
V396         1.049315e-03
V397         2.388797e-03
V398         1.030014e-03
V399         3.429831e-03
V400         1.549983e-03
V401         2.712279e-03
V402         2.190017e-03
V403         2.414424e-03
V404         3.017268e-03
V405         1.998394e-03
V406         2.693564e-03
V407         2.049833e-03
V408         6.674966e-04
V409         3.057217e-03
V410         1.182045e-03
V411         2.786950e-03
V412         2.527312e-03
V413         2.754815e-03
V414         3.722868e-03
V415         2.075901e-03
V416         1.551147e-03
V417         1.446188e-03
V418         2.330107e-03
V419         2.914885e-03
V420         2.338345e-03
V421         2.841947e-03
V422         2.352985e-03
V423         2.299546e-03
V424         2.153187e-03
V425         2.279296e-03
V426         2.024454e-03
V427         1.285107e-03
V428         2.980673e-03
V429         2.410389e-03
V430         2.514995e-04
V431         3.585762e-03
V432         1.218890e-03
V433         2.995551e-03
V434         1.738360e-03
V435         1.507563e-03
V436         2.274149e-03
V437         9.093235e-04
V438         2.009606e-03
V439         2.179246e-03
V440         3.450935e-03
V441         1.422645e-03
V442         2.026773e-03
V443         2.022235e-03
V444         1.844714e-03
V445         3.013765e-03
V446         1.905283e-03
V447         2.894418e-03
V448         8.621861e-04
V449         2.440333e-03
V450         1.125332e-03
V451         2.665956e-03
V452         1.801359e-03
V453         3.936141e-03
V454         2.253344e-03
V455         2.396151e-03
V456         2.827142e-03
V457         1.996305e-03
V458         4.138709e-04
V459        -1.194389e-05
V460         1.391048e-03
V461         3.094106e-03
V462         8.460869e-04
V463         4.739316e-04
V464         1.414061e-03
V465         1.725727e-03
V466         2.418370e-03
V467         3.091388e-03
V468         1.965926e-03
V469         2.518678e-03
V470         4.190097e-04
V471         5.766643e-04
V472         1.530153e-03
V473        -5.390772e-04
V474         1.421560e-03
V475         1.184409e-03
V476         5.231604e-04
V477         2.450711e-03
V478         1.442697e-03
V479         1.607744e-04
V480         1.692584e-03
V481         1.430615e-03
V482         9.890197e-04
V483         4.359889e-04
V484         2.557579e-03
V485         1.148438e-03
V486         1.768674e-03
V487         1.517576e-03
V488         1.332107e-03
V489        -6.441748e-05
V490         2.133319e-03
V491         2.280519e-03
V492         3.472703e-03
V493         2.313135e-03
V494         2.277602e-03
V495         1.498679e-03
V496         1.683649e-03
V497         1.309040e-03
V498         1.252088e-03
V499         5.895195e-06
V500        -6.182946e-04</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>When p &lt; n, a linear model is able to be created, with an R^2 superior to ridge/lasso. However, it is clear that some variables have an t-statistic with a p-value above 0.05. In comparison, both ridge and lasso have shrunk many of the variables either close or equal to 0.</p>
</section>
<section class="slide level2">

<h3 id="p-n-2">p &gt; n</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href=""></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">12</span>)</span>
<span id="cb29-2"><a href=""></a><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb29-3"><a href=""></a></span>
<span id="cb29-4"><a href=""></a><span class="co"># Set up parallelized LOOCV for the huge dataset (ridge)</span></span>
<span id="cb29-5"><a href=""></a>cv_ridge_parallel <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, selected_lambda) {</span>
<span id="cb29-6"><a href=""></a>  </span>
<span id="cb29-7"><a href=""></a>  <span class="co">#for (i in 1:nrow(dataset)) {</span></span>
<span id="cb29-8"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb29-9"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(dataset), <span class="at">.packages =</span> <span class="st">'glmnet'</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb29-10"><a href=""></a>    test_row <span class="ot">&lt;-</span> dataset[i,]</span>
<span id="cb29-11"><a href=""></a>    test_row_x <span class="ot">&lt;-</span> test_row[<span class="dv">2</span><span class="sc">:</span><span class="dv">1001</span>]</span>
<span id="cb29-12"><a href=""></a>    test_row_y <span class="ot">&lt;-</span> test_row[<span class="dv">1</span>]</span>
<span id="cb29-13"><a href=""></a>    </span>
<span id="cb29-14"><a href=""></a>    train_rows <span class="ot">&lt;-</span> dataset[<span class="sc">-</span>i,]</span>
<span id="cb29-15"><a href=""></a>    train_rows_x <span class="ot">&lt;-</span> train_rows[,<span class="dv">2</span><span class="sc">:</span><span class="dv">1001</span>]</span>
<span id="cb29-16"><a href=""></a>    train_rows_y <span class="ot">&lt;-</span> train_rows[,<span class="dv">1</span>]</span>
<span id="cb29-17"><a href=""></a>    </span>
<span id="cb29-18"><a href=""></a>    <span class="co"># Train gaussian model</span></span>
<span id="cb29-19"><a href=""></a>    single_model_ridge <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(train_rows_x), <span class="at">y =</span> train_rows_y, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> selected_lambda, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb29-20"><a href=""></a>    <span class="co"># Test the model</span></span>
<span id="cb29-21"><a href=""></a>    predict_result <span class="ot">&lt;-</span> <span class="fu">predict</span>(single_model_ridge, <span class="at">newx =</span> test_row_x)</span>
<span id="cb29-22"><a href=""></a>    <span class="co"># Calculate RSS</span></span>
<span id="cb29-23"><a href=""></a>    rss <span class="ot">&lt;-</span> (test_row_y <span class="sc">-</span> predict_result) <span class="sc">**</span> <span class="dv">2</span></span>
<span id="cb29-24"><a href=""></a>    <span class="fu">return</span>(rss)</span>
<span id="cb29-25"><a href=""></a>    <span class="co">#cv_total[i] = rss</span></span>
<span id="cb29-26"><a href=""></a>  }</span>
<span id="cb29-27"><a href=""></a>  <span class="fu">stopifnot</span>(<span class="fu">length</span>(cv_total)<span class="sc">==</span> <span class="fu">nrow</span>(data_multi))</span>
<span id="cb29-28"><a href=""></a>  <span class="fu">return</span> (cv_total)</span>
<span id="cb29-29"><a href=""></a>}</span>
<span id="cb29-30"><a href=""></a></span>
<span id="cb29-31"><a href=""></a><span class="co"># lasso</span></span>
<span id="cb29-32"><a href=""></a>cv_lasso_parallel <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, selected_lambda) {</span>
<span id="cb29-33"><a href=""></a>  </span>
<span id="cb29-34"><a href=""></a>  <span class="co">#for (i in 1:nrow(dataset)) {</span></span>
<span id="cb29-35"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb29-36"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(dataset), <span class="at">.packages =</span> <span class="st">'glmnet'</span>) <span class="sc">%dopar%</span> {</span>
<span id="cb29-37"><a href=""></a>    test_row <span class="ot">&lt;-</span> dataset[i,]</span>
<span id="cb29-38"><a href=""></a>    test_row_x <span class="ot">&lt;-</span> test_row[<span class="dv">2</span><span class="sc">:</span><span class="dv">1001</span>]</span>
<span id="cb29-39"><a href=""></a>    test_row_y <span class="ot">&lt;-</span> test_row[<span class="dv">1</span>]</span>
<span id="cb29-40"><a href=""></a>    </span>
<span id="cb29-41"><a href=""></a>    train_rows <span class="ot">&lt;-</span> dataset[<span class="sc">-</span>i,]</span>
<span id="cb29-42"><a href=""></a>    train_rows_x <span class="ot">&lt;-</span> train_rows[,<span class="dv">2</span><span class="sc">:</span><span class="dv">1001</span>]</span>
<span id="cb29-43"><a href=""></a>    train_rows_y <span class="ot">&lt;-</span> train_rows[,<span class="dv">1</span>]</span>
<span id="cb29-44"><a href=""></a>    </span>
<span id="cb29-45"><a href=""></a>    <span class="co"># Train gaussian model</span></span>
<span id="cb29-46"><a href=""></a>    single_model_lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(train_rows_x), <span class="at">y =</span> train_rows_y, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> selected_lambda, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb29-47"><a href=""></a>    <span class="co"># Test the model</span></span>
<span id="cb29-48"><a href=""></a>    predict_result <span class="ot">&lt;-</span> <span class="fu">predict</span>(single_model_lasso, <span class="at">newx =</span> test_row_x)</span>
<span id="cb29-49"><a href=""></a>    <span class="co"># Calculate RSS</span></span>
<span id="cb29-50"><a href=""></a>    rss <span class="ot">&lt;-</span> (test_row_y <span class="sc">-</span> predict_result) <span class="sc">**</span> <span class="dv">2</span></span>
<span id="cb29-51"><a href=""></a>    <span class="fu">return</span>(rss)</span>
<span id="cb29-52"><a href=""></a>    <span class="co">#cv_total[i] = rss</span></span>
<span id="cb29-53"><a href=""></a>  }</span>
<span id="cb29-54"><a href=""></a>  <span class="fu">stopifnot</span>(<span class="fu">length</span>(cv_total)<span class="sc">==</span> <span class="fu">nrow</span>(data_multi))</span>
<span id="cb29-55"><a href=""></a>  <span class="fu">return</span> (cv_total)</span>
<span id="cb29-56"><a href=""></a>}</span>
<span id="cb29-57"><a href=""></a></span>
<span id="cb29-58"><a href=""></a></span>
<span id="cb29-59"><a href=""></a><span class="co"># No standardization necessary, since data is from a std. normal distribution.</span></span>
<span id="cb29-60"><a href=""></a><span class="fu">library</span>(MASS)</span>
<span id="cb29-61"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb29-62"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">199</span>)</span>
<span id="cb29-63"><a href=""></a><span class="co"># Generate correlated data from multivariate normal distribution</span></span>
<span id="cb29-64"><a href=""></a><span class="co"># Modified from STA108 lecture</span></span>
<span id="cb29-65"><a href=""></a>means <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">1001</span>)</span>
<span id="cb29-66"><a href=""></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">1001</span>, <span class="at">ncol =</span> <span class="dv">1001</span>)</span>
<span id="cb29-67"><a href=""></a>correlation <span class="ot">&lt;-</span> <span class="fl">0.7</span> <span class="co"># assume correlation is 0.7</span></span>
<span id="cb29-68"><a href=""></a><span class="fu">diag</span>(Sigma) <span class="ot">&lt;-</span> <span class="fl">1.0</span> <span class="co"># set diagonals of Sigma to 1.</span></span>
<span id="cb29-69"><a href=""></a></span>
<span id="cb29-70"><a href=""></a><span class="co"># set everything else to 0.7</span></span>
<span id="cb29-71"><a href=""></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Sigma)) {</span>
<span id="cb29-72"><a href=""></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(Sigma)) {</span>
<span id="cb29-73"><a href=""></a>    <span class="cf">if</span> (i <span class="sc">!=</span> j) {</span>
<span id="cb29-74"><a href=""></a>      Sigma[i,j] <span class="ot">=</span> <span class="fl">0.7</span></span>
<span id="cb29-75"><a href=""></a>    }</span>
<span id="cb29-76"><a href=""></a>  }</span>
<span id="cb29-77"><a href=""></a>}</span>
<span id="cb29-78"><a href=""></a></span>
<span id="cb29-79"><a href=""></a>data_multi <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">500</span>,means,Sigma)</span>
<span id="cb29-80"><a href=""></a><span class="co"># First col of data_multi is y, the remaining are xs.</span></span>
<span id="cb29-81"><a href=""></a></span>
<span id="cb29-82"><a href=""></a><span class="co"># Step 2: Try lambdas</span></span>
<span id="cb29-83"><a href=""></a>lambdas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.00005</span>, <span class="fl">0.0005</span>, <span class="fl">0.005</span>, <span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>)</span>
<span id="cb29-84"><a href=""></a></span>
<span id="cb29-85"><a href=""></a><span class="co"># Step 3: Perform LOOCV</span></span>
<span id="cb29-86"><a href=""></a>results <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(<span class="at">Lambda =</span> <span class="fu">numeric</span>(), <span class="at">CV_ridge =</span> <span class="fu">numeric</span>(), <span class="at">CV_lasso=</span><span class="fu">numeric</span>())</span>
<span id="cb29-87"><a href=""></a><span class="cf">for</span> (curr_lambda <span class="cf">in</span> lambdas) {</span>
<span id="cb29-88"><a href=""></a>  <span class="co"># cross_validation_total &lt;- c()</span></span>
<span id="cb29-89"><a href=""></a>  <span class="co"># cross_validation_total &lt;- c(cross_validation_total, </span></span>
<span id="cb29-90"><a href=""></a>  <span class="co">#                             clusterApply(cl = clusterOfThreads,</span></span>
<span id="cb29-91"><a href=""></a>  <span class="co">#                                          x = data_multi,</span></span>
<span id="cb29-92"><a href=""></a>  <span class="co">#                                          fun = cv_ridge_parallel)</span></span>
<span id="cb29-93"><a href=""></a>  <span class="co">#                           )</span></span>
<span id="cb29-94"><a href=""></a>  cv_total_for_lambda_ridge <span class="ot">&lt;-</span> <span class="fu">cv_ridge_parallel</span>(data_multi, curr_lambda)</span>
<span id="cb29-95"><a href=""></a>  cv_total_for_lambda_lasso <span class="ot">&lt;-</span> <span class="fu">cv_lasso_parallel</span>(data_multi, curr_lambda)</span>
<span id="cb29-96"><a href=""></a>  </span>
<span id="cb29-97"><a href=""></a>  results <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> <span class="fu">add_row</span>(<span class="at">Lambda =</span> curr_lambda, <span class="at">CV_ridge =</span> <span class="fu">sum</span>(<span class="fu">unlist</span>(cv_total_for_lambda_ridge)) <span class="sc">/</span> <span class="fu">nrow</span>(data_multi), <span class="at">CV_lasso =</span> <span class="fu">sum</span>(<span class="fu">unlist</span>(cv_total_for_lambda_lasso)) <span class="sc">/</span> <span class="fu">nrow</span>(data_multi))</span>
<span id="cb29-98"><a href=""></a>}</span>
<span id="cb29-99"><a href=""></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href=""></a><span class="fu">kable</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">Lambda</th>
<th style="text-align: right;">CV_ridge</th>
<th style="text-align: right;">CV_lasso</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">1.2853119</td>
<td style="text-align: right;">1.2853119</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0e-05</td>
<td style="text-align: right;">1.2821543</td>
<td style="text-align: right;">1.2518749</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0e-04</td>
<td style="text-align: right;">1.2553085</td>
<td style="text-align: right;">0.6817481</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0e-03</td>
<td style="text-align: right;">0.6862268</td>
<td style="text-align: right;">0.4083260</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.0e-02</td>
<td style="text-align: right;">0.4987516</td>
<td style="text-align: right;">0.2871026</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0e-01</td>
<td style="text-align: right;">0.3177667</td>
<td style="text-align: right;">0.6167953</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0e+00</td>
<td style="text-align: right;">0.2969274</td>
<td style="text-align: right;">0.9255901</td>
</tr>
<tr class="even">
<td style="text-align: right;">5.0e+00</td>
<td style="text-align: right;">0.2788000</td>
<td style="text-align: right;">0.9255901</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.0e+01</td>
<td style="text-align: right;">0.2773727</td>
<td style="text-align: right;">0.9255901</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.5e+01</td>
<td style="text-align: right;">0.2772186</td>
<td style="text-align: right;">0.9255901</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a><span class="fu">ggplot</span>(<span class="at">data =</span> results, <span class="fu">aes</span>(<span class="at">x =</span> lambdas, <span class="at">y =</span> CV_ridge)) <span class="sc">+</span></span>
<span id="cb31-2"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(CV_ridge,<span class="dv">4</span>), <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Lambda"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"CV vs Lambda (Ridge)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RidgeAndLassoPresentation_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href=""></a><span class="fu">ggplot</span>(<span class="at">data =</span> results, <span class="fu">aes</span>(<span class="at">x =</span> lambdas, <span class="at">y =</span> CV_lasso)) <span class="sc">+</span></span>
<span id="cb32-2"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(CV_lasso,<span class="dv">4</span>), <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Lambda"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"CV vs Lambda (Lasso)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RidgeAndLassoPresentation_files/figure-revealjs/unnamed-chunk-17-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a>x <span class="ot">&lt;-</span> data_multi[,<span class="dv">2</span><span class="sc">:</span><span class="dv">501</span>]</span>
<span id="cb33-2"><a href=""></a>y <span class="ot">&lt;-</span> data_multi[,<span class="dv">1</span>]</span>
<span id="cb33-3"><a href=""></a>final_model_ridge <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> <span class="dv">15</span>, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb33-4"><a href=""></a>final_model_ridge<span class="sc">$</span>dev.ratio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7125507</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a>final_model_lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> <span class="fl">0.05</span>, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb35-2"><a href=""></a>final_model_lasso<span class="sc">$</span>dev.ratio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7435799</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href=""></a>data_multi_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data_multi)</span>
<span id="cb37-2"><a href=""></a>final_model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(V1 <span class="sc">~</span> . , <span class="at">data =</span> data_multi_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href=""></a><span class="fu">summary</span>(final_model_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = V1 ~ ., data = data_multi_df)

Residuals:
ALL 500 residuals are 0: no residual degrees of freedom!

Coefficients: (501 not defined because of singularities)
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.054426        NaN     NaN      NaN
V2           2.609991        NaN     NaN      NaN
V3           1.711761        NaN     NaN      NaN
V4          -2.181570        NaN     NaN      NaN
V5          -0.242280        NaN     NaN      NaN
V6          -1.820529        NaN     NaN      NaN
V7           1.035568        NaN     NaN      NaN
V8           0.492999        NaN     NaN      NaN
V9          -0.140804        NaN     NaN      NaN
V10         -2.532074        NaN     NaN      NaN
V11         -0.323160        NaN     NaN      NaN
V12          4.389601        NaN     NaN      NaN
V13         -3.199648        NaN     NaN      NaN
V14         -1.311771        NaN     NaN      NaN
V15          1.233513        NaN     NaN      NaN
V16         -1.750331        NaN     NaN      NaN
V17          2.006689        NaN     NaN      NaN
V18          3.739404        NaN     NaN      NaN
V19          0.752364        NaN     NaN      NaN
V20         -0.397761        NaN     NaN      NaN
V21         -0.731732        NaN     NaN      NaN
V22         -1.729453        NaN     NaN      NaN
V23         -1.489463        NaN     NaN      NaN
V24         -0.151271        NaN     NaN      NaN
V25         -0.828318        NaN     NaN      NaN
V26          1.225812        NaN     NaN      NaN
V27          0.050432        NaN     NaN      NaN
V28         -1.381736        NaN     NaN      NaN
V29          0.008984        NaN     NaN      NaN
V30         -2.371159        NaN     NaN      NaN
V31          0.850733        NaN     NaN      NaN
V32         -0.324102        NaN     NaN      NaN
V33          0.908112        NaN     NaN      NaN
V34         -2.392598        NaN     NaN      NaN
V35         -0.283771        NaN     NaN      NaN
V36          0.781047        NaN     NaN      NaN
V37         -0.739100        NaN     NaN      NaN
V38          0.136414        NaN     NaN      NaN
V39         -0.416642        NaN     NaN      NaN
V40         -0.788437        NaN     NaN      NaN
V41         -0.296003        NaN     NaN      NaN
V42          0.870437        NaN     NaN      NaN
V43          1.328830        NaN     NaN      NaN
V44         -0.844377        NaN     NaN      NaN
V45          0.249265        NaN     NaN      NaN
V46         -1.809437        NaN     NaN      NaN
V47         -1.708010        NaN     NaN      NaN
V48         -2.189628        NaN     NaN      NaN
V49         -0.825392        NaN     NaN      NaN
V50          0.687757        NaN     NaN      NaN
V51          1.750677        NaN     NaN      NaN
V52         -0.361008        NaN     NaN      NaN
V53          1.255489        NaN     NaN      NaN
V54         -0.472985        NaN     NaN      NaN
V55          2.776052        NaN     NaN      NaN
V56          2.584539        NaN     NaN      NaN
V57          1.405435        NaN     NaN      NaN
V58          2.646271        NaN     NaN      NaN
V59          0.348607        NaN     NaN      NaN
V60          0.297771        NaN     NaN      NaN
V61         -1.665370        NaN     NaN      NaN
V62         -1.368505        NaN     NaN      NaN
V63         -1.671630        NaN     NaN      NaN
V64         -1.081266        NaN     NaN      NaN
V65         -0.144145        NaN     NaN      NaN
V66          0.614011        NaN     NaN      NaN
V67         -0.186254        NaN     NaN      NaN
V68          1.224592        NaN     NaN      NaN
V69         -1.739454        NaN     NaN      NaN
V70          0.727759        NaN     NaN      NaN
V71         -1.615852        NaN     NaN      NaN
V72         -0.599468        NaN     NaN      NaN
V73         -0.473873        NaN     NaN      NaN
V74          0.167412        NaN     NaN      NaN
V75          0.962915        NaN     NaN      NaN
V76          1.305148        NaN     NaN      NaN
V77         -2.197442        NaN     NaN      NaN
V78         -0.915752        NaN     NaN      NaN
V79         -0.051525        NaN     NaN      NaN
V80         -1.362926        NaN     NaN      NaN
V81         -1.623042        NaN     NaN      NaN
V82          0.411771        NaN     NaN      NaN
V83         -0.875398        NaN     NaN      NaN
V84          3.481072        NaN     NaN      NaN
V85          0.339401        NaN     NaN      NaN
V86         -0.355233        NaN     NaN      NaN
V87          1.013877        NaN     NaN      NaN
V88          0.645193        NaN     NaN      NaN
V89         -1.001876        NaN     NaN      NaN
V90         -0.405296        NaN     NaN      NaN
V91         -0.485254        NaN     NaN      NaN
V92         -0.786665        NaN     NaN      NaN
V93         -1.329869        NaN     NaN      NaN
V94          1.565209        NaN     NaN      NaN
V95          0.581984        NaN     NaN      NaN
V96         -0.965192        NaN     NaN      NaN
V97          2.095172        NaN     NaN      NaN
V98         -0.261137        NaN     NaN      NaN
V99          0.281836        NaN     NaN      NaN
V100        -1.228240        NaN     NaN      NaN
V101         2.562317        NaN     NaN      NaN
V102         2.966474        NaN     NaN      NaN
V103        -3.695396        NaN     NaN      NaN
V104        -0.392864        NaN     NaN      NaN
V105        -0.134091        NaN     NaN      NaN
V106         1.274163        NaN     NaN      NaN
V107         0.057640        NaN     NaN      NaN
V108         0.646210        NaN     NaN      NaN
V109        -0.600313        NaN     NaN      NaN
V110        -0.742861        NaN     NaN      NaN
V111         3.067836        NaN     NaN      NaN
V112         1.692504        NaN     NaN      NaN
V113        -0.344487        NaN     NaN      NaN
V114        -0.962197        NaN     NaN      NaN
V115        -1.694068        NaN     NaN      NaN
V116        -0.199412        NaN     NaN      NaN
V117        -0.444381        NaN     NaN      NaN
V118         2.480901        NaN     NaN      NaN
V119         0.024286        NaN     NaN      NaN
V120         0.000558        NaN     NaN      NaN
V121         1.269272        NaN     NaN      NaN
V122        -1.116478        NaN     NaN      NaN
V123         2.024066        NaN     NaN      NaN
V124        -1.725852        NaN     NaN      NaN
V125        -0.259496        NaN     NaN      NaN
V126         1.947266        NaN     NaN      NaN
V127         1.129183        NaN     NaN      NaN
V128         1.575181        NaN     NaN      NaN
V129        -0.621803        NaN     NaN      NaN
V130        -3.805478        NaN     NaN      NaN
V131        -2.172124        NaN     NaN      NaN
V132         1.626752        NaN     NaN      NaN
V133         0.050116        NaN     NaN      NaN
V134         0.479561        NaN     NaN      NaN
V135         0.244165        NaN     NaN      NaN
V136        -1.383391        NaN     NaN      NaN
V137         2.704934        NaN     NaN      NaN
V138         0.273871        NaN     NaN      NaN
V139        -1.213723        NaN     NaN      NaN
V140         0.130818        NaN     NaN      NaN
V141         0.306408        NaN     NaN      NaN
V142        -4.365126        NaN     NaN      NaN
V143         2.636568        NaN     NaN      NaN
V144        -0.176500        NaN     NaN      NaN
V145         0.932004        NaN     NaN      NaN
V146         0.080518        NaN     NaN      NaN
V147        -3.516257        NaN     NaN      NaN
V148        -2.573476        NaN     NaN      NaN
V149         1.016580        NaN     NaN      NaN
V150        -0.579296        NaN     NaN      NaN
V151        -1.965928        NaN     NaN      NaN
V152         1.166426        NaN     NaN      NaN
V153         0.275964        NaN     NaN      NaN
V154        -0.333334        NaN     NaN      NaN
V155        -0.588155        NaN     NaN      NaN
V156         1.179236        NaN     NaN      NaN
V157         0.868788        NaN     NaN      NaN
V158        -4.553126        NaN     NaN      NaN
V159        -0.105981        NaN     NaN      NaN
V160        -0.236106        NaN     NaN      NaN
V161         2.024922        NaN     NaN      NaN
V162         0.385551        NaN     NaN      NaN
V163        -2.759367        NaN     NaN      NaN
V164        -1.925097        NaN     NaN      NaN
V165        -3.002635        NaN     NaN      NaN
V166        -2.842050        NaN     NaN      NaN
V167        -2.129011        NaN     NaN      NaN
V168        -0.193903        NaN     NaN      NaN
V169        -2.202702        NaN     NaN      NaN
V170        -0.462180        NaN     NaN      NaN
V171         1.661011        NaN     NaN      NaN
V172         0.223874        NaN     NaN      NaN
V173        -0.234568        NaN     NaN      NaN
V174         3.200807        NaN     NaN      NaN
V175         1.411915        NaN     NaN      NaN
V176        -0.621783        NaN     NaN      NaN
V177        -0.658079        NaN     NaN      NaN
V178        -1.894766        NaN     NaN      NaN
V179         0.298478        NaN     NaN      NaN
V180         0.005528        NaN     NaN      NaN
V181        -0.488304        NaN     NaN      NaN
V182        -0.558314        NaN     NaN      NaN
V183         0.103179        NaN     NaN      NaN
V184        -1.673930        NaN     NaN      NaN
V185        -0.455745        NaN     NaN      NaN
V186         0.262749        NaN     NaN      NaN
V187         0.146336        NaN     NaN      NaN
V188        -0.616319        NaN     NaN      NaN
V189         0.887347        NaN     NaN      NaN
V190        -2.074432        NaN     NaN      NaN
V191         3.082708        NaN     NaN      NaN
V192         0.708982        NaN     NaN      NaN
V193        -1.734072        NaN     NaN      NaN
V194        -0.624622        NaN     NaN      NaN
V195        -2.545246        NaN     NaN      NaN
V196        -0.268548        NaN     NaN      NaN
V197        -0.880444        NaN     NaN      NaN
V198         0.249461        NaN     NaN      NaN
V199         2.657795        NaN     NaN      NaN
V200         0.171102        NaN     NaN      NaN
V201        -1.154527        NaN     NaN      NaN
V202         0.709459        NaN     NaN      NaN
V203        -0.437827        NaN     NaN      NaN
V204        -1.695415        NaN     NaN      NaN
V205        -0.042223        NaN     NaN      NaN
V206        -0.128526        NaN     NaN      NaN
V207        -0.265942        NaN     NaN      NaN
V208        -1.421605        NaN     NaN      NaN
V209         2.014624        NaN     NaN      NaN
V210        -4.233698        NaN     NaN      NaN
V211        -2.343961        NaN     NaN      NaN
V212        -1.286653        NaN     NaN      NaN
V213         0.555588        NaN     NaN      NaN
V214         0.431446        NaN     NaN      NaN
V215         4.713913        NaN     NaN      NaN
V216         0.107837        NaN     NaN      NaN
V217         1.083074        NaN     NaN      NaN
V218        -0.053709        NaN     NaN      NaN
V219         1.232238        NaN     NaN      NaN
V220        -0.401753        NaN     NaN      NaN
V221        -0.936496        NaN     NaN      NaN
V222        -0.965137        NaN     NaN      NaN
V223         0.981062        NaN     NaN      NaN
V224        -0.419465        NaN     NaN      NaN
V225         2.090984        NaN     NaN      NaN
V226        -0.003527        NaN     NaN      NaN
V227         1.311486        NaN     NaN      NaN
V228         0.095378        NaN     NaN      NaN
V229         4.070207        NaN     NaN      NaN
V230         0.752009        NaN     NaN      NaN
V231         0.904244        NaN     NaN      NaN
V232        -2.076051        NaN     NaN      NaN
V233         0.771502        NaN     NaN      NaN
V234        -2.498340        NaN     NaN      NaN
V235        -2.774771        NaN     NaN      NaN
V236         0.569374        NaN     NaN      NaN
V237        -2.664619        NaN     NaN      NaN
V238        -3.428751        NaN     NaN      NaN
V239         0.647236        NaN     NaN      NaN
V240        -0.353915        NaN     NaN      NaN
V241        -0.965084        NaN     NaN      NaN
V242         2.322767        NaN     NaN      NaN
V243        -0.198882        NaN     NaN      NaN
V244        -1.065292        NaN     NaN      NaN
V245         0.338883        NaN     NaN      NaN
V246         0.058074        NaN     NaN      NaN
V247         1.744765        NaN     NaN      NaN
V248        -0.646415        NaN     NaN      NaN
V249        -0.164217        NaN     NaN      NaN
V250        -1.138383        NaN     NaN      NaN
V251         0.063103        NaN     NaN      NaN
V252         2.453051        NaN     NaN      NaN
V253        -0.038097        NaN     NaN      NaN
V254        -0.942005        NaN     NaN      NaN
V255         0.506281        NaN     NaN      NaN
V256         1.286408        NaN     NaN      NaN
V257        -1.168747        NaN     NaN      NaN
V258        -1.936730        NaN     NaN      NaN
V259         0.127867        NaN     NaN      NaN
V260         0.650633        NaN     NaN      NaN
V261         0.095654        NaN     NaN      NaN
V262         1.415656        NaN     NaN      NaN
V263        -1.160408        NaN     NaN      NaN
V264        -0.570991        NaN     NaN      NaN
V265         0.555741        NaN     NaN      NaN
V266        -0.630501        NaN     NaN      NaN
V267        -0.822147        NaN     NaN      NaN
V268        -0.659256        NaN     NaN      NaN
V269        -0.137026        NaN     NaN      NaN
V270        -0.990314        NaN     NaN      NaN
V271         2.586222        NaN     NaN      NaN
V272        -1.288468        NaN     NaN      NaN
V273         0.166097        NaN     NaN      NaN
V274         3.077131        NaN     NaN      NaN
V275         1.002470        NaN     NaN      NaN
V276         0.765796        NaN     NaN      NaN
V277         1.337087        NaN     NaN      NaN
V278         0.269552        NaN     NaN      NaN
V279        -0.051226        NaN     NaN      NaN
V280        -0.931455        NaN     NaN      NaN
V281         1.290804        NaN     NaN      NaN
V282        -1.126980        NaN     NaN      NaN
V283        -0.280380        NaN     NaN      NaN
V284         0.843963        NaN     NaN      NaN
V285        -1.716768        NaN     NaN      NaN
V286        -0.947067        NaN     NaN      NaN
V287         1.381379        NaN     NaN      NaN
V288         1.206183        NaN     NaN      NaN
V289        -1.468560        NaN     NaN      NaN
V290        -0.314962        NaN     NaN      NaN
V291        -0.057907        NaN     NaN      NaN
V292        -3.072506        NaN     NaN      NaN
V293        -1.434833        NaN     NaN      NaN
V294        -0.334903        NaN     NaN      NaN
V295         0.662432        NaN     NaN      NaN
V296        -1.668117        NaN     NaN      NaN
V297         0.060303        NaN     NaN      NaN
V298        -2.284906        NaN     NaN      NaN
V299        -1.739470        NaN     NaN      NaN
V300         0.184942        NaN     NaN      NaN
V301        -2.489409        NaN     NaN      NaN
V302         0.960542        NaN     NaN      NaN
V303         1.332539        NaN     NaN      NaN
V304         2.724826        NaN     NaN      NaN
V305         3.350226        NaN     NaN      NaN
V306        -0.560199        NaN     NaN      NaN
V307        -0.640718        NaN     NaN      NaN
V308         0.768347        NaN     NaN      NaN
V309         0.145789        NaN     NaN      NaN
V310         0.229948        NaN     NaN      NaN
V311         2.116289        NaN     NaN      NaN
V312        -2.250036        NaN     NaN      NaN
V313         1.613257        NaN     NaN      NaN
V314        -0.952600        NaN     NaN      NaN
V315         0.463150        NaN     NaN      NaN
V316         1.406850        NaN     NaN      NaN
V317         0.177848        NaN     NaN      NaN
V318         0.333869        NaN     NaN      NaN
V319        -1.283842        NaN     NaN      NaN
V320         0.233185        NaN     NaN      NaN
V321         1.055350        NaN     NaN      NaN
V322         1.776294        NaN     NaN      NaN
V323         0.656650        NaN     NaN      NaN
V324        -0.282527        NaN     NaN      NaN
V325        -0.871302        NaN     NaN      NaN
V326         0.649631        NaN     NaN      NaN
V327        -1.668345        NaN     NaN      NaN
V328        -0.615224        NaN     NaN      NaN
V329         1.503056        NaN     NaN      NaN
V330         0.813135        NaN     NaN      NaN
V331         1.267932        NaN     NaN      NaN
V332        -1.842672        NaN     NaN      NaN
V333        -2.159361        NaN     NaN      NaN
V334         0.793757        NaN     NaN      NaN
V335        -0.753135        NaN     NaN      NaN
V336         2.163879        NaN     NaN      NaN
V337        -0.216662        NaN     NaN      NaN
V338        -1.063499        NaN     NaN      NaN
V339        -2.189941        NaN     NaN      NaN
V340         2.323294        NaN     NaN      NaN
V341         0.737892        NaN     NaN      NaN
V342        -1.045308        NaN     NaN      NaN
V343        -1.152748        NaN     NaN      NaN
V344        -0.262428        NaN     NaN      NaN
V345        -1.357881        NaN     NaN      NaN
V346        -0.282378        NaN     NaN      NaN
V347         0.788240        NaN     NaN      NaN
V348         1.972809        NaN     NaN      NaN
V349         1.416900        NaN     NaN      NaN
V350         1.220221        NaN     NaN      NaN
V351        -0.203494        NaN     NaN      NaN
V352         3.184726        NaN     NaN      NaN
V353         1.436698        NaN     NaN      NaN
V354        -0.028550        NaN     NaN      NaN
V355         1.335606        NaN     NaN      NaN
V356        -2.180381        NaN     NaN      NaN
V357         1.570432        NaN     NaN      NaN
V358         0.395245        NaN     NaN      NaN
V359         1.035165        NaN     NaN      NaN
V360        -0.496788        NaN     NaN      NaN
V361         1.010984        NaN     NaN      NaN
V362        -1.003520        NaN     NaN      NaN
V363         0.911673        NaN     NaN      NaN
V364        -1.284523        NaN     NaN      NaN
V365        -3.105487        NaN     NaN      NaN
V366         0.518305        NaN     NaN      NaN
V367         1.549929        NaN     NaN      NaN
V368        -3.999532        NaN     NaN      NaN
V369        -0.028488        NaN     NaN      NaN
V370         1.910382        NaN     NaN      NaN
V371         0.378524        NaN     NaN      NaN
V372         0.701836        NaN     NaN      NaN
V373        -0.536489        NaN     NaN      NaN
V374        -0.093109        NaN     NaN      NaN
V375         0.530983        NaN     NaN      NaN
V376         0.796370        NaN     NaN      NaN
V377        -0.072270        NaN     NaN      NaN
V378         2.266685        NaN     NaN      NaN
V379        -0.742076        NaN     NaN      NaN
V380        -1.035200        NaN     NaN      NaN
V381        -0.085904        NaN     NaN      NaN
V382        -1.933843        NaN     NaN      NaN
V383         1.365605        NaN     NaN      NaN
V384        -0.867541        NaN     NaN      NaN
V385         1.981806        NaN     NaN      NaN
V386        -0.134121        NaN     NaN      NaN
V387        -1.394752        NaN     NaN      NaN
V388        -1.188985        NaN     NaN      NaN
V389        -0.647257        NaN     NaN      NaN
V390         0.982492        NaN     NaN      NaN
V391         1.394876        NaN     NaN      NaN
V392         1.512323        NaN     NaN      NaN
V393        -0.710277        NaN     NaN      NaN
V394         0.218757        NaN     NaN      NaN
V395         1.872842        NaN     NaN      NaN
V396        -0.925354        NaN     NaN      NaN
V397        -1.762718        NaN     NaN      NaN
V398         1.370800        NaN     NaN      NaN
V399        -1.476596        NaN     NaN      NaN
V400        -0.737873        NaN     NaN      NaN
V401        -0.824085        NaN     NaN      NaN
V402        -0.899827        NaN     NaN      NaN
V403        -0.623849        NaN     NaN      NaN
V404        -0.700426        NaN     NaN      NaN
V405        -1.115406        NaN     NaN      NaN
V406         0.564223        NaN     NaN      NaN
V407        -1.476955        NaN     NaN      NaN
V408        -0.005119        NaN     NaN      NaN
V409         0.787682        NaN     NaN      NaN
V410         1.492106        NaN     NaN      NaN
V411         0.814165        NaN     NaN      NaN
V412        -2.465736        NaN     NaN      NaN
V413        -0.010425        NaN     NaN      NaN
V414         3.459500        NaN     NaN      NaN
V415        -1.591665        NaN     NaN      NaN
V416        -1.277398        NaN     NaN      NaN
V417         1.455745        NaN     NaN      NaN
V418        -0.726874        NaN     NaN      NaN
V419         2.000874        NaN     NaN      NaN
V420        -0.520911        NaN     NaN      NaN
V421         0.670151        NaN     NaN      NaN
V422         1.003573        NaN     NaN      NaN
V423         0.384429        NaN     NaN      NaN
V424         0.312636        NaN     NaN      NaN
V425         0.752481        NaN     NaN      NaN
V426        -1.984984        NaN     NaN      NaN
V427        -0.428444        NaN     NaN      NaN
V428         0.065625        NaN     NaN      NaN
V429        -1.465131        NaN     NaN      NaN
V430         0.864271        NaN     NaN      NaN
V431        -1.362953        NaN     NaN      NaN
V432         0.226214        NaN     NaN      NaN
V433        -0.642996        NaN     NaN      NaN
V434        -2.480867        NaN     NaN      NaN
V435         0.340945        NaN     NaN      NaN
V436         1.219960        NaN     NaN      NaN
V437         3.771629        NaN     NaN      NaN
V438         0.063840        NaN     NaN      NaN
V439        -1.320369        NaN     NaN      NaN
V440        -0.912573        NaN     NaN      NaN
V441         0.154488        NaN     NaN      NaN
V442         0.306498        NaN     NaN      NaN
V443         0.977991        NaN     NaN      NaN
V444         0.155282        NaN     NaN      NaN
V445         0.837770        NaN     NaN      NaN
V446        -1.311434        NaN     NaN      NaN
V447         0.616786        NaN     NaN      NaN
V448         0.683691        NaN     NaN      NaN
V449        -0.923084        NaN     NaN      NaN
V450         0.627548        NaN     NaN      NaN
V451         2.247956        NaN     NaN      NaN
V452         3.645754        NaN     NaN      NaN
V453        -1.943284        NaN     NaN      NaN
V454         0.443378        NaN     NaN      NaN
V455         1.218570        NaN     NaN      NaN
V456         1.603484        NaN     NaN      NaN
V457        -0.935573        NaN     NaN      NaN
V458         1.157357        NaN     NaN      NaN
V459         3.049813        NaN     NaN      NaN
V460         1.219052        NaN     NaN      NaN
V461        -3.015193        NaN     NaN      NaN
V462         1.325429        NaN     NaN      NaN
V463        -0.432857        NaN     NaN      NaN
V464         1.811291        NaN     NaN      NaN
V465        -1.136683        NaN     NaN      NaN
V466        -1.622969        NaN     NaN      NaN
V467        -0.707260        NaN     NaN      NaN
V468        -0.195599        NaN     NaN      NaN
V469        -1.614036        NaN     NaN      NaN
V470        -0.353582        NaN     NaN      NaN
V471        -2.098900        NaN     NaN      NaN
V472        -0.833599        NaN     NaN      NaN
V473         1.633047        NaN     NaN      NaN
V474        -0.936912        NaN     NaN      NaN
V475         2.450459        NaN     NaN      NaN
V476         1.026921        NaN     NaN      NaN
V477        -0.560707        NaN     NaN      NaN
V478        -0.638743        NaN     NaN      NaN
V479        -1.265083        NaN     NaN      NaN
V480         2.771183        NaN     NaN      NaN
V481        -0.011978        NaN     NaN      NaN
V482        -0.245024        NaN     NaN      NaN
V483         1.008263        NaN     NaN      NaN
V484        -1.534861        NaN     NaN      NaN
V485         0.636360        NaN     NaN      NaN
V486        -0.157960        NaN     NaN      NaN
V487         2.237738        NaN     NaN      NaN
V488         0.928348        NaN     NaN      NaN
V489         1.319264        NaN     NaN      NaN
V490        -0.727168        NaN     NaN      NaN
V491         0.236306        NaN     NaN      NaN
V492        -0.762428        NaN     NaN      NaN
V493         1.933067        NaN     NaN      NaN
V494         1.273656        NaN     NaN      NaN
V495         2.115533        NaN     NaN      NaN
V496         0.799197        NaN     NaN      NaN
V497         1.810491        NaN     NaN      NaN
V498         0.457374        NaN     NaN      NaN
V499         0.639956        NaN     NaN      NaN
V500         1.899994        NaN     NaN      NaN
V501               NA         NA      NA       NA
V502               NA         NA      NA       NA
V503               NA         NA      NA       NA
V504               NA         NA      NA       NA
V505               NA         NA      NA       NA
V506               NA         NA      NA       NA
V507               NA         NA      NA       NA
V508               NA         NA      NA       NA
V509               NA         NA      NA       NA
V510               NA         NA      NA       NA
V511               NA         NA      NA       NA
V512               NA         NA      NA       NA
V513               NA         NA      NA       NA
V514               NA         NA      NA       NA
V515               NA         NA      NA       NA
V516               NA         NA      NA       NA
V517               NA         NA      NA       NA
V518               NA         NA      NA       NA
V519               NA         NA      NA       NA
V520               NA         NA      NA       NA
V521               NA         NA      NA       NA
V522               NA         NA      NA       NA
V523               NA         NA      NA       NA
V524               NA         NA      NA       NA
V525               NA         NA      NA       NA
V526               NA         NA      NA       NA
V527               NA         NA      NA       NA
V528               NA         NA      NA       NA
V529               NA         NA      NA       NA
V530               NA         NA      NA       NA
V531               NA         NA      NA       NA
V532               NA         NA      NA       NA
V533               NA         NA      NA       NA
V534               NA         NA      NA       NA
V535               NA         NA      NA       NA
V536               NA         NA      NA       NA
V537               NA         NA      NA       NA
V538               NA         NA      NA       NA
V539               NA         NA      NA       NA
V540               NA         NA      NA       NA
V541               NA         NA      NA       NA
V542               NA         NA      NA       NA
V543               NA         NA      NA       NA
V544               NA         NA      NA       NA
V545               NA         NA      NA       NA
V546               NA         NA      NA       NA
V547               NA         NA      NA       NA
V548               NA         NA      NA       NA
V549               NA         NA      NA       NA
V550               NA         NA      NA       NA
V551               NA         NA      NA       NA
V552               NA         NA      NA       NA
V553               NA         NA      NA       NA
V554               NA         NA      NA       NA
V555               NA         NA      NA       NA
V556               NA         NA      NA       NA
V557               NA         NA      NA       NA
V558               NA         NA      NA       NA
V559               NA         NA      NA       NA
V560               NA         NA      NA       NA
V561               NA         NA      NA       NA
V562               NA         NA      NA       NA
V563               NA         NA      NA       NA
V564               NA         NA      NA       NA
V565               NA         NA      NA       NA
V566               NA         NA      NA       NA
V567               NA         NA      NA       NA
V568               NA         NA      NA       NA
V569               NA         NA      NA       NA
V570               NA         NA      NA       NA
V571               NA         NA      NA       NA
V572               NA         NA      NA       NA
V573               NA         NA      NA       NA
V574               NA         NA      NA       NA
V575               NA         NA      NA       NA
V576               NA         NA      NA       NA
V577               NA         NA      NA       NA
V578               NA         NA      NA       NA
V579               NA         NA      NA       NA
V580               NA         NA      NA       NA
V581               NA         NA      NA       NA
V582               NA         NA      NA       NA
V583               NA         NA      NA       NA
V584               NA         NA      NA       NA
V585               NA         NA      NA       NA
V586               NA         NA      NA       NA
V587               NA         NA      NA       NA
V588               NA         NA      NA       NA
V589               NA         NA      NA       NA
V590               NA         NA      NA       NA
V591               NA         NA      NA       NA
V592               NA         NA      NA       NA
V593               NA         NA      NA       NA
V594               NA         NA      NA       NA
V595               NA         NA      NA       NA
V596               NA         NA      NA       NA
V597               NA         NA      NA       NA
V598               NA         NA      NA       NA
V599               NA         NA      NA       NA
V600               NA         NA      NA       NA
V601               NA         NA      NA       NA
V602               NA         NA      NA       NA
V603               NA         NA      NA       NA
V604               NA         NA      NA       NA
V605               NA         NA      NA       NA
V606               NA         NA      NA       NA
V607               NA         NA      NA       NA
V608               NA         NA      NA       NA
V609               NA         NA      NA       NA
V610               NA         NA      NA       NA
V611               NA         NA      NA       NA
V612               NA         NA      NA       NA
V613               NA         NA      NA       NA
V614               NA         NA      NA       NA
V615               NA         NA      NA       NA
V616               NA         NA      NA       NA
V617               NA         NA      NA       NA
V618               NA         NA      NA       NA
V619               NA         NA      NA       NA
V620               NA         NA      NA       NA
V621               NA         NA      NA       NA
V622               NA         NA      NA       NA
V623               NA         NA      NA       NA
V624               NA         NA      NA       NA
V625               NA         NA      NA       NA
V626               NA         NA      NA       NA
V627               NA         NA      NA       NA
V628               NA         NA      NA       NA
V629               NA         NA      NA       NA
V630               NA         NA      NA       NA
V631               NA         NA      NA       NA
V632               NA         NA      NA       NA
V633               NA         NA      NA       NA
V634               NA         NA      NA       NA
V635               NA         NA      NA       NA
V636               NA         NA      NA       NA
V637               NA         NA      NA       NA
V638               NA         NA      NA       NA
V639               NA         NA      NA       NA
V640               NA         NA      NA       NA
V641               NA         NA      NA       NA
V642               NA         NA      NA       NA
V643               NA         NA      NA       NA
V644               NA         NA      NA       NA
V645               NA         NA      NA       NA
V646               NA         NA      NA       NA
V647               NA         NA      NA       NA
V648               NA         NA      NA       NA
V649               NA         NA      NA       NA
V650               NA         NA      NA       NA
V651               NA         NA      NA       NA
V652               NA         NA      NA       NA
V653               NA         NA      NA       NA
V654               NA         NA      NA       NA
V655               NA         NA      NA       NA
V656               NA         NA      NA       NA
V657               NA         NA      NA       NA
V658               NA         NA      NA       NA
V659               NA         NA      NA       NA
V660               NA         NA      NA       NA
V661               NA         NA      NA       NA
V662               NA         NA      NA       NA
V663               NA         NA      NA       NA
V664               NA         NA      NA       NA
V665               NA         NA      NA       NA
V666               NA         NA      NA       NA
V667               NA         NA      NA       NA
V668               NA         NA      NA       NA
V669               NA         NA      NA       NA
V670               NA         NA      NA       NA
V671               NA         NA      NA       NA
V672               NA         NA      NA       NA
V673               NA         NA      NA       NA
V674               NA         NA      NA       NA
V675               NA         NA      NA       NA
V676               NA         NA      NA       NA
V677               NA         NA      NA       NA
V678               NA         NA      NA       NA
V679               NA         NA      NA       NA
V680               NA         NA      NA       NA
V681               NA         NA      NA       NA
V682               NA         NA      NA       NA
V683               NA         NA      NA       NA
V684               NA         NA      NA       NA
V685               NA         NA      NA       NA
V686               NA         NA      NA       NA
V687               NA         NA      NA       NA
V688               NA         NA      NA       NA
V689               NA         NA      NA       NA
V690               NA         NA      NA       NA
V691               NA         NA      NA       NA
V692               NA         NA      NA       NA
V693               NA         NA      NA       NA
V694               NA         NA      NA       NA
V695               NA         NA      NA       NA
V696               NA         NA      NA       NA
V697               NA         NA      NA       NA
V698               NA         NA      NA       NA
V699               NA         NA      NA       NA
V700               NA         NA      NA       NA
V701               NA         NA      NA       NA
V702               NA         NA      NA       NA
V703               NA         NA      NA       NA
V704               NA         NA      NA       NA
V705               NA         NA      NA       NA
V706               NA         NA      NA       NA
V707               NA         NA      NA       NA
V708               NA         NA      NA       NA
V709               NA         NA      NA       NA
V710               NA         NA      NA       NA
V711               NA         NA      NA       NA
V712               NA         NA      NA       NA
V713               NA         NA      NA       NA
V714               NA         NA      NA       NA
V715               NA         NA      NA       NA
V716               NA         NA      NA       NA
V717               NA         NA      NA       NA
V718               NA         NA      NA       NA
V719               NA         NA      NA       NA
V720               NA         NA      NA       NA
V721               NA         NA      NA       NA
V722               NA         NA      NA       NA
V723               NA         NA      NA       NA
V724               NA         NA      NA       NA
V725               NA         NA      NA       NA
V726               NA         NA      NA       NA
V727               NA         NA      NA       NA
V728               NA         NA      NA       NA
V729               NA         NA      NA       NA
V730               NA         NA      NA       NA
V731               NA         NA      NA       NA
V732               NA         NA      NA       NA
V733               NA         NA      NA       NA
V734               NA         NA      NA       NA
V735               NA         NA      NA       NA
V736               NA         NA      NA       NA
V737               NA         NA      NA       NA
V738               NA         NA      NA       NA
V739               NA         NA      NA       NA
V740               NA         NA      NA       NA
V741               NA         NA      NA       NA
V742               NA         NA      NA       NA
V743               NA         NA      NA       NA
V744               NA         NA      NA       NA
V745               NA         NA      NA       NA
V746               NA         NA      NA       NA
V747               NA         NA      NA       NA
V748               NA         NA      NA       NA
V749               NA         NA      NA       NA
V750               NA         NA      NA       NA
V751               NA         NA      NA       NA
V752               NA         NA      NA       NA
V753               NA         NA      NA       NA
V754               NA         NA      NA       NA
V755               NA         NA      NA       NA
V756               NA         NA      NA       NA
V757               NA         NA      NA       NA
V758               NA         NA      NA       NA
V759               NA         NA      NA       NA
V760               NA         NA      NA       NA
V761               NA         NA      NA       NA
V762               NA         NA      NA       NA
V763               NA         NA      NA       NA
V764               NA         NA      NA       NA
V765               NA         NA      NA       NA
V766               NA         NA      NA       NA
V767               NA         NA      NA       NA
V768               NA         NA      NA       NA
V769               NA         NA      NA       NA
V770               NA         NA      NA       NA
V771               NA         NA      NA       NA
V772               NA         NA      NA       NA
V773               NA         NA      NA       NA
V774               NA         NA      NA       NA
V775               NA         NA      NA       NA
V776               NA         NA      NA       NA
V777               NA         NA      NA       NA
V778               NA         NA      NA       NA
V779               NA         NA      NA       NA
V780               NA         NA      NA       NA
V781               NA         NA      NA       NA
V782               NA         NA      NA       NA
V783               NA         NA      NA       NA
V784               NA         NA      NA       NA
V785               NA         NA      NA       NA
V786               NA         NA      NA       NA
V787               NA         NA      NA       NA
V788               NA         NA      NA       NA
V789               NA         NA      NA       NA
V790               NA         NA      NA       NA
V791               NA         NA      NA       NA
V792               NA         NA      NA       NA
V793               NA         NA      NA       NA
V794               NA         NA      NA       NA
V795               NA         NA      NA       NA
V796               NA         NA      NA       NA
V797               NA         NA      NA       NA
V798               NA         NA      NA       NA
V799               NA         NA      NA       NA
V800               NA         NA      NA       NA
V801               NA         NA      NA       NA
V802               NA         NA      NA       NA
V803               NA         NA      NA       NA
V804               NA         NA      NA       NA
V805               NA         NA      NA       NA
V806               NA         NA      NA       NA
V807               NA         NA      NA       NA
V808               NA         NA      NA       NA
V809               NA         NA      NA       NA
V810               NA         NA      NA       NA
V811               NA         NA      NA       NA
V812               NA         NA      NA       NA
V813               NA         NA      NA       NA
V814               NA         NA      NA       NA
V815               NA         NA      NA       NA
V816               NA         NA      NA       NA
V817               NA         NA      NA       NA
V818               NA         NA      NA       NA
V819               NA         NA      NA       NA
V820               NA         NA      NA       NA
V821               NA         NA      NA       NA
V822               NA         NA      NA       NA
V823               NA         NA      NA       NA
V824               NA         NA      NA       NA
V825               NA         NA      NA       NA
V826               NA         NA      NA       NA
V827               NA         NA      NA       NA
V828               NA         NA      NA       NA
V829               NA         NA      NA       NA
V830               NA         NA      NA       NA
V831               NA         NA      NA       NA
V832               NA         NA      NA       NA
V833               NA         NA      NA       NA
V834               NA         NA      NA       NA
V835               NA         NA      NA       NA
V836               NA         NA      NA       NA
V837               NA         NA      NA       NA
V838               NA         NA      NA       NA
V839               NA         NA      NA       NA
V840               NA         NA      NA       NA
V841               NA         NA      NA       NA
V842               NA         NA      NA       NA
V843               NA         NA      NA       NA
V844               NA         NA      NA       NA
V845               NA         NA      NA       NA
V846               NA         NA      NA       NA
V847               NA         NA      NA       NA
V848               NA         NA      NA       NA
V849               NA         NA      NA       NA
V850               NA         NA      NA       NA
V851               NA         NA      NA       NA
V852               NA         NA      NA       NA
V853               NA         NA      NA       NA
V854               NA         NA      NA       NA
V855               NA         NA      NA       NA
V856               NA         NA      NA       NA
V857               NA         NA      NA       NA
V858               NA         NA      NA       NA
V859               NA         NA      NA       NA
V860               NA         NA      NA       NA
V861               NA         NA      NA       NA
V862               NA         NA      NA       NA
V863               NA         NA      NA       NA
V864               NA         NA      NA       NA
V865               NA         NA      NA       NA
V866               NA         NA      NA       NA
V867               NA         NA      NA       NA
V868               NA         NA      NA       NA
V869               NA         NA      NA       NA
V870               NA         NA      NA       NA
V871               NA         NA      NA       NA
V872               NA         NA      NA       NA
V873               NA         NA      NA       NA
V874               NA         NA      NA       NA
V875               NA         NA      NA       NA
V876               NA         NA      NA       NA
V877               NA         NA      NA       NA
V878               NA         NA      NA       NA
V879               NA         NA      NA       NA
V880               NA         NA      NA       NA
V881               NA         NA      NA       NA
V882               NA         NA      NA       NA
V883               NA         NA      NA       NA
V884               NA         NA      NA       NA
V885               NA         NA      NA       NA
V886               NA         NA      NA       NA
V887               NA         NA      NA       NA
V888               NA         NA      NA       NA
V889               NA         NA      NA       NA
V890               NA         NA      NA       NA
V891               NA         NA      NA       NA
V892               NA         NA      NA       NA
V893               NA         NA      NA       NA
V894               NA         NA      NA       NA
V895               NA         NA      NA       NA
V896               NA         NA      NA       NA
V897               NA         NA      NA       NA
V898               NA         NA      NA       NA
V899               NA         NA      NA       NA
V900               NA         NA      NA       NA
V901               NA         NA      NA       NA
V902               NA         NA      NA       NA
V903               NA         NA      NA       NA
V904               NA         NA      NA       NA
V905               NA         NA      NA       NA
V906               NA         NA      NA       NA
V907               NA         NA      NA       NA
V908               NA         NA      NA       NA
V909               NA         NA      NA       NA
V910               NA         NA      NA       NA
V911               NA         NA      NA       NA
V912               NA         NA      NA       NA
V913               NA         NA      NA       NA
V914               NA         NA      NA       NA
V915               NA         NA      NA       NA
V916               NA         NA      NA       NA
V917               NA         NA      NA       NA
V918               NA         NA      NA       NA
V919               NA         NA      NA       NA
V920               NA         NA      NA       NA
V921               NA         NA      NA       NA
V922               NA         NA      NA       NA
V923               NA         NA      NA       NA
V924               NA         NA      NA       NA
V925               NA         NA      NA       NA
V926               NA         NA      NA       NA
V927               NA         NA      NA       NA
V928               NA         NA      NA       NA
V929               NA         NA      NA       NA
V930               NA         NA      NA       NA
V931               NA         NA      NA       NA
V932               NA         NA      NA       NA
V933               NA         NA      NA       NA
V934               NA         NA      NA       NA
V935               NA         NA      NA       NA
V936               NA         NA      NA       NA
V937               NA         NA      NA       NA
V938               NA         NA      NA       NA
V939               NA         NA      NA       NA
V940               NA         NA      NA       NA
V941               NA         NA      NA       NA
V942               NA         NA      NA       NA
V943               NA         NA      NA       NA
V944               NA         NA      NA       NA
V945               NA         NA      NA       NA
V946               NA         NA      NA       NA
V947               NA         NA      NA       NA
V948               NA         NA      NA       NA
V949               NA         NA      NA       NA
V950               NA         NA      NA       NA
V951               NA         NA      NA       NA
V952               NA         NA      NA       NA
V953               NA         NA      NA       NA
V954               NA         NA      NA       NA
V955               NA         NA      NA       NA
V956               NA         NA      NA       NA
V957               NA         NA      NA       NA
V958               NA         NA      NA       NA
V959               NA         NA      NA       NA
V960               NA         NA      NA       NA
V961               NA         NA      NA       NA
V962               NA         NA      NA       NA
V963               NA         NA      NA       NA
V964               NA         NA      NA       NA
V965               NA         NA      NA       NA
V966               NA         NA      NA       NA
V967               NA         NA      NA       NA
V968               NA         NA      NA       NA
V969               NA         NA      NA       NA
V970               NA         NA      NA       NA
V971               NA         NA      NA       NA
V972               NA         NA      NA       NA
V973               NA         NA      NA       NA
V974               NA         NA      NA       NA
V975               NA         NA      NA       NA
V976               NA         NA      NA       NA
V977               NA         NA      NA       NA
V978               NA         NA      NA       NA
V979               NA         NA      NA       NA
V980               NA         NA      NA       NA
V981               NA         NA      NA       NA
V982               NA         NA      NA       NA
V983               NA         NA      NA       NA
V984               NA         NA      NA       NA
V985               NA         NA      NA       NA
V986               NA         NA      NA       NA
V987               NA         NA      NA       NA
V988               NA         NA      NA       NA
V989               NA         NA      NA       NA
V990               NA         NA      NA       NA
V991               NA         NA      NA       NA
V992               NA         NA      NA       NA
V993               NA         NA      NA       NA
V994               NA         NA      NA       NA
V995               NA         NA      NA       NA
V996               NA         NA      NA       NA
V997               NA         NA      NA       NA
V998               NA         NA      NA       NA
V999               NA         NA      NA       NA
V1000              NA         NA      NA       NA
V1001              NA         NA      NA       NA

Residual standard error: NaN on 0 degrees of freedom
Multiple R-squared:      1, Adjusted R-squared:    NaN 
F-statistic:   NaN on 499 and 0 DF,  p-value: NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href=""></a><span class="fu">coef</span>(final_model_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)            V2            V3            V4            V5 
-0.0544255730  2.6099907994  1.7117610885 -2.1815697118 -0.2422803070 
           V6            V7            V8            V9           V10 
-1.8205290449  1.0355680617  0.4929995117 -0.1408038660 -2.5320740520 
          V11           V12           V13           V14           V15 
-0.3231598476  4.3896008105 -3.1996475597 -1.3117706590  1.2335134001 
          V16           V17           V18           V19           V20 
-1.7503310496  2.0066893425  3.7394042352  0.7523641929 -0.3977609869 
          V21           V22           V23           V24           V25 
-0.7317315921 -1.7294524895 -1.4894628400 -0.1512708304 -0.8283179033 
          V26           V27           V28           V29           V30 
 1.2258116627  0.0504323555 -1.3817360034  0.0089840505 -2.3711588323 
          V31           V32           V33           V34           V35 
 0.8507333203 -0.3241024152  0.9081119820 -2.3925978033 -0.2837708266 
          V36           V37           V38           V39           V40 
 0.7810473765 -0.7390997043  0.1364142119 -0.4166420730 -0.7884367778 
          V41           V42           V43           V44           V45 
-0.2960032353  0.8704373097  1.3288296859 -0.8443770954  0.2492646875 
          V46           V47           V48           V49           V50 
-1.8094370596 -1.7080096115 -2.1896278196 -0.8253922167  0.6877574261 
          V51           V52           V53           V54           V55 
 1.7506767125 -0.3610083327  1.2554890138 -0.4729847416  2.7760516737 
          V56           V57           V58           V59           V60 
 2.5845391652  1.4054349926  2.6462708720  0.3486070708  0.2977714406 
          V61           V62           V63           V64           V65 
-1.6653696282 -1.3685045135 -1.6716296407 -1.0812655881 -0.1441445173 
          V66           V67           V68           V69           V70 
 0.6140107894 -0.1862542870  1.2245919838 -1.7394545084  0.7277588291 
          V71           V72           V73           V74           V75 
-1.6158522226 -0.5994681622 -0.4738725534  0.1674121970  0.9629153832 
          V76           V77           V78           V79           V80 
 1.3051479884 -2.1974422621 -0.9157517854 -0.0515250214 -1.3629254505 
          V81           V82           V83           V84           V85 
-1.6230415234  0.4117714232 -0.8753983661  3.4810714706  0.3394007861 
          V86           V87           V88           V89           V90 
-0.3552326691  1.0138774781  0.6451932522 -1.0018760116 -0.4052962675 
          V91           V92           V93           V94           V95 
-0.4852541971 -0.7866648431 -1.3298688155  1.5652092870  0.5819843959 
          V96           V97           V98           V99          V100 
-0.9651917294  2.0951724752 -0.2611368963  0.2818363763 -1.2282400811 
         V101          V102          V103          V104          V105 
 2.5623165169  2.9664739013 -3.6953958130 -0.3928639827 -0.1340906325 
         V106          V107          V108          V109          V110 
 1.2741626108  0.0576400863  0.6462098627 -0.6003130957 -0.7428606821 
         V111          V112          V113          V114          V115 
 3.0678360625  1.6925039620 -0.3444867903 -0.9621966164 -1.6940683170 
         V116          V117          V118          V119          V120 
-0.1994119312 -0.4443814042  2.4809007877  0.0242861711  0.0005580126 
         V121          V122          V123          V124          V125 
 1.2692716547 -1.1164778177  2.0240663590 -1.7258515289 -0.2594957248 
         V126          V127          V128          V129          V130 
 1.9472663453  1.1291834257  1.5751812732 -0.6218026602 -3.8054780721 
         V131          V132          V133          V134          V135 
-2.1721235886  1.6267517461  0.0501164155  0.4795611063  0.2441645205 
         V136          V137          V138          V139          V140 
-1.3833908021  2.7049340995  0.2738709497 -1.2137234867  0.1308181941 
         V141          V142          V143          V144          V145 
 0.3064077475 -4.3651257943  2.6365676793 -0.1764997196  0.9320041897 
         V146          V147          V148          V149          V150 
 0.0805178524 -3.5162571636 -2.5734758842  1.0165803937 -0.5792958221 
         V151          V152          V153          V154          V155 
-1.9659278038  1.1664262342  0.2759640751 -0.3333344962 -0.5881545219 
         V156          V157          V158          V159          V160 
 1.1792363972  0.8687879015 -4.5531262862 -0.1059812169 -0.2361057706 
         V161          V162          V163          V164          V165 
 2.0249219000  0.3855506056 -2.7593668061 -1.9250973615 -3.0026348061 
         V166          V167          V168          V169          V170 
-2.8420497112 -2.1290104552 -0.1939030020 -2.2027023458 -0.4621798243 
         V171          V172          V173          V174          V175 
 1.6610114121  0.2238739349 -0.2345684178  3.2008067854  1.4119149535 
         V176          V177          V178          V179          V180 
-0.6217828215 -0.6580785857 -1.8947654554  0.2984781448  0.0055276134 
         V181          V182          V183          V184          V185 
-0.4883037703 -0.5583140593  0.1031785612 -1.6739300080 -0.4557453240 
         V186          V187          V188          V189          V190 
 0.2627492093  0.1463357156 -0.6163192334  0.8873471896 -2.0744323572 
         V191          V192          V193          V194          V195 
 3.0827083279  0.7089822725 -1.7340720742 -0.6246222643 -2.5452457527 
         V196          V197          V198          V199          V200 
-0.2685479916 -0.8804444655  0.2494614374  2.6577953881  0.1711016097 
         V201          V202          V203          V204          V205 
-1.1545271299  0.7094589982 -0.4378271797 -1.6954148872 -0.0422225803 
         V206          V207          V208          V209          V210 
-0.1285257829 -0.2659421592 -1.4216047869  2.0146241640 -4.2336976216 
         V211          V212          V213          V214          V215 
-2.3439606842 -1.2866527298  0.5555878190  0.4314458701  4.7139125601 
         V216          V217          V218          V219          V220 
 0.1078366169  1.0830739905 -0.0537090254  1.2322381371 -0.4017532989 
         V221          V222          V223          V224          V225 
-0.9364959550 -0.9651367166  0.9810619139 -0.4194647147  2.0909838564 
         V226          V227          V228          V229          V230 
-0.0035268742  1.3114857836  0.0953776836  4.0702068555  0.7520093604 
         V231          V232          V233          V234          V235 
 0.9042443244 -2.0760511325  0.7715019535 -2.4983401589 -2.7747711316 
         V236          V237          V238          V239          V240 
 0.5693737832 -2.6646189258 -3.4287512705  0.6472359302 -0.3539146356 
         V241          V242          V243          V244          V245 
-0.9650842649  2.3227664942 -0.1988815619 -1.0652920616  0.3388830366 
         V246          V247          V248          V249          V250 
 0.0580744082  1.7447651197 -0.6464152273 -0.1642175211 -1.1383830775 
         V251          V252          V253          V254          V255 
 0.0631033374  2.4530509463 -0.0380968546 -0.9420048335  0.5062814295 
         V256          V257          V258          V259          V260 
 1.2864083801 -1.1687474458 -1.9367304546  0.1278671939  0.6506335389 
         V261          V262          V263          V264          V265 
 0.0956543333  1.4156561495 -1.1604076416 -0.5709907105  0.5557413840 
         V266          V267          V268          V269          V270 
-0.6305008539 -0.8221467178 -0.6592556057 -0.1370263882 -0.9903137043 
         V271          V272          V273          V274          V275 
 2.5862217088 -1.2884684292  0.1660966232  3.0771310978  1.0024699555 
         V276          V277          V278          V279          V280 
 0.7657963000  1.3370867481  0.2695523176 -0.0512256278 -0.9314547192 
         V281          V282          V283          V284          V285 
 1.2908036923 -1.1269804882 -0.2803801337  0.8439626059 -1.7167683734 
         V286          V287          V288          V289          V290 
-0.9470666954  1.3813787009  1.2061831712 -1.4685598394 -0.3149615584 
         V291          V292          V293          V294          V295 
-0.0579067008 -3.0725058039 -1.4348326741 -0.3349031343  0.6624321333 
         V296          V297          V298          V299          V300 
-1.6681171329  0.0603030224 -2.2849055645 -1.7394704979  0.1849417144 
         V301          V302          V303          V304          V305 
-2.4894095181  0.9605417467  1.3325386387  2.7248257916  3.3502259402 
         V306          V307          V308          V309          V310 
-0.5601993054 -0.6407177374  0.7683466319  0.1457889825  0.2299483305 
         V311          V312          V313          V314          V315 
 2.1162886025 -2.2500363883  1.6132572763 -0.9525996709  0.4631496932 
         V316          V317          V318          V319          V320 
 1.4068498246  0.1778479463  0.3338692156 -1.2838423310  0.2331848261 
         V321          V322          V323          V324          V325 
 1.0553496528  1.7762943084  0.6566497663 -0.2825266404 -0.8713016192 
         V326          V327          V328          V329          V330 
 0.6496307696 -1.6683450447 -0.6152235449  1.5030564263  0.8131347742 
         V331          V332          V333          V334          V335 
 1.2679319548 -1.8426725044 -2.1593612881  0.7937573625 -0.7531345557 
         V336          V337          V338          V339          V340 
 2.1638787972 -0.2166623892 -1.0634993026 -2.1899404533  2.3232940132 
         V341          V342          V343          V344          V345 
 0.7378922791 -1.0453083283 -1.1527480249 -0.2624279492 -1.3578808204 
         V346          V347          V348          V349          V350 
-0.2823784067  0.7882400300  1.9728090569  1.4168999217  1.2202213346 
         V351          V352          V353          V354          V355 
-0.2034937345  3.1847261793  1.4366981177 -0.0285499938  1.3356058682 
         V356          V357          V358          V359          V360 
-2.1803814302  1.5704319080  0.3952452306  1.0351647430 -0.4967877557 
         V361          V362          V363          V364          V365 
 1.0109836828 -1.0035200537  0.9116728468 -1.2845232171 -3.1054874044 
         V366          V367          V368          V369          V370 
 0.5183052789  1.5499286829 -3.9995315889 -0.0284877800  1.9103822702 
         V371          V372          V373          V374          V375 
 0.3785238033  0.7018360556 -0.5364889919 -0.0931092444  0.5309830003 
         V376          V377          V378          V379          V380 
 0.7963702950 -0.0722697676  2.2666855014 -0.7420764075 -1.0352002702 
         V381          V382          V383          V384          V385 
-0.0859044761 -1.9338434365  1.3656048046 -0.8675405411  1.9818056236 
         V386          V387          V388          V389          V390 
-0.1341212095 -1.3947518781 -1.1889849320 -0.6472572690  0.9824917868 
         V391          V392          V393          V394          V395 
 1.3948758203  1.5123235464 -0.7102767156  0.2187574688  1.8728417225 
         V396          V397          V398          V399          V400 
-0.9253537499 -1.7627177018  1.3708003133 -1.4765963012 -0.7378731101 
         V401          V402          V403          V404          V405 
-0.8240847944 -0.8998273733 -0.6238486853 -0.7004260410 -1.1154063750 
         V406          V407          V408          V409          V410 
 0.5642227964 -1.4769547287 -0.0051187586  0.7876825190  1.4921061669 
         V411          V412          V413          V414          V415 
 0.8141649699 -2.4657363750 -0.0104252870  3.4595001763 -1.5916646148 
         V416          V417          V418          V419          V420 
-1.2773980244  1.4557454392 -0.7268741556  2.0008738945 -0.5209113785 
         V421          V422          V423          V424          V425 
 0.6701507331  1.0035734985  0.3844289552  0.3126356133  0.7524813804 
         V426          V427          V428          V429          V430 
-1.9849838291 -0.4284443965  0.0656252785 -1.4651305840  0.8642707964 
         V431          V432          V433          V434          V435 
-1.3629531970  0.2262135709 -0.6429958537 -2.4808668117  0.3409449650 
         V436          V437          V438          V439          V440 
 1.2199598845  3.7716292594  0.0638399813 -1.3203685492 -0.9125732998 
         V441          V442          V443          V444          V445 
 0.1544876553  0.3064979711  0.9779913955  0.1552822654  0.8377699867 
         V446          V447          V448          V449          V450 
-1.3114340969  0.6167861817  0.6836913831 -0.9230836480  0.6275481160 
         V451          V452          V453          V454          V455 
 2.2479565278  3.6457542090 -1.9432840058  0.4433780309  1.2185694714 
         V456          V457          V458          V459          V460 
 1.6034844874 -0.9355728421  1.1573568848  3.0498127051  1.2190523570 
         V461          V462          V463          V464          V465 
-3.0151931703  1.3254289403 -0.4328569553  1.8112909734 -1.1366825973 
         V466          V467          V468          V469          V470 
-1.6229687108 -0.7072597222 -0.1955992124 -1.6140356858 -0.3535824013 
         V471          V472          V473          V474          V475 
-2.0988997636 -0.8335992610  1.6330474029 -0.9369116246  2.4504591086 
         V476          V477          V478          V479          V480 
 1.0269206642 -0.5607067275 -0.6387427164 -1.2650827577  2.7711825883 
         V481          V482          V483          V484          V485 
-0.0119784505 -0.2450241846  1.0082628827 -1.5348606414  0.6363602533 
         V486          V487          V488          V489          V490 
-0.1579602080  2.2377375247  0.9283484227  1.3192644211 -0.7271680712 
         V491          V492          V493          V494          V495 
 0.2363061340 -0.7624281651  1.9330673754  1.2736565138  2.1155328907 
         V496          V497          V498          V499          V500 
 0.7991970551  1.8104915315  0.4573737128  0.6399554903  1.8999937069 
         V501          V502          V503          V504          V505 
           NA            NA            NA            NA            NA 
         V506          V507          V508          V509          V510 
           NA            NA            NA            NA            NA 
         V511          V512          V513          V514          V515 
           NA            NA            NA            NA            NA 
         V516          V517          V518          V519          V520 
           NA            NA            NA            NA            NA 
         V521          V522          V523          V524          V525 
           NA            NA            NA            NA            NA 
         V526          V527          V528          V529          V530 
           NA            NA            NA            NA            NA 
         V531          V532          V533          V534          V535 
           NA            NA            NA            NA            NA 
         V536          V537          V538          V539          V540 
           NA            NA            NA            NA            NA 
         V541          V542          V543          V544          V545 
           NA            NA            NA            NA            NA 
         V546          V547          V548          V549          V550 
           NA            NA            NA            NA            NA 
         V551          V552          V553          V554          V555 
           NA            NA            NA            NA            NA 
         V556          V557          V558          V559          V560 
           NA            NA            NA            NA            NA 
         V561          V562          V563          V564          V565 
           NA            NA            NA            NA            NA 
         V566          V567          V568          V569          V570 
           NA            NA            NA            NA            NA 
         V571          V572          V573          V574          V575 
           NA            NA            NA            NA            NA 
         V576          V577          V578          V579          V580 
           NA            NA            NA            NA            NA 
         V581          V582          V583          V584          V585 
           NA            NA            NA            NA            NA 
         V586          V587          V588          V589          V590 
           NA            NA            NA            NA            NA 
         V591          V592          V593          V594          V595 
           NA            NA            NA            NA            NA 
         V596          V597          V598          V599          V600 
           NA            NA            NA            NA            NA 
         V601          V602          V603          V604          V605 
           NA            NA            NA            NA            NA 
         V606          V607          V608          V609          V610 
           NA            NA            NA            NA            NA 
         V611          V612          V613          V614          V615 
           NA            NA            NA            NA            NA 
         V616          V617          V618          V619          V620 
           NA            NA            NA            NA            NA 
         V621          V622          V623          V624          V625 
           NA            NA            NA            NA            NA 
         V626          V627          V628          V629          V630 
           NA            NA            NA            NA            NA 
         V631          V632          V633          V634          V635 
           NA            NA            NA            NA            NA 
         V636          V637          V638          V639          V640 
           NA            NA            NA            NA            NA 
         V641          V642          V643          V644          V645 
           NA            NA            NA            NA            NA 
         V646          V647          V648          V649          V650 
           NA            NA            NA            NA            NA 
         V651          V652          V653          V654          V655 
           NA            NA            NA            NA            NA 
         V656          V657          V658          V659          V660 
           NA            NA            NA            NA            NA 
         V661          V662          V663          V664          V665 
           NA            NA            NA            NA            NA 
         V666          V667          V668          V669          V670 
           NA            NA            NA            NA            NA 
         V671          V672          V673          V674          V675 
           NA            NA            NA            NA            NA 
         V676          V677          V678          V679          V680 
           NA            NA            NA            NA            NA 
         V681          V682          V683          V684          V685 
           NA            NA            NA            NA            NA 
         V686          V687          V688          V689          V690 
           NA            NA            NA            NA            NA 
         V691          V692          V693          V694          V695 
           NA            NA            NA            NA            NA 
         V696          V697          V698          V699          V700 
           NA            NA            NA            NA            NA 
         V701          V702          V703          V704          V705 
           NA            NA            NA            NA            NA 
         V706          V707          V708          V709          V710 
           NA            NA            NA            NA            NA 
         V711          V712          V713          V714          V715 
           NA            NA            NA            NA            NA 
         V716          V717          V718          V719          V720 
           NA            NA            NA            NA            NA 
         V721          V722          V723          V724          V725 
           NA            NA            NA            NA            NA 
         V726          V727          V728          V729          V730 
           NA            NA            NA            NA            NA 
         V731          V732          V733          V734          V735 
           NA            NA            NA            NA            NA 
         V736          V737          V738          V739          V740 
           NA            NA            NA            NA            NA 
         V741          V742          V743          V744          V745 
           NA            NA            NA            NA            NA 
         V746          V747          V748          V749          V750 
           NA            NA            NA            NA            NA 
         V751          V752          V753          V754          V755 
           NA            NA            NA            NA            NA 
         V756          V757          V758          V759          V760 
           NA            NA            NA            NA            NA 
         V761          V762          V763          V764          V765 
           NA            NA            NA            NA            NA 
         V766          V767          V768          V769          V770 
           NA            NA            NA            NA            NA 
         V771          V772          V773          V774          V775 
           NA            NA            NA            NA            NA 
         V776          V777          V778          V779          V780 
           NA            NA            NA            NA            NA 
         V781          V782          V783          V784          V785 
           NA            NA            NA            NA            NA 
         V786          V787          V788          V789          V790 
           NA            NA            NA            NA            NA 
         V791          V792          V793          V794          V795 
           NA            NA            NA            NA            NA 
         V796          V797          V798          V799          V800 
           NA            NA            NA            NA            NA 
         V801          V802          V803          V804          V805 
           NA            NA            NA            NA            NA 
         V806          V807          V808          V809          V810 
           NA            NA            NA            NA            NA 
         V811          V812          V813          V814          V815 
           NA            NA            NA            NA            NA 
         V816          V817          V818          V819          V820 
           NA            NA            NA            NA            NA 
         V821          V822          V823          V824          V825 
           NA            NA            NA            NA            NA 
         V826          V827          V828          V829          V830 
           NA            NA            NA            NA            NA 
         V831          V832          V833          V834          V835 
           NA            NA            NA            NA            NA 
         V836          V837          V838          V839          V840 
           NA            NA            NA            NA            NA 
         V841          V842          V843          V844          V845 
           NA            NA            NA            NA            NA 
         V846          V847          V848          V849          V850 
           NA            NA            NA            NA            NA 
         V851          V852          V853          V854          V855 
           NA            NA            NA            NA            NA 
         V856          V857          V858          V859          V860 
           NA            NA            NA            NA            NA 
         V861          V862          V863          V864          V865 
           NA            NA            NA            NA            NA 
         V866          V867          V868          V869          V870 
           NA            NA            NA            NA            NA 
         V871          V872          V873          V874          V875 
           NA            NA            NA            NA            NA 
         V876          V877          V878          V879          V880 
           NA            NA            NA            NA            NA 
         V881          V882          V883          V884          V885 
           NA            NA            NA            NA            NA 
         V886          V887          V888          V889          V890 
           NA            NA            NA            NA            NA 
         V891          V892          V893          V894          V895 
           NA            NA            NA            NA            NA 
         V896          V897          V898          V899          V900 
           NA            NA            NA            NA            NA 
         V901          V902          V903          V904          V905 
           NA            NA            NA            NA            NA 
         V906          V907          V908          V909          V910 
           NA            NA            NA            NA            NA 
         V911          V912          V913          V914          V915 
           NA            NA            NA            NA            NA 
         V916          V917          V918          V919          V920 
           NA            NA            NA            NA            NA 
         V921          V922          V923          V924          V925 
           NA            NA            NA            NA            NA 
         V926          V927          V928          V929          V930 
           NA            NA            NA            NA            NA 
         V931          V932          V933          V934          V935 
           NA            NA            NA            NA            NA 
         V936          V937          V938          V939          V940 
           NA            NA            NA            NA            NA 
         V941          V942          V943          V944          V945 
           NA            NA            NA            NA            NA 
         V946          V947          V948          V949          V950 
           NA            NA            NA            NA            NA 
         V951          V952          V953          V954          V955 
           NA            NA            NA            NA            NA 
         V956          V957          V958          V959          V960 
           NA            NA            NA            NA            NA 
         V961          V962          V963          V964          V965 
           NA            NA            NA            NA            NA 
         V966          V967          V968          V969          V970 
           NA            NA            NA            NA            NA 
         V971          V972          V973          V974          V975 
           NA            NA            NA            NA            NA 
         V976          V977          V978          V979          V980 
           NA            NA            NA            NA            NA 
         V981          V982          V983          V984          V985 
           NA            NA            NA            NA            NA 
         V986          V987          V988          V989          V990 
           NA            NA            NA            NA            NA 
         V991          V992          V993          V994          V995 
           NA            NA            NA            NA            NA 
         V996          V997          V998          V999         V1000 
           NA            NA            NA            NA            NA 
        V1001 
           NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a><span class="fu">coef</span>(final_model_lasso)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>501 x 1 sparse Matrix of class "dgCMatrix"
                       s0
(Intercept) -0.0050310072
V1           .           
V2           0.0677573109
V3           .           
V4           .           
V5           .           
V6           .           
V7           0.0405043026
V8           .           
V9           .           
V10          .           
V11          .           
V12          .           
V13          .           
V14          .           
V15          .           
V16          0.0071478927
V17          .           
V18          .           
V19          .           
V20          .           
V21          .           
V22          0.0025785057
V23          .           
V24          .           
V25          .           
V26          .           
V27          .           
V28          .           
V29          .           
V30          .           
V31          .           
V32          .           
V33          .           
V34          0.0092682626
V35          .           
V36          .           
V37          .           
V38          .           
V39          .           
V40          .           
V41          .           
V42          .           
V43          .           
V44          .           
V45          .           
V46          .           
V47          .           
V48          .           
V49          .           
V50          .           
V51          .           
V52          .           
V53          .           
V54          .           
V55          0.0058268241
V56          .           
V57          .           
V58          .           
V59          0.0252591346
V60          .           
V61          .           
V62          0.0052966857
V63          .           
V64          .           
V65          .           
V66          .           
V67          .           
V68          .           
V69          .           
V70          .           
V71          .           
V72          .           
V73          .           
V74          .           
V75          .           
V76          .           
V77          .           
V78          .           
V79          0.0075705216
V80          .           
V81          .           
V82          .           
V83          .           
V84          0.0044507658
V85          .           
V86          0.0276866706
V87          .           
V88          .           
V89          .           
V90          .           
V91          .           
V92          .           
V93          .           
V94          .           
V95          .           
V96          .           
V97          0.0247389687
V98          .           
V99          .           
V100         .           
V101         .           
V102         .           
V103         .           
V104         .           
V105         .           
V106         .           
V107         .           
V108         .           
V109         0.0125067786
V110         0.0014145525
V111         .           
V112         .           
V113         .           
V114         .           
V115         .           
V116         .           
V117         .           
V118         .           
V119         .           
V120         .           
V121         .           
V122         .           
V123         .           
V124         .           
V125         .           
V126         .           
V127         .           
V128         .           
V129         .           
V130         .           
V131         .           
V132         .           
V133         .           
V134         .           
V135         .           
V136         .           
V137         .           
V138         0.0233230524
V139         .           
V140         .           
V141         .           
V142         .           
V143         .           
V144         .           
V145         .           
V146         .           
V147         0.0267189057
V148         .           
V149         .           
V150         .           
V151         .           
V152         .           
V153         .           
V154         .           
V155         .           
V156         .           
V157         .           
V158         .           
V159         .           
V160         .           
V161         .           
V162         .           
V163         .           
V164         .           
V165         .           
V166         0.0152478767
V167         .           
V168         .           
V169         0.0042556279
V170         .           
V171         .           
V172         .           
V173         .           
V174         .           
V175         .           
V176         .           
V177         .           
V178         .           
V179         .           
V180         .           
V181         .           
V182         .           
V183         .           
V184         .           
V185         .           
V186         .           
V187         .           
V188         .           
V189         .           
V190         .           
V191         .           
V192         .           
V193         .           
V194         .           
V195         .           
V196         .           
V197         .           
V198         .           
V199         .           
V200         .           
V201         .           
V202         .           
V203         .           
V204         .           
V205         .           
V206         .           
V207         .           
V208         .           
V209         .           
V210         .           
V211         .           
V212         .           
V213         .           
V214         .           
V215         .           
V216         .           
V217         .           
V218         .           
V219         .           
V220         .           
V221         .           
V222         .           
V223         .           
V224         .           
V225         .           
V226         0.0323779033
V227         .           
V228         0.0295057318
V229         .           
V230         .           
V231         0.0584864059
V232         .           
V233         .           
V234         .           
V235         .           
V236         0.0279947757
V237         .           
V238         .           
V239         .           
V240         .           
V241         .           
V242         .           
V243         .           
V244         .           
V245         .           
V246         .           
V247         .           
V248         .           
V249         .           
V250         .           
V251         .           
V252         .           
V253         .           
V254         .           
V255         .           
V256         .           
V257         .           
V258         .           
V259         .           
V260         .           
V261         .           
V262         .           
V263         .           
V264         .           
V265         .           
V266         .           
V267         .           
V268         .           
V269         .           
V270         .           
V271         .           
V272         .           
V273         .           
V274         .           
V275         .           
V276         .           
V277         .           
V278         .           
V279         .           
V280         .           
V281         .           
V282         .           
V283         .           
V284         .           
V285         0.0055894112
V286         .           
V287         .           
V288         .           
V289         .           
V290         .           
V291         .           
V292         .           
V293         .           
V294         .           
V295         .           
V296         .           
V297         0.0024685289
V298         .           
V299         .           
V300         .           
V301         .           
V302         .           
V303         .           
V304         .           
V305         .           
V306         .           
V307         0.0059672873
V308         0.0180837654
V309         0.0025068600
V310         0.0128373323
V311         .           
V312         0.0107269227
V313         .           
V314         .           
V315         .           
V316         .           
V317         .           
V318         .           
V319         0.0009438705
V320         .           
V321         .           
V322         .           
V323         .           
V324         .           
V325         .           
V326         .           
V327         .           
V328         .           
V329         .           
V330         .           
V331         .           
V332         .           
V333         .           
V334         .           
V335         0.0027604933
V336         .           
V337         0.0714418388
V338         .           
V339         .           
V340         .           
V341         .           
V342         .           
V343         .           
V344         .           
V345         .           
V346         .           
V347         .           
V348         .           
V349         .           
V350         .           
V351         0.0093329758
V352         .           
V353         .           
V354         .           
V355         .           
V356         .           
V357         .           
V358         .           
V359         .           
V360         .           
V361         0.0450918804
V362         .           
V363         .           
V364         .           
V365         .           
V366         .           
V367         .           
V368         .           
V369         .           
V370         .           
V371         .           
V372         0.0015549349
V373         .           
V374         .           
V375         .           
V376         .           
V377         .           
V378         .           
V379         .           
V380         .           
V381         .           
V382         .           
V383         .           
V384         .           
V385         .           
V386         0.0204770940
V387         .           
V388         .           
V389         .           
V390         .           
V391         .           
V392         .           
V393         .           
V394         .           
V395         .           
V396         .           
V397         .           
V398         .           
V399         .           
V400         .           
V401         .           
V402         .           
V403         .           
V404         .           
V405         .           
V406         0.0193115758
V407         0.0097231567
V408         .           
V409         .           
V410         .           
V411         .           
V412         .           
V413         .           
V414         .           
V415         .           
V416         .           
V417         .           
V418         .           
V419         .           
V420         .           
V421         .           
V422         .           
V423         .           
V424         0.0751245130
V425         0.0039513488
V426         0.0066260865
V427         .           
V428         .           
V429         .           
V430         .           
V431         .           
V432         0.0165860297
V433         .           
V434         .           
V435         .           
V436         .           
V437         .           
V438         .           
V439         .           
V440         .           
V441         .           
V442         .           
V443         .           
V444         .           
V445         .           
V446         .           
V447         .           
V448         .           
V449         .           
V450         .           
V451         .           
V452         0.0094541308
V453         .           
V454         .           
V455         .           
V456         .           
V457         .           
V458         .           
V459         .           
V460         .           
V461         .           
V462         .           
V463         .           
V464         .           
V465         0.0078533529
V466         .           
V467         .           
V468         .           
V469         .           
V470         .           
V471         .           
V472         .           
V473         .           
V474         .           
V475         0.0258012071
V476         .           
V477         .           
V478         .           
V479         0.0404612974
V480         .           
V481         0.0335870839
V482         .           
V483         .           
V484         .           
V485         0.0156479186
V486         .           
V487         .           
V488         .           
V489         .           
V490         .           
V491         .           
V492         0.0232223984
V493         .           
V494         .           
V495         .           
V496         .           
V497         .           
V498         .           
V499         .           
V500         .           </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href=""></a><span class="fu">coef</span>(final_model_ridge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>501 x 1 sparse Matrix of class "dgCMatrix"
                       s0
(Intercept)  4.547073e-04
V1           1.326049e-04
V2           3.336735e-03
V3           1.944900e-04
V4           8.449713e-04
V5           1.773232e-03
V6           5.667092e-05
V7           2.864459e-03
V8           5.923894e-04
V9           1.171759e-03
V10          1.579297e-03
V11          1.587231e-03
V12          1.540517e-03
V13          5.874298e-04
V14          1.251767e-03
V15          4.291946e-04
V16          2.157782e-03
V17          1.561050e-03
V18          1.446854e-03
V19          8.477150e-04
V20          7.972290e-04
V21          9.400663e-04
V22          1.955837e-03
V23          4.579487e-04
V24          1.764214e-03
V25          1.179527e-03
V26          8.242880e-04
V27          1.264488e-03
V28          1.787985e-04
V29          7.020843e-04
V30          9.209553e-04
V31          1.202890e-03
V32          1.460668e-03
V33          1.611798e-03
V34          2.258043e-03
V35          1.166047e-03
V36          1.175425e-03
V37          1.180339e-03
V38          4.553564e-04
V39         -2.581935e-05
V40          4.367994e-04
V41          7.144313e-04
V42          1.955932e-03
V43         -3.538678e-04
V44          5.500643e-04
V45          1.670697e-03
V46          9.713469e-04
V47          1.674482e-03
V48          5.117786e-06
V49          1.529339e-03
V50          1.126897e-03
V51          6.036882e-04
V52          1.506854e-03
V53          7.845597e-04
V54          1.698891e-03
V55          2.158998e-03
V56          1.792811e-03
V57          7.250602e-04
V58          1.369593e-03
V59          2.330085e-03
V60          1.182883e-03
V61          3.196468e-04
V62          2.166096e-03
V63          9.806193e-04
V64          1.832173e-03
V65          9.770683e-04
V66          8.046126e-04
V67          7.511049e-04
V68          7.153326e-04
V69          1.796753e-03
V70          1.059451e-03
V71          1.005638e-03
V72          1.578798e-03
V73          1.103163e-03
V74          1.611293e-03
V75          1.763382e-03
V76          1.089660e-03
V77          4.217057e-04
V78          1.831179e-03
V79          2.289067e-03
V80          1.516832e-03
V81          7.488347e-04
V82          6.390880e-04
V83          1.373111e-03
V84          2.076040e-03
V85          1.038608e-03
V86          2.904121e-03
V87          1.216157e-03
V88          2.124125e-03
V89          7.550350e-04
V90          2.276315e-03
V91          2.200580e-03
V92          8.636799e-04
V93          1.685420e-03
V94          6.718277e-05
V95          1.656924e-03
V96          1.160527e-03
V97          2.869390e-03
V98          3.383211e-04
V99          7.283000e-04
V100         6.412493e-04
V101         3.455914e-04
V102         1.695059e-03
V103         1.386630e-03
V104         2.216956e-03
V105         1.445194e-03
V106         2.004865e-03
V107         9.605256e-04
V108        -5.372192e-05
V109         2.762605e-03
V110         2.667362e-03
V111         1.371576e-03
V112         2.265964e-03
V113         8.932280e-04
V114         1.977630e-03
V115         2.066570e-03
V116         1.735740e-03
V117         2.351072e-03
V118         2.122303e-03
V119         2.389471e-03
V120         8.260628e-04
V121         2.438702e-03
V122         2.193252e-03
V123         1.878619e-03
V124         1.099441e-03
V125         9.581400e-04
V126         1.733638e-03
V127         2.102994e-03
V128         2.179569e-03
V129         1.375121e-03
V130         2.555929e-03
V131         1.254336e-03
V132         2.186885e-03
V133         2.389954e-03
V134         2.603268e-03
V135         1.349307e-03
V136         7.702746e-04
V137         1.821985e-03
V138         3.301305e-03
V139         1.550611e-03
V140         1.141160e-03
V141         1.845472e-03
V142         1.908045e-03
V143         1.181466e-03
V144         3.147277e-03
V145         1.395210e-03
V146         2.691574e-03
V147         3.094484e-03
V148         2.278154e-03
V149         1.777764e-03
V150         2.337739e-03
V151         1.333515e-03
V152         1.953906e-03
V153         2.568168e-03
V154         2.106739e-03
V155         2.684213e-03
V156         9.833820e-04
V157         1.714385e-03
V158         4.254768e-04
V159         1.263059e-03
V160         2.493578e-03
V161         2.657444e-03
V162         5.605875e-04
V163         5.036825e-04
V164         1.640332e-03
V165         2.576595e-03
V166         3.456253e-03
V167         2.896539e-03
V168         1.689532e-03
V169         3.241421e-03
V170         2.440798e-03
V171         3.381742e-03
V172         2.773737e-03
V173         1.147812e-03
V174         1.576514e-03
V175         6.915451e-04
V176         7.468754e-04
V177         2.435299e-03
V178         2.394400e-03
V179         2.622137e-03
V180         2.165192e-03
V181         4.944127e-04
V182         1.629818e-03
V183         1.271724e-03
V184         2.957452e-03
V185         1.622911e-03
V186         2.181046e-03
V187         1.962046e-03
V188         2.552728e-03
V189         2.284049e-03
V190         2.162550e-03
V191         8.483751e-04
V192         2.900393e-03
V193         1.107932e-03
V194         2.804477e-03
V195         2.377905e-03
V196         2.520756e-03
V197         1.580762e-03
V198         2.126596e-03
V199         2.512546e-03
V200         2.048029e-03
V201         1.978864e-03
V202         2.188827e-03
V203         2.387286e-03
V204         2.751717e-03
V205         2.055206e-03
V206         3.013042e-03
V207         2.516278e-03
V208         3.046700e-03
V209         2.621945e-03
V210         3.297337e-03
V211         2.764493e-03
V212         2.733989e-03
V213         2.455758e-03
V214         1.943087e-03
V215         2.919898e-03
V216         3.334311e-03
V217         2.982440e-03
V218         2.271379e-03
V219         2.452900e-03
V220         3.564676e-03
V221         2.002657e-03
V222         3.230620e-03
V223         2.716674e-03
V224         2.265876e-03
V225         3.667210e-03
V226         4.391349e-03
V227         2.859076e-03
V228         4.271317e-03
V229         2.263600e-03
V230         2.659665e-03
V231         4.930838e-03
V232         2.674350e-03
V233         4.622954e-04
V234         2.168690e-03
V235         1.873045e-03
V236         4.256021e-03
V237         3.014289e-03
V238         2.670347e-03
V239         1.348357e-03
V240         1.910015e-03
V241         1.787510e-03
V242         2.431895e-03
V243         2.364756e-03
V244         1.615593e-03
V245         3.603958e-03
V246         2.194792e-03
V247         3.311660e-03
V248         3.018534e-03
V249         2.200635e-03
V250         2.533752e-03
V251         2.482382e-03
V252         3.890949e-03
V253         1.791807e-03
V254         1.730435e-03
V255         3.252082e-03
V256         3.219769e-03
V257         2.231240e-03
V258         2.896734e-03
V259         2.611729e-03
V260         2.744933e-03
V261         3.302415e-03
V262         3.731525e-03
V263         1.842652e-03
V264         3.142189e-03
V265         2.641546e-03
V266         3.023788e-03
V267         3.104039e-03
V268         1.643566e-03
V269         4.068648e-03
V270         2.786557e-03
V271         2.650488e-03
V272         2.576591e-03
V273         2.143137e-03
V274         3.234406e-03
V275         2.208805e-03
V276         3.366325e-03
V277         2.162900e-03
V278         3.210582e-03
V279         3.721890e-03
V280         3.548479e-03
V281         2.759295e-03
V282         1.320762e-03
V283         3.556918e-03
V284         1.260746e-03
V285         4.137725e-03
V286         1.217452e-03
V287         2.540309e-03
V288         3.050906e-03
V289         2.800646e-03
V290         2.510763e-03
V291         2.210281e-03
V292         2.762125e-03
V293         2.131576e-03
V294         2.075116e-03
V295         3.814656e-03
V296         2.993995e-03
V297         3.685559e-03
V298         1.708570e-03
V299         2.645182e-03
V300         2.246078e-03
V301         2.862065e-03
V302         1.726466e-03
V303         1.950492e-03
V304         1.024867e-03
V305         2.631785e-03
V306         2.451672e-03
V307         3.849423e-03
V308         4.137189e-03
V309         3.693902e-03
V310         3.908902e-03
V311         2.259815e-03
V312         3.857339e-03
V313         1.370665e-03
V314         2.500780e-03
V315         3.013775e-03
V316         3.052469e-03
V317         1.432483e-03
V318         2.906206e-03
V319         3.716204e-03
V320         1.964854e-03
V321         2.454273e-03
V322         3.976012e-04
V323         3.851464e-03
V324         2.735636e-03
V325         2.422399e-03
V326         2.844412e-03
V327         1.334734e-03
V328         2.188409e-03
V329         2.955045e-03
V330         2.201075e-03
V331         2.382620e-03
V332         3.396873e-03
V333         3.705015e-03
V334         2.482257e-03
V335         3.794258e-03
V336         3.285536e-03
V337         4.996610e-03
V338         2.257890e-03
V339         2.715784e-03
V340         2.807704e-03
V341         3.558984e-03
V342         2.191987e-03
V343         2.973977e-03
V344         2.359765e-03
V345         3.191657e-03
V346         1.804692e-03
V347         2.870808e-03
V348         2.952692e-03
V349         2.589773e-03
V350         1.962947e-03
V351         3.604634e-03
V352         3.571117e-03
V353         2.084840e-03
V354         3.361872e-03
V355         1.792033e-03
V356         3.119786e-03
V357         3.321766e-03
V358         2.731410e-03
V359         1.693331e-03
V360         1.512419e-03
V361         4.180789e-03
V362         1.716916e-03
V363         1.763249e-03
V364         8.752461e-04
V365         2.203537e-03
V366         2.157839e-03
V367         1.396513e-03
V368         2.185621e-03
V369         1.423600e-03
V370         2.413738e-03
V371         3.040317e-03
V372         3.102266e-03
V373         1.374897e-03
V374         2.725157e-03
V375         3.293618e-03
V376         2.232528e-03
V377         2.035365e-03
V378         1.922577e-03
V379         2.324231e-03
V380         2.181387e-03
V381         9.099605e-04
V382         2.208899e-03
V383         1.726155e-03
V384         2.504716e-03
V385         2.351860e-03
V386         3.540143e-03
V387         1.196953e-05
V388         2.076820e-03
V389         1.949372e-03
V390         2.438574e-03
V391         2.457866e-03
V392         1.911699e-03
V393         1.267261e-03
V394         2.511303e-03
V395         2.810702e-03
V396         7.209689e-04
V397         2.128595e-03
V398         1.787620e-03
V399         2.748062e-03
V400         8.645141e-04
V401         1.048584e-03
V402         1.518549e-03
V403         1.252501e-03
V404         2.552340e-03
V405         2.990997e-03
V406         3.144808e-03
V407         2.976268e-03
V408         2.308465e-03
V409         1.527621e-03
V410         9.947616e-04
V411         2.209755e-03
V412         2.038730e-03
V413         1.425300e-03
V414         2.077537e-03
V415         1.499921e-04
V416         1.997472e-03
V417         2.356967e-03
V418         9.237591e-04
V419         1.251714e-03
V420         1.358901e-03
V421         1.024566e-03
V422         1.310605e-03
V423         8.599005e-04
V424         3.819106e-03
V425         2.712231e-03
V426         2.605776e-03
V427         1.958621e-03
V428         1.611498e-03
V429         1.887573e-03
V430        -2.097268e-04
V431         2.407656e-03
V432         2.523816e-03
V433         1.935061e-04
V434         1.504919e-03
V435         1.432470e-03
V436         6.719491e-04
V437         1.330170e-03
V438         1.462393e-03
V439         1.571273e-03
V440         2.548363e-03
V441         1.616591e-03
V442         1.029458e-03
V443         2.637910e-03
V444         2.416090e-03
V445         2.356872e-04
V446         6.031409e-04
V447         1.465081e-03
V448         2.058010e-03
V449         7.690997e-04
V450         1.912149e-03
V451         8.724513e-05
V452         2.577927e-03
V453         1.692122e-03
V454         1.110352e-03
V455         2.018842e-03
V456         8.649337e-04
V457         1.242775e-03
V458         9.741183e-04
V459         1.519819e-03
V460         1.908765e-03
V461         1.255364e-03
V462         1.402088e-03
V463         7.164322e-04
V464         3.018809e-04
V465         2.649088e-03
V466         2.008765e-03
V467         5.021656e-04
V468         1.879558e-03
V469         1.462522e-03
V470         1.474909e-03
V471         1.247971e-03
V472         7.455338e-04
V473         2.184958e-04
V474         1.119185e-03
V475         2.802603e-03
V476         1.028620e-03
V477         1.695812e-03
V478         1.989553e-03
V479         2.937992e-03
V480         1.050460e-03
V481         2.891956e-03
V482         1.357958e-03
V483         9.346706e-04
V484         6.995366e-04
V485         2.901771e-03
V486         1.600177e-03
V487         1.572086e-03
V488         1.801284e-03
V489         7.441372e-04
V490         1.603239e-03
V491         2.109925e-03
V492         2.673668e-03
V493         1.091672e-03
V494         1.572141e-04
V495         1.696197e-03
V496         1.571274e-03
V497         1.987068e-03
V498         6.105113e-04
V499         1.051485e-03
V500         1.270413e-03</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Like with p = n, lm() fails to function, while ridge and lasso still produce models with very adequate R^2 (~70%, not adjusted). In addition, following the principle of parsimony, lasso is an excellent choice, as it has eliminated the majority of the unneccessary parameters.</p>
</section>
<section id="practical-applications-of-ridge-and-lasso-to-credit-data-islrv2-with-loocv" class="slide level2">
<h2>Practical applications of Ridge and Lasso to Credit data (ISLRv2) with LOOCV</h2>
<p>The ISLRv2 textbook includes the Credit dataset which is used to run a ridge and lasso regression. We can use glmnet and LOOCV to train a ridge and then a lasso model following the process.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href=""></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb46-2"><a href=""></a><span class="co"># Balance is our Y, everything else is X.</span></span>
<span id="cb46-3"><a href=""></a>credit_cleaned <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(Credit)</span>
<span id="cb46-4"><a href=""></a><span class="fu">head</span>(credit_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
  Income Limit Rating Cards   Age Education Own   Student Married Region Balance
   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;   &lt;fct&gt;   &lt;fct&gt;    &lt;dbl&gt;
1   14.9  3606    283     2    34        11 No    No      Yes     South      333
2  106.   6645    483     3    82        15 Yes   Yes     Yes     West       903
3  105.   7075    514     4    71        11 No    No      No      West       580
4  149.   9504    681     3    36        11 Yes   No      No      West       964
5   55.9  4897    357     2    68        16 No    No      Yes     South      331
6   80.2  8047    569     4    77        10 No    No      No      South     1151</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<h3 id="ridge-1">Ridge</h3>
<p>Step 1: Standardize the data (and convert categoricals to dummies, since glmnet() doesn’t work with factor)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href=""></a><span class="fu">library</span>(fastDummies)</span>
<span id="cb48-2"><a href=""></a>credit_cleaned <span class="ot">&lt;-</span> credit_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href=""></a>  <span class="co"># Don't standardize categoricals / response.</span></span>
<span id="cb48-4"><a href=""></a>  <span class="fu">select</span>(<span class="sc">-</span>Balance, <span class="sc">-</span>Own, <span class="sc">-</span>Student, <span class="sc">-</span>Married, <span class="sc">-</span>Region) <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href=""></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), scale)) <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">Balance =</span> Credit<span class="sc">$</span>Balance, <span class="at">Own =</span> Credit<span class="sc">$</span>Own, <span class="at">Student =</span> Credit<span class="sc">$</span>Student, <span class="at">Married =</span> Credit<span class="sc">$</span>Married, <span class="at">Region =</span> Credit<span class="sc">$</span>Region) <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href=""></a>  <span class="fu">dummy_cols</span>()</span>
<span id="cb48-8"><a href=""></a><span class="fu">head</span>(credit_cleaned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 20
  Income   Limit  Rating   Cards    Age Education Balance Own   Student Married
   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;   &lt;fct&gt;  
1 -0.861 -0.489  -0.465  -0.698  -1.26     -0.784     333 No    No      Yes    
2  1.73   0.827   0.828   0.0310  1.53      0.496     903 Yes   Yes     Yes    
3  1.68   1.01    1.03    0.760   0.889    -0.784     580 No    No      No     
4  2.94   2.07    2.11    0.0310 -1.14     -0.784     964 Yes   No      No     
5  0.303  0.0699  0.0133 -0.698   0.715     0.816     331 No    No      Yes    
6  0.992  1.43    1.38    0.760   1.24     -1.10     1151 No    No      No     
# ℹ 10 more variables: Region &lt;fct&gt;, Own_No &lt;int&gt;, Own_Yes &lt;int&gt;,
#   Student_No &lt;int&gt;, Student_Yes &lt;int&gt;, Married_No &lt;int&gt;, Married_Yes &lt;int&gt;,
#   Region_East &lt;int&gt;, Region_South &lt;int&gt;, Region_West &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Step 2: Define a set of <span class="math inline">\(\lambda\)</span> to test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href=""></a>lambdas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e-05</span>, <span class="fl">1e-04</span>, <span class="fl">1e-03</span>, <span class="fl">1e-02</span>, <span class="fl">1e-01</span>, <span class="dv">0</span>, <span class="fl">1e+01</span>, <span class="fl">1e+02</span>, <span class="fl">1e+03</span>, <span class="fl">1e+04</span>, <span class="fl">1e+05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>Step 3: Perform LOOCV for each lambda (train/test)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href=""></a><span class="fu">library</span>(glmnet)</span>
<span id="cb51-2"><a href=""></a>results <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(<span class="at">Lambda =</span> <span class="fu">numeric</span>(), <span class="at">CV =</span> <span class="fu">numeric</span>())</span>
<span id="cb51-3"><a href=""></a><span class="cf">for</span> (curr_lambda <span class="cf">in</span> lambdas) {</span>
<span id="cb51-4"><a href=""></a>  cross_validation_total <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb51-5"><a href=""></a>  </span>
<span id="cb51-6"><a href=""></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(credit_cleaned)) {</span>
<span id="cb51-7"><a href=""></a>    test_row <span class="ot">&lt;-</span> credit_cleaned[i,]</span>
<span id="cb51-8"><a href=""></a>    test_row_x <span class="ot">&lt;-</span> test_row[,<span class="sc">!</span><span class="fu">names</span>(test_row) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Balance"</span>)]</span>
<span id="cb51-9"><a href=""></a>    test_row_y <span class="ot">&lt;-</span> test_row[,<span class="fu">names</span>(test_row) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Balance"</span>)]</span>
<span id="cb51-10"><a href=""></a>    </span>
<span id="cb51-11"><a href=""></a>    train_rows <span class="ot">&lt;-</span> credit_cleaned[<span class="sc">-</span>i,]</span>
<span id="cb51-12"><a href=""></a>    train_rows_x <span class="ot">&lt;-</span> train_rows[,<span class="sc">!</span><span class="fu">names</span>(train_rows) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Balance"</span>)]</span>
<span id="cb51-13"><a href=""></a>    train_rows_y <span class="ot">&lt;-</span> train_rows[,<span class="fu">names</span>(train_rows) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Balance"</span>)]</span>
<span id="cb51-14"><a href=""></a>    </span>
<span id="cb51-15"><a href=""></a>    <span class="co"># Train gaussian model</span></span>
<span id="cb51-16"><a href=""></a>    single_model_ridge <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> train_rows_x, <span class="at">y =</span> <span class="fu">pull</span>(train_rows_y), <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> curr_lambda, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb51-17"><a href=""></a>    <span class="co"># Test the model</span></span>
<span id="cb51-18"><a href=""></a>    predict_result <span class="ot">&lt;-</span> <span class="fu">predict</span>(single_model_ridge, <span class="at">newx =</span> test_row_x)</span>
<span id="cb51-19"><a href=""></a>    <span class="co"># Calculate RSS</span></span>
<span id="cb51-20"><a href=""></a>    rss <span class="ot">&lt;-</span> (<span class="fu">pull</span>(test_row_y) <span class="sc">-</span> predict_result) <span class="sc">**</span> <span class="dv">2</span></span>
<span id="cb51-21"><a href=""></a>    cross_validation_total <span class="ot">&lt;-</span> <span class="fu">c</span>(cross_validation_total, rss)</span>
<span id="cb51-22"><a href=""></a>  }</span>
<span id="cb51-23"><a href=""></a>  </span>
<span id="cb51-24"><a href=""></a>  <span class="fu">stopifnot</span>(<span class="fu">length</span>(cross_validation_total)<span class="sc">==</span> <span class="fu">nrow</span>(credit_cleaned))</span>
<span id="cb51-25"><a href=""></a>  results <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> <span class="fu">add_row</span>(<span class="at">Lambda =</span> curr_lambda, <span class="at">CV =</span> <span class="fu">sum</span>(cross_validation_total) <span class="sc">/</span> <span class="fu">nrow</span>(credit_cleaned))</span>
<span id="cb51-26"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>Step 4: Choose the <span class="math inline">\(\lambda\)</span> that picks the lowest LOOCV value (i.e.&nbsp;residual)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href=""></a>results_log10 <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Lambda =</span> <span class="fu">ifelse</span>(Lambda <span class="sc">!=</span> <span class="dv">0</span>, <span class="fu">log10</span>(Lambda), Lambda))</span>
<span id="cb52-2"><a href=""></a><span class="fu">ggplot</span>(<span class="at">data =</span> results_log10, <span class="fu">aes</span>(<span class="at">x =</span> Lambda, <span class="at">y =</span> CV)) <span class="sc">+</span></span>
<span id="cb52-3"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(CV), <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Lambda (log_10)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RidgeAndLassoPresentation_files/figure-revealjs/unnamed-chunk-24-1.png" width="960" class="r-stretch"><p>Since a lambda of 0.1 is best in terms of CV, we pick that lambda.</p>
</section>
<section class="slide level2">

<p>Step 5: Refit the model using all of the available observations, and the selected tuning parameter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href=""></a>credit_cleaned_x <span class="ot">&lt;-</span> credit_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Balance))</span>
<span id="cb53-2"><a href=""></a>credit_cleaned_y <span class="ot">&lt;-</span> <span class="fu">pull</span>(credit_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(Balance)))</span>
<span id="cb53-3"><a href=""></a>final_model <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> credit_cleaned_x, <span class="at">y =</span> credit_cleaned_y, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> <span class="fl">0.1</span>, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href=""></a><span class="fu">print</span>(<span class="fu">coef</span>(linear_reg))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)       Income        Limit       Rating        Cards          Age 
  520.015000  -275.014651   440.650711   175.848092    24.305139   -10.589809 
   Education       Own_No      Own_Yes   Student_No  Student_Yes   Married_No 
   -3.434150     5.330027           NA  -127.884163           NA     4.162747 
 Married_Yes  Region_East Region_South  Region_West       OwnYes   StudentYes 
          NA    -7.261088    -3.352729           NA           NA           NA 
  MarriedYes  RegionSouth   RegionWest 
          NA           NA           NA </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href=""></a><span class="fu">print</span>(<span class="fu">coef</span>(final_model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>20 x 1 sparse Matrix of class "dgCMatrix"
                        s0
(Intercept)   107.33765525
Income       -274.81618666
Limit         458.81474757
Rating        157.49599137
Cards          25.09455862
Age           -10.58781739
Education      -3.52479939
Own             2.17795724
Student       391.96929750
Married        -8.13392472
Region          7.77093016
Own_No         11.76410078
Own_Yes        -1.05097089
Student_No    -32.75317118
Student_Yes     1.38898803
Married_No      0.09076262
Married_Yes    -0.04196250
Region_East    -1.50193444
Region_South    0.81617050
Region_West    -0.45196771</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href=""></a><span class="fu">print</span>(<span class="fu">summary</span>(linear_reg)<span class="sc">$</span>adj.r.squared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9538287</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href=""></a>final_model_ridge_r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ((<span class="dv">1</span> <span class="sc">-</span> final_model<span class="sc">$</span>dev.ratio)<span class="sc">*</span>(<span class="fu">nrow</span>(credit_cleaned) <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span> (<span class="fu">nrow</span>(credit_cleaned) <span class="sc">-</span> <span class="fu">ncol</span>(credit_cleaned_x) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb60-2"><a href=""></a><span class="fu">print</span>(final_model_ridge_r2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9528495</code></pre>
</div>
</div>
<p>We can compare the <span class="math inline">\(R^2\)</span> values of both models; they are more or less identical in this scenario (which is reasonable, given that it appears a more aggressive penalty actually raises variance (RSS) for this scenario), which means ridge has minimal effect.</p>
<p>Next, we can try lasso regression with a similar setup:</p>
</section>
<section class="slide level2">

<h3 id="lasso-1">Lasso</h3>
<p>Step 1, 2, 3:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href=""></a><span class="fu">library</span>(glmnet)</span>
<span id="cb62-2"><a href=""></a>results <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(<span class="at">Lambda =</span> <span class="fu">numeric</span>(), <span class="at">CV =</span> <span class="fu">numeric</span>())</span>
<span id="cb62-3"><a href=""></a><span class="cf">for</span> (curr_lambda <span class="cf">in</span> lambdas) {</span>
<span id="cb62-4"><a href=""></a>  cross_validation_total <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb62-5"><a href=""></a>  </span>
<span id="cb62-6"><a href=""></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(credit_cleaned)) {</span>
<span id="cb62-7"><a href=""></a>    test_row <span class="ot">&lt;-</span> credit_cleaned[i,]</span>
<span id="cb62-8"><a href=""></a>    test_row_x <span class="ot">&lt;-</span> test_row[,<span class="sc">!</span><span class="fu">names</span>(test_row) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Balance"</span>)]</span>
<span id="cb62-9"><a href=""></a>    test_row_y <span class="ot">&lt;-</span> test_row[,<span class="fu">names</span>(test_row) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Balance"</span>)]</span>
<span id="cb62-10"><a href=""></a>    </span>
<span id="cb62-11"><a href=""></a>    train_rows <span class="ot">&lt;-</span> credit_cleaned[<span class="sc">-</span>i,]</span>
<span id="cb62-12"><a href=""></a>    train_rows_x <span class="ot">&lt;-</span> train_rows[,<span class="sc">!</span><span class="fu">names</span>(train_rows) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Balance"</span>)]</span>
<span id="cb62-13"><a href=""></a>    train_rows_y <span class="ot">&lt;-</span> train_rows[,<span class="fu">names</span>(train_rows) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Balance"</span>)]</span>
<span id="cb62-14"><a href=""></a>    </span>
<span id="cb62-15"><a href=""></a>    <span class="co"># Train gaussian model</span></span>
<span id="cb62-16"><a href=""></a>    single_model_lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> train_rows_x, <span class="at">y =</span> <span class="fu">pull</span>(train_rows_y), <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> curr_lambda, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb62-17"><a href=""></a>    <span class="co"># Test the model</span></span>
<span id="cb62-18"><a href=""></a>    predict_result <span class="ot">&lt;-</span> <span class="fu">predict</span>(single_model_lasso, <span class="at">newx =</span> test_row_x)</span>
<span id="cb62-19"><a href=""></a>    <span class="co"># Calculate RSS</span></span>
<span id="cb62-20"><a href=""></a>    rss <span class="ot">&lt;-</span> (<span class="fu">pull</span>(test_row_y) <span class="sc">-</span> predict_result) <span class="sc">**</span> <span class="dv">2</span></span>
<span id="cb62-21"><a href=""></a>    cross_validation_total <span class="ot">&lt;-</span> <span class="fu">c</span>(cross_validation_total, rss)</span>
<span id="cb62-22"><a href=""></a>  }</span>
<span id="cb62-23"><a href=""></a>  </span>
<span id="cb62-24"><a href=""></a>  <span class="fu">stopifnot</span>(<span class="fu">length</span>(cross_validation_total)<span class="sc">==</span> <span class="fu">nrow</span>(credit_cleaned))</span>
<span id="cb62-25"><a href=""></a>  results <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> <span class="fu">add_row</span>(<span class="at">Lambda =</span> curr_lambda, <span class="at">CV =</span> <span class="fu">sum</span>(cross_validation_total) <span class="sc">/</span> <span class="fu">nrow</span>(credit_cleaned))</span>
<span id="cb62-26"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>Step 4: Choose lambda</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href=""></a>results_log10 <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Lambda =</span> <span class="fu">ifelse</span>(Lambda <span class="sc">!=</span> <span class="dv">0</span>, <span class="fu">log10</span>(Lambda), Lambda))</span>
<span id="cb63-2"><a href=""></a><span class="fu">ggplot</span>(<span class="at">data =</span> results_log10, <span class="fu">aes</span>(<span class="at">x =</span> Lambda, <span class="at">y =</span> CV)) <span class="sc">+</span></span>
<span id="cb63-3"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(CV), <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Lambda (log_10)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RidgeAndLassoPresentation_files/figure-revealjs/unnamed-chunk-31-1.png" width="960" class="r-stretch"><p>It seems 0.1 is the best option for lasso.</p>
</section>
<section class="slide level2">

<p>Step 5: Refit</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href=""></a>credit_cleaned_x <span class="ot">&lt;-</span> credit_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Balance))</span>
<span id="cb64-2"><a href=""></a>credit_cleaned_y <span class="ot">&lt;-</span> <span class="fu">pull</span>(credit_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(Balance)))</span>
<span id="cb64-3"><a href=""></a>final_model_lasso <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x =</span> credit_cleaned_x, <span class="at">y =</span> credit_cleaned_y, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> <span class="fl">10e-02</span>, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href=""></a><span class="fu">print</span>(<span class="fu">coef</span>(linear_reg))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)       Income        Limit       Rating        Cards          Age 
  520.015000  -275.014651   440.650711   175.848092    24.305139   -10.589809 
   Education       Own_No      Own_Yes   Student_No  Student_Yes   Married_No 
   -3.434150     5.330027           NA  -127.884163           NA     4.162747 
 Married_Yes  Region_East Region_South  Region_West       OwnYes   StudentYes 
          NA    -7.261088    -3.352729           NA           NA           NA 
  MarriedYes  RegionSouth   RegionWest 
          NA           NA           NA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href=""></a><span class="fu">print</span>(<span class="fu">coef</span>(final_model_lasso))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>20 x 1 sparse Matrix of class "dgCMatrix"
                        s0
(Intercept)   4.798723e+01
Income       -2.746259e+02
Limit         4.733161e+02
Rating        1.427685e+02
Cards         2.564063e+01
Age          -1.048843e+01
Education    -3.501920e+00
Own          -3.274167e-01
Student       4.251402e+02
Married      -6.940266e+00
Region        6.259704e+00
Own_No        1.009059e+01
Own_Yes       .           
Student_No   -9.212928e-01
Student_Yes   3.344295e-13
Married_No    8.931330e-01
Married_Yes   .           
Region_East  -3.597532e+00
Region_South  .           
Region_West   .           </code></pre>
</div>
</div>
<p>As listed by the coefficients, some variables are completely shrunk to 0.</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href=""></a><span class="fu">print</span>(<span class="fu">summary</span>(linear_reg)<span class="sc">$</span>adj.r.squared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9538287</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href=""></a>final_model_lasso_r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ((<span class="dv">1</span> <span class="sc">-</span> final_model_lasso<span class="sc">$</span>dev.ratio)<span class="sc">*</span>(<span class="fu">nrow</span>(credit_cleaned) <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span> (<span class="fu">nrow</span>(credit_cleaned) <span class="sc">-</span> <span class="fu">ncol</span>(credit_cleaned_x) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb71-2"><a href=""></a><span class="fu">print</span>(final_model_lasso_r2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9528332</code></pre>
</div>
</div>
<p>Similar result to ridge regression.</p>
</section>
<section id="practical-application-of-ridge-and-lasso-to-a-real-dataset-wine" class="slide level2">
<h2>Practical application of Ridge and Lasso to a real dataset (wine)</h2>
<p>UC Irvine provides a repository of various machine learning datasets. We will use https://archive.ics.uci.edu/dataset/186/wine+quality for testing ridge and lasso. The regression will focus on the red wine set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href=""></a><span class="fu">library</span>(readr)</span>
<span id="cb73-2"><a href=""></a>winequality_red <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"winequality-red.csv"</span>, </span>
<span id="cb73-3"><a href=""></a>    <span class="at">delim =</span> <span class="st">";"</span>, <span class="at">escape_double =</span> <span class="cn">FALSE</span>, <span class="at">trim_ws =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">quality =</span> <span class="fu">as_factor</span>(quality))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<p>Starting with a standard ordered logistic model (polr):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href=""></a>wine_lm <span class="ot">&lt;-</span> <span class="fu">step</span>(<span class="fu">polr</span>(quality <span class="sc">~</span> ., <span class="at">data =</span> winequality_red, <span class="at">Hess =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=3106.93
quality ~ `fixed acidity` + `volatile acidity` + `citric acid` + 
    `residual sugar` + chlorides + `free sulfur dioxide` + `total sulfur dioxide` + 
    density + pH + sulphates + alcohol

                         Df    AIC
- density                 1 3106.0
&lt;none&gt;                      3106.9
- `fixed acidity`         1 3107.2
- pH                      1 3107.8
- `citric acid`           1 3107.9
- `residual sugar`        1 3108.1
- `free sulfur dioxide`   1 3108.9
- chlorides               1 3119.7
- `total sulfur dioxide`  1 3127.8
- sulphates               1 3171.1
- `volatile acidity`      1 3178.7
- alcohol                 1 3203.5

Step:  AIC=3106.01
quality ~ `fixed acidity` + `volatile acidity` + `citric acid` + 
    `residual sugar` + chlorides + `free sulfur dioxide` + `total sulfur dioxide` + 
    pH + sulphates + alcohol

                         Df    AIC
- `fixed acidity`         1 3105.2
&lt;none&gt;                      3106.0
- `residual sugar`        1 3106.1
- `citric acid`           1 3107.0
- `free sulfur dioxide`   1 3108.6
- pH                      1 3110.3
- chlorides               1 3119.6
- `total sulfur dioxide`  1 3128.1
- sulphates               1 3169.5
- `volatile acidity`      1 3181.3
- alcohol                 1 3358.4

Step:  AIC=3105.22
quality ~ `volatile acidity` + `citric acid` + `residual sugar` + 
    chlorides + `free sulfur dioxide` + `total sulfur dioxide` + 
    pH + sulphates + alcohol

                         Df    AIC
- `citric acid`           1 3105.1
&lt;none&gt;                      3105.2
- `residual sugar`        1 3105.5
- `free sulfur dioxide`   1 3108.1
- pH                      1 3116.6
- chlorides               1 3122.5
- `total sulfur dioxide`  1 3132.1
- sulphates               1 3170.8
- `volatile acidity`      1 3180.4
- alcohol                 1 3357.4

Step:  AIC=3105.07
quality ~ `volatile acidity` + `residual sugar` + chlorides + 
    `free sulfur dioxide` + `total sulfur dioxide` + pH + sulphates + 
    alcohol

                         Df    AIC
- `residual sugar`        1 3104.8
&lt;none&gt;                      3105.1
- `free sulfur dioxide`   1 3109.1
- pH                      1 3114.7
- chlorides               1 3124.5
- `total sulfur dioxide`  1 3135.0
- sulphates               1 3169.3
- `volatile acidity`      1 3191.3
- alcohol                 1 3357.2

Step:  AIC=3104.85
quality ~ `volatile acidity` + chlorides + `free sulfur dioxide` + 
    `total sulfur dioxide` + pH + sulphates + alcohol

                         Df    AIC
&lt;none&gt;                      3104.8
- `free sulfur dioxide`   1 3109.7
- pH                      1 3115.4
- chlorides               1 3123.6
- `total sulfur dioxide`  1 3133.6
- sulphates               1 3168.1
- `volatile acidity`      1 3190.8
- alcohol                 1 3361.8</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>There does not seem to be an analog for R^2 when performing ordered logistic regression.</p>
</section>
<section class="slide level2">

<h3 id="ridge-and-lasso">Ridge and Lasso</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href=""></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: This function was modified from previous sections; CV is not a good indicator for ordinal logistic regression, since it is not possible to calculate RSS. Instead, treat the CV value as the mean correct classification.</span></span>
<span id="cb76-2"><a href=""></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">12</span>)</span>
<span id="cb76-3"><a href=""></a><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb76-4"><a href=""></a></span>
<span id="cb76-5"><a href=""></a><span class="co"># Set up parallelized LOOCV for the huge dataset (ridge)</span></span>
<span id="cb76-6"><a href=""></a>cv_ridge_parallel <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, selected_lambda) {</span>
<span id="cb76-7"><a href=""></a>  </span>
<span id="cb76-8"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb76-9"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(dataset), <span class="at">.packages =</span> <span class="fu">c</span>(<span class="st">'glmnetcr'</span>,<span class="st">'tidyverse'</span>)) <span class="sc">%dopar%</span> {</span>
<span id="cb76-10"><a href=""></a>    </span>
<span id="cb76-11"><a href=""></a>    test_row <span class="ot">&lt;-</span> dataset <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> i)</span>
<span id="cb76-12"><a href=""></a>    test_row_x <span class="ot">&lt;-</span> test_row <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(quality))</span>
<span id="cb76-13"><a href=""></a>    test_row_y <span class="ot">&lt;-</span> test_row <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(quality))</span>
<span id="cb76-14"><a href=""></a>    </span>
<span id="cb76-15"><a href=""></a>    train_rows <span class="ot">&lt;-</span> dataset <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">!=</span> i)</span>
<span id="cb76-16"><a href=""></a>    train_rows_x <span class="ot">&lt;-</span> train_rows <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(quality))</span>
<span id="cb76-17"><a href=""></a>    train_rows_y <span class="ot">&lt;-</span> train_rows <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(quality))</span>
<span id="cb76-18"><a href=""></a>    </span>
<span id="cb76-19"><a href=""></a>    <span class="co"># Train gaussian model</span></span>
<span id="cb76-20"><a href=""></a>    single_model_ridge <span class="ot">&lt;-</span> <span class="fu">glmnetcr</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(train_rows_x), <span class="at">y =</span> <span class="fu">pull</span>(train_rows_y), <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> selected_lambda, <span class="at">pmax =</span> <span class="dv">99</span>)</span>
<span id="cb76-21"><a href=""></a>    <span class="co"># Test the model</span></span>
<span id="cb76-22"><a href=""></a>    predict_result <span class="ot">&lt;-</span> <span class="fu">predict</span>(single_model_ridge, <span class="at">newx =</span> <span class="fu">as.matrix</span>(test_row_x))</span>
<span id="cb76-23"><a href=""></a>    <span class="co"># Calculate RSS</span></span>
<span id="cb76-24"><a href=""></a>    rss <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">pull</span>(test_row_y) <span class="sc">==</span> <span class="fu">as.factor</span>(predict_result<span class="sc">$</span>class), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb76-25"><a href=""></a>    <span class="fu">return</span>(rss)</span>
<span id="cb76-26"><a href=""></a>    <span class="co">#cv_total[i] = rss</span></span>
<span id="cb76-27"><a href=""></a>  }</span>
<span id="cb76-28"><a href=""></a>  <span class="fu">stopifnot</span>(<span class="fu">length</span>(cv_total)<span class="sc">==</span> <span class="fu">nrow</span>(winequality_red))</span>
<span id="cb76-29"><a href=""></a>  <span class="fu">return</span> (cv_total)</span>
<span id="cb76-30"><a href=""></a>}</span>
<span id="cb76-31"><a href=""></a></span>
<span id="cb76-32"><a href=""></a><span class="co"># lasso</span></span>
<span id="cb76-33"><a href=""></a>cv_lasso_parallel <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, selected_lambda) {</span>
<span id="cb76-34"><a href=""></a>  </span>
<span id="cb76-35"><a href=""></a>  <span class="co">#for (i in 1:nrow(dataset)) {</span></span>
<span id="cb76-36"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb76-37"><a href=""></a>  cv_total <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i =</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">nrow</span>(dataset), <span class="at">.packages =</span> <span class="fu">c</span>(<span class="st">'glmnetcr'</span>, <span class="st">'tidyverse'</span>)) <span class="sc">%dopar%</span> {</span>
<span id="cb76-38"><a href=""></a>    test_row <span class="ot">&lt;-</span> dataset <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">==</span> i)</span>
<span id="cb76-39"><a href=""></a>    test_row_x <span class="ot">&lt;-</span> test_row <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(quality))</span>
<span id="cb76-40"><a href=""></a>    test_row_y <span class="ot">&lt;-</span> test_row <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(quality))</span>
<span id="cb76-41"><a href=""></a>    </span>
<span id="cb76-42"><a href=""></a>    train_rows <span class="ot">&lt;-</span> dataset <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">!=</span> i)</span>
<span id="cb76-43"><a href=""></a>    train_rows_x <span class="ot">&lt;-</span> train_rows <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(quality))</span>
<span id="cb76-44"><a href=""></a>    train_rows_y <span class="ot">&lt;-</span> train_rows <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(quality))</span>
<span id="cb76-45"><a href=""></a>    </span>
<span id="cb76-46"><a href=""></a>    <span class="co"># Train gaussian model</span></span>
<span id="cb76-47"><a href=""></a>    single_model_lasso <span class="ot">&lt;-</span> <span class="fu">glmnetcr</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(train_rows_x), <span class="at">y =</span> <span class="fu">pull</span>(train_rows_y), <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> selected_lambda)</span>
<span id="cb76-48"><a href=""></a>    <span class="co"># Test the model</span></span>
<span id="cb76-49"><a href=""></a>    predict_result <span class="ot">&lt;-</span> <span class="fu">predict</span>(single_model_lasso, <span class="at">newx =</span> <span class="fu">as.matrix</span>(test_row_x))</span>
<span id="cb76-50"><a href=""></a>    <span class="co"># Calculate RSS</span></span>
<span id="cb76-51"><a href=""></a>    rss <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">pull</span>(test_row_y) <span class="sc">==</span> <span class="fu">as.factor</span>(predict_result<span class="sc">$</span>class), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb76-52"><a href=""></a>    <span class="fu">return</span>(rss)</span>
<span id="cb76-53"><a href=""></a>    <span class="co">#cv_total[i] = rss</span></span>
<span id="cb76-54"><a href=""></a>  }</span>
<span id="cb76-55"><a href=""></a>  <span class="fu">stopifnot</span>(<span class="fu">length</span>(cv_total)<span class="sc">==</span> <span class="fu">nrow</span>(winequality_red))</span>
<span id="cb76-56"><a href=""></a>  <span class="fu">return</span> (cv_total)</span>
<span id="cb76-57"><a href=""></a>}</span>
<span id="cb76-58"><a href=""></a></span>
<span id="cb76-59"><a href=""></a><span class="co"># Step 1: Standardize red wine dataset</span></span>
<span id="cb76-60"><a href=""></a>winequality_red_cleaned <span class="ot">&lt;-</span> winequality_red <span class="sc">%&gt;%</span></span>
<span id="cb76-61"><a href=""></a>  <span class="fu">select</span>(<span class="sc">-</span>quality) <span class="sc">%&gt;%</span></span>
<span id="cb76-62"><a href=""></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), scale)) <span class="sc">%&gt;%</span></span>
<span id="cb76-63"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">quality =</span> winequality_red<span class="sc">$</span>quality)</span>
<span id="cb76-64"><a href=""></a>  </span>
<span id="cb76-65"><a href=""></a></span>
<span id="cb76-66"><a href=""></a><span class="co"># Step 2: Define lambdas</span></span>
<span id="cb76-67"><a href=""></a>lambdas_lasso <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.03</span>, <span class="fl">0.04</span>, <span class="fl">0.05</span>, <span class="fl">0.06</span>)</span>
<span id="cb76-68"><a href=""></a>lambdas_ridge <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>)</span>
<span id="cb76-69"><a href=""></a></span>
<span id="cb76-70"><a href=""></a><span class="co"># Step 3: Perform LOOCV for each lambda (train/test)</span></span>
<span id="cb76-71"><a href=""></a>results <span class="ot">&lt;-</span> <span class="fu">data_frame</span>(<span class="at">Lambda_Ridge =</span> <span class="fu">numeric</span>(), <span class="at">Lambda_Lasso =</span> <span class="fu">numeric</span>(), <span class="at">Mean_Accuracy_Ridge =</span> <span class="fu">numeric</span>(), <span class="at">Mean_Accuracy_Lasso=</span><span class="fu">numeric</span>())</span>
<span id="cb76-72"><a href=""></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="sc">:</span> <span class="fu">length</span>(lambdas_lasso)) {</span>
<span id="cb76-73"><a href=""></a><span class="co">#for (curr_lambda in lambdas) {</span></span>
<span id="cb76-74"><a href=""></a>  cv_total_for_lambda_ridge <span class="ot">&lt;-</span> <span class="fu">cv_ridge_parallel</span>(winequality_red, lambdas_ridge[i])</span>
<span id="cb76-75"><a href=""></a>  cv_total_for_lambda_lasso <span class="ot">&lt;-</span> <span class="fu">cv_lasso_parallel</span>(winequality_red, lambdas_lasso[i])</span>
<span id="cb76-76"><a href=""></a>  </span>
<span id="cb76-77"><a href=""></a>  results <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> <span class="fu">add_row</span>(<span class="at">Lambda_Ridge =</span> lambdas_ridge[i], <span class="at">Lambda_Lasso =</span> lambdas_lasso[i], <span class="at">Mean_Accuracy_Ridge =</span> <span class="fu">sum</span>(<span class="fu">unlist</span>(cv_total_for_lambda_ridge)) <span class="sc">/</span> <span class="fu">nrow</span>(winequality_red), <span class="at">Mean_Accuracy_Lasso =</span> <span class="fu">sum</span>(<span class="fu">unlist</span>(cv_total_for_lambda_lasso)) <span class="sc">/</span> <span class="fu">nrow</span>(winequality_red))</span>
<span id="cb76-78"><a href=""></a>}</span>
<span id="cb76-79"><a href=""></a><span class="fu">stopCluster</span>(cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href=""></a><span class="fu">kable</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">Lambda_Ridge</th>
<th style="text-align: right;">Lambda_Lasso</th>
<th style="text-align: right;">Mean_Accuracy_Ridge</th>
<th style="text-align: right;">Mean_Accuracy_Lasso</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.5834897</td>
<td style="text-align: right;">0.0112570</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.4258912</td>
<td style="text-align: right;">0.5709819</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.4258912</td>
<td style="text-align: right;">0.5503440</td>
</tr>
<tr class="even">
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.4258912</td>
<td style="text-align: right;">0.5372108</td>
</tr>
<tr class="odd">
<td style="text-align: right;">20</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.4258912</td>
<td style="text-align: right;">0.5159475</td>
</tr>
<tr class="even">
<td style="text-align: right;">25</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.4258912</td>
<td style="text-align: right;">0.4496560</td>
</tr>
<tr class="odd">
<td style="text-align: right;">30</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.4258912</td>
<td style="text-align: right;">0.4258912</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href=""></a><span class="fu">ggplot</span>(<span class="at">data =</span> results, <span class="fu">aes</span>(<span class="at">x =</span> Lambda_Ridge, <span class="at">y =</span> Mean_Accuracy_Ridge)) <span class="sc">+</span></span>
<span id="cb78-2"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Mean_Accuracy_Ridge,<span class="dv">6</span>), <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Lambda"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Mean Accuracy vs Lambda (Ridge)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RidgeAndLassoPresentation_files/figure-revealjs/unnamed-chunk-39-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href=""></a><span class="fu">ggplot</span>(<span class="at">data =</span> results, <span class="fu">aes</span>(<span class="at">x =</span> Lambda_Lasso, <span class="at">y =</span> Mean_Accuracy_Lasso)) <span class="sc">+</span></span>
<span id="cb79-2"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Mean_Accuracy_Lasso,<span class="dv">4</span>), <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"Lambda"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"CV vs Lambda (Lasso)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RidgeAndLassoPresentation_files/figure-revealjs/unnamed-chunk-40-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href=""></a>x <span class="ot">&lt;-</span> winequality_red_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(quality))</span>
<span id="cb80-2"><a href=""></a>y <span class="ot">&lt;-</span> winequality_red_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(quality)</span>
<span id="cb80-3"><a href=""></a>final_model_ridge <span class="ot">&lt;-</span> <span class="fu">glmnetcr</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">pull</span>(y), <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">lambda =</span> <span class="dv">0</span>, <span class="at">pmax =</span> <span class="dv">99</span>)</span>
<span id="cb80-4"><a href=""></a></span>
<span id="cb80-5"><a href=""></a>final_model_lasso <span class="ot">&lt;-</span> <span class="fu">glmnetcr</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">pull</span>(y), <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> <span class="fl">0.01</span>)</span>
<span id="cb80-6"><a href=""></a></span>
<span id="cb80-7"><a href=""></a><span class="fu">print</span>(<span class="fu">summary</span>(final_model_ridge))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Length Class     Mode     
a0             1  -none-    numeric  
beta          16  dgCMatrix S4       
df             1  -none-    numeric  
dim            2  -none-    numeric  
lambda         1  -none-    numeric  
dev.ratio      1  -none-    numeric  
nulldev        1  -none-    numeric  
npasses        1  -none-    numeric  
jerr           1  -none-    numeric  
offset         1  -none-    logical  
classnames     2  -none-    character
call          20  -none-    call     
nobs           1  -none-    numeric  
x          17589  -none-    numeric  
y           1599  factor    numeric  
method         1  -none-    character</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href=""></a><span class="fu">print</span>(<span class="fu">summary</span>(final_model_lasso))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Length Class     Mode     
a0             1  -none-    numeric  
beta          16  dgCMatrix S4       
df             1  -none-    numeric  
dim            2  -none-    numeric  
lambda         1  -none-    numeric  
dev.ratio      1  -none-    numeric  
nulldev        1  -none-    numeric  
npasses        1  -none-    numeric  
jerr           1  -none-    numeric  
offset         1  -none-    logical  
classnames     2  -none-    character
call          20  -none-    call     
nobs           1  -none-    numeric  
x          17589  -none-    numeric  
y           1599  factor    numeric  
method         1  -none-    character</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>We can attempt to compare deviance ratios, which compares the deviance of the ordinal logistic model to their null models.</p>
<p>Curiously, it seems that lasso and ridge both perform better than the standard ordinal logistic regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href=""></a><span class="fu">print</span>(<span class="dv">1</span> <span class="sc">-</span> (model_deviance <span class="sc">/</span> null_deviance))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1867788</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href=""></a><span class="fu">print</span>(final_model_ridge<span class="sc">$</span>dev.ratio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5243856</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href=""></a><span class="fu">print</span>(final_model_lasso<span class="sc">$</span>dev.ratio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5108941</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>The original research regarding the wine quality includes some metrics regarding their own models:</p>

<img data-src="Pasted%20image.png" class="r-stretch"><p>Cortez, Paulo, et al.&nbsp;“Wine Quality.” UCI Machine Learning Repository, 2009, https://doi.org/10.24432/C56S3T.</p>
</section>
<section class="slide level2">

<p>Both the ridge and lasso models calculate the mean absolute deviation as part of the CV training process (see prior images). The ridge model had a MAD of 58.3% and the lasso had a MAD of 57.1%; both methods perform better than the multiple regression, support vector machine, and neural network models of the paper!</p>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="RidgeAndLassoPresentation_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="RidgeAndLassoPresentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="RidgeAndLassoPresentation_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="RidgeAndLassoPresentation_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="RidgeAndLassoPresentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="RidgeAndLassoPresentation_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="RidgeAndLassoPresentation_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="RidgeAndLassoPresentation_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="RidgeAndLassoPresentation_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="RidgeAndLassoPresentation_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>